<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>𝗠𝗔𝗫 _𝗢𝗦 _ [𝖬𝙰𝚃𝚁𝖨𝚇 𝖤𝙳𝖨𝚃𝖨𝙴𝙳𝖨𝚃𝖨𝖤𝙳𝖨𝖮𝖭]</title>
    <!-- Favicon - 使用一个简单的SVG作为示例 -->
    <link rel="icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'><text x='0' y='14' font-size='16'>🌟</text></svg>" type="image/svg+xml">
    <!-- 引入 Tailwind CSS CDN，用于快速构建和响应式布局 -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- 引入 Google Fonts - Inter 字体作为通用字体，如果需要 'Chocolate Classical Sans'，请在此处引入其 CDN 或本地路径 -->
    <link href="https://fonts.googleapis.com/css2?family=Roboto+Mono:wght@400;700&display=swap" rel="stylesheet">
    <!-- Marked.js 用于 Markdown 解析 -->
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <style>
        /* 全局样式和变量，针对 Matrix 视觉风格优化 */
        :root {
            /* 核心黑客帝国绿色调色板 */
            --matrix-green-light: #00FF41; /* 明亮的绿色文字，用于高光和激活状态 */
            --matrix-green-dark: #008F11; /* 深绿色，用于背景和阴影 */
            --matrix-black: #080808; /* 深黑色，作为主要背景 */
            --matrix-dark-grey: #1A1A1A; /* 稍微亮一点的深灰色，用于边框和结构 */
            --matrix-light-grey: #333333; /* 用于更亮的金属纹理 */

            /* 金属拟物化效果 - 增强版 (改为铬合金颜色，更亮、更反射，更强对比) */
            --metal-color-start: #f8f8f8; /* 极浅的银色，接近纯白色，用于最强高光 */
            --metal-color-mid: #d0d0d0;   /* 亮银色 */
            --metal-color-end: #707070;   /* 显著更深的银灰色，用于深阴影 */
            --metal-highlight: rgba(255, 255, 255, 0.95); /* 极强的反射高光 */
            --metal-shadow: rgba(0, 0, 0, 0.8);         /* 极深阴影深度，更实 */
            --metal-inner-shadow: rgba(0, 0, 0, 0.85);   /* 内部阴影，更深 */
            --metal-border-light: rgba(255, 255, 255, 0.98); /* 极浅金属色，用于高光边框，极亮 */
            --metal-border-dark: rgba(30, 30, 30, 0.95); /* 极深金属色，用于阴影边框，极深 */
            --metal-bg: rgba(100, 100, 100, 0.25); /* 金属背景的微妙光泽，略微更可见 */
            --metal-text-color: var(--matrix-dark-grey); /* 用于金属背景上的文字颜色 */


            /* 黑色玻璃显示屏效果 - 增加玻璃质感 */
            --glass-bg: rgba(0, 0, 0, 0.7); /* 更透亮一点的黑色半透明背景 */
            --glass-border: rgba(0, 255, 65, 0.5); /* 绿色半透明边框，更明显 */
            --glass-glow: 0 0 20px rgba(0, 255, 65, 0.7); /* 绿色光晕，更强 */
            --glass-inset-shadow: inset 0 0 12px rgba(0, 255, 65, 0.3); /* 绿色内阴影，更明显 */

            /* 字体 - 使用等宽字体模拟代码终端 */
            --font-main: 'Roboto Mono', monospace;

            /* 阴影与光晕 - 绿色调 */
            --shadow-matrix: 0 4px 15px rgba(0, 255, 65, 0.2); /* 柔和的绿色阴影 */
            --glow-matrix: 0 0 18px rgba(0, 255, 65, 0.8); /* 强烈的绿色光晕 */
            --text-glow-matrix: 0 0 6px rgba(0, 255, 65, 0.8), 0 0 12px rgba(0, 255, 65, 0.6);

            --taskbar-height: 48px;

            /* 鼠标指针 - 由 JavaScript 动态设置 */
            --cursor-default: auto;
            --cursor-active: auto;
            --cursor-pointer: pointer;

            /* 桌面背景图片的CSS变量 - 修正路径为 ../assets/... */
            --desktop-image-url: url('../assets/backgrounds/bg.jpg');
        }

        body {
            /* 全局字体应用新主字体 */
            font-family: var(--font-main);
            /* 深色背景 */
            background-color: var(--matrix-black);
            /* 文本颜色设置为绿色 */
            color: var(--matrix-green-light); /* 默认文字颜色为绿色，适用于深色背景 */
            margin: 0;
            padding: 0;
            overflow: hidden; /* 防止滚动条出现，模拟桌面环境 */
            position: relative; /* 用于背景动画定位 */
            width: 100vw; /* 确保主体占满整个视口宽度 */
            height: 100vh; /* 确保主体占满整个视口高度 */
            cursor: var(--cursor-default);
            display: flex; /* 使用弹性盒子布局桌面容器 */
            flex-direction: column;
            
            /* CRT 纹理和发光效果 - 移除频闪动画 */
            position: relative;
            overflow: hidden; /* 确保伪元素不会溢出 */
            /* filter: brightness(1.1) contrast(1.2); */ /* 调整整体对比度以适应CRT效果 */
        }

        body::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1000; /* 确保在其他内容之上 */
            opacity: 0.15; /* 调整 CRT 纹理的透明度 */
            background: repeating-linear-gradient(
                #080808,
                #080808 1px,
                #00FF41 1px,
                #00FF41 2px
            ); /* 细微的绿色扫描线 */
            background-size: 100% 4px;
            filter: blur(0.5px) hue-rotate(0deg) saturate(1.5); /* 稍微模糊和饱和度，模拟旧屏幕 */
            /* animation: flicker 0.15s infinite alternate; */ /* 移除闪烁动画 */
        }

        /* 专门针对黑色背景、绿色文字的 CRT 效果 - 移除频闪动画 */
        .os-window-content, 
        .start-menu-item,
        .work-card,
        .service-category-card,
        .taskbar-minimized-icon,
        .work-detail-content { /* 应用到所有黑色背景的元素 */
            position: relative; /* 确保伪元素相对于自身定位 */
            overflow: hidden;
            z-index: 1; /* 确保内容在 CRT 纹理之下 */
        }

        .os-window-content::after, 
        .start-menu-item::after,
        .work-card::after,
        .service-category-card::after,
        .taskbar-minimized-icon::after,
        .work-detail-content::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 2; /* 确保在内容之上 */
            opacity: 0.15; /* 调整 CRT 纹理的透明度 */
            background: repeating-linear-gradient(
                #080808,
                #080808 1px,
                #00FF41 1px,
                #00FF41 2px
            ); /* 细微的绿色扫描线 */
            background-size: 100% 4px;
            filter: blur(0.5px) hue-rotate(0deg) saturate(1.5); /* 稍微模糊和饱和度，模拟旧屏幕 */
            /* animation: flicker 0.15s infinite alternate; */ /* 移除闪烁动画 */
        }


        /* @keyframes flicker {
            0% { opacity: 0.15; }
            50% { opacity: 0.2; }
            100% { opacity: 0.15; }
        } */ /* 移除 flicker 动画定义 */


        body:active {
            cursor: var(--cursor-active);
        }

        a, button, .clickable-element {
            cursor: var(--cursor-pointer);
        }

        /* Matrix 风格桌面背景 */
        .desktop-background {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            min-height: 100vh;
            background-image: var(--desktop-image-url);
            background-size: cover;
            background-position: center;
            opacity: 0.9;
            filter: brightness(0.7) contrast(1.2); /* 使背景更暗更具对比度 */
            z-index: -1;
        }
        .desktop-background::before,
        .desktop-background::after {
            display: none !important; /* 隐藏原始的伪元素效果 */
        }
        /* 当背景图片激活时，隐藏伪元素 */
        .desktop-background-image-active {
            background-image: var(--desktop-image-url) !important;
            background-color: transparent !important;
            opacity: 0.9 !important;
            filter: brightness(0.7) contrast(1.2) !important;
        }
        .desktop-background-image-active::before,
        .desktop-background-image-active::after {
            display: none !important;
        }

        /* 桌面容器，作为主要内容包装器 */
        .desktop-container {
            position: relative;
            flex-grow: 1;
            width: 100%;
            height: 100%;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            z-index: 3;
        }

        /* 桌面布局 - 包含主桌面区和任务栏 */
        .desktop-layout {
            display: flex;
            flex-direction: column;
            width: 100%;
            height: 100%;
        }

        /* 主桌面区 - 图标和窗口所在区域 */
        .main-desktop-area {
            flex-grow: 1;
            position: relative;
            overflow: hidden;
            padding: 10px;
            padding-bottom: calc(10px + var(--taskbar-height));
        }

        /* 任务栏 - 高度拟物化金属边框 */
        .taskbar {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: var(--taskbar-height);
            background: linear-gradient(to top, var(--metal-color-start) 0%, var(--metal-color-mid) 50%, var(--metal-color-end) 100%); /* 显著的金属渐变 */
            border-top: 2px solid var(--metal-border-light); /* 顶部高光 */
            border-bottom: 2px solid var(--metal-border-dark); /* 底部阴影 */
            box-shadow: 
                0 -1px 0 var(--metal-border-light), /* 顶部薄高光 */
                0 -8px 30px rgba(0, 255, 65, 0.3), /* 绿色光晕 */
                inset 0 1px 2px var(--metal-highlight), /* 内部高光 */
                inset 0 -2px 5px var(--metal-inner-shadow); /* 内部阴影，模拟深度 */
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 10px;
            z-index: 100;
            position: fixed;
            overflow: hidden; /* 防止内容溢出 */
        }
        .taskbar::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: repeating-linear-gradient(90deg, transparent, transparent 1px, var(--metal-bg) 1px, var(--metal-bg) 2px); /* 细微的金属拉丝纹理 */
            pointer-events: none;
            opacity: 0.8;
        }

        /* 开始按钮 - 高度拟物化的金属按钮 */
        .start-button {
            background: linear-gradient(to bottom, var(--metal-color-start) 0%, var(--metal-color-mid) 50%, var(--metal-color-end) 100%);
            border: 2px solid var(--metal-border-light); /* 顶部高光 */
            border-bottom-color: var(--metal-border-dark); /* 底部阴影 */
            border-right-color: var(--metal-border-dark);
            border-radius: 8px;
            width: 48px;
            height: 48px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--metal-text-color); /* 文字颜色改为深灰色 */
            font-size: 0.9rem;
            font-weight: bold;
            text-shadow: none; /* 移除绿色文字阴影 */
            box-shadow: 
                0 6px 20px rgba(0,255,65,0.4), /* 绿色外部光晕 */
                inset 0 1px 2px var(--metal-highlight), /* 内部高光 */
                inset 0 -2px 5px var(--metal-inner-shadow), /* 内部阴影 */
                inset 0 0 1px rgba(255,255,255,0.5); /* 微妙的光泽 */
            cursor: pointer;
            transition: all 0.2s ease-in-out;
            position: relative;
            overflow: hidden;
        }

        /* 移除闪光效果的伪元素 */
        .start-button::before,
        .start-button::after {
            display: none; 
        }

        .start-button:hover {
            background: linear-gradient(to top, var(--metal-color-start) 0%, var(--metal-color-mid) 50%, var(--metal-color-end) 100%);
            transform: translateY(-4px);
            border-color: var(--matrix-green-light);
            box-shadow: 
                0 8px 25px var(--glow-matrix), /* 更强的外部光晕 */
                inset 0 1px 3px var(--metal-highlight), /* 更强的内部高光 */
                inset 0 -3px 6px var(--metal-inner-shadow); /* 更深的内部阴影 */
        }

        .start-button:active {
            background: linear-gradient(to bottom, var(--metal-color-end) 0%, var(--metal-color-mid) 50%, var(--metal-color-start) 100%); /* 按下时的反向渐变 */
            transform: translateY(0);
            box-shadow: 
                inset 0 6px 15px var(--metal-shadow), /* Deeper inset shadow */
                inset 0 -2px 5px var(--metal-highlight), /* More pronounced highlight */
                0 2px 5px rgba(0,255,65,0.3); /* Smaller external shadow */
            filter: brightness(0.7); /* Slightly darker on press */
            border-top-color: var(--metal-border-dark);
            border-bottom-color: var(--metal-border-light);
            border-left-color: var(--metal-border-dark);
            border-right-color: var(--metal-border-light);
        }

        .start-button .icon-image {
            width: 2em;
            height: 2em;
            filter: drop-shadow(var(--text-glow-matrix));
        }

        /* 任务栏图标（打开/最小化窗口） */
        .taskbar-icons-container {
            display: flex;
            flex-grow: 1;
            justify-content: flex-start;
            align-items: center;
            height: 100%;
            overflow-x: auto;
            padding: 0 10px;
            gap: 10px;
        }

        /* 系统托盘 */
        .system-tray {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .system-tray-icon {
            font-size: 1.2rem;
            color: var(--metal-text-color); /* 图标颜色改为深灰色 */
            transition: all 0.2s ease;
            cursor: default;
            padding: 8px;
            border-radius: 50%;
            /* 黑色圆形背景 */
            background-color: var(--matrix-black);
            box-shadow: 0 1px 5px rgba(0,0,0,0.3);
            display: flex; /* Ensure content is centered */
            align-items: center;
            justify-content: center;
        }
        .system-tray-icon:hover {
            color: white; /* 悬停时白色 */
            background-color: rgba(0,255,65,0.25);
            transform: translateY(-5px); /* Consistent lift */
            box-shadow: 0 6px 15px rgba(0, 255, 65, 0.6); /* Stronger shadow */
        }
        .system-tray-icon .icon-image {
            width: 1.2em;
            height: 1.2em;
            vertical-align: middle;
            filter: drop-shadow(0 0 8px rgba(0, 255, 65, 0.7));
            transition: filter 0.2s ease, transform 0.2s ease; /* Add transform transition */
        }
        .system-tray-icon:hover .icon-image {
            filter: drop-shadow(0 0 12px rgba(0, 255, 65, 0.9)); /* Stronger icon glow */
        }

        /* 系统托盘时间文字 */
        .system-tray-text {
            color: var(--metal-text-color); /* 文字颜色改为深灰色 */
            text-shadow: none; /* 移除文字阴影 */
        }

        /* 桌面图标（快捷方式） */
        .desktop-icons-container {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: calc(100% - var(--taskbar-height));
            padding: 20px;
            z-index: 2;
        }

        .desktop-icon {
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
            width: 100px;
            cursor: pointer;
            transition: transform 0.15s ease, filter 0.15s ease;
            padding: 10px;
            border-radius: 15px;
            user-select: none;
            position: absolute;
        }

        .desktop-icon:hover {
            filter: brightness(1.1);
            background-color: rgba(0, 255, 65, 0.1);
            transform: translateY(-5px); /* Add subtle lift on hover */
        }

        .desktop-icon:active {
            transform: scale(0.95) translateY(0); /* Reset Y on active */
            filter: brightness(0.9);
            background-color: rgba(0, 255, 65, 0.05);
        }

        .desktop-icon .icon-image {
            width: 60px;
            height: 60px;
            filter: drop-shadow(0 4px 8px rgba(0,0,0,0.8));
            transition: filter 0.15s ease;
        }

        .desktop-icon:hover .icon-image {
            filter: drop-shadow(0 0 8px var(--matrix-green-light))
                    drop-shadow(0 0 15px rgba(0, 255, 65, 0.5))
                    drop-shadow(0 0 25px rgba(0, 255, 65, 0.3));
        }

        .desktop-icon:active .icon-image {
            filter: drop-shadow(0 0 3px rgba(0,0,0,0.6));
        }

        .desktop-icon-label {
            font-size: 0.9rem;
            color: var(--matrix-green-light);
            text-shadow: var(--text-glow-matrix);
            margin-top: 10px;
            word-wrap: break-word;
            max-width: 100%;
        }

        /* 开始菜单样式 - 黑色玻璃感，现在改为只有金属外框，内部卡片黑色*/
        .start-menu {
            position: absolute;
            bottom: var(--taskbar-height);
            left: 10px;
            width: 380px;
            height: auto;
            max-height: calc(100% - var(--taskbar-height) - 40px);
            background: rgba(0,0,0,0.8); /* Changed to black background */
            backdrop-filter: blur(5px); /* 稍微模糊 */
            -webkit-backdrop-filter: blur(5px);
            /* Removed metal border for start menu */
            /* border: 2px solid var(--metal-border-light); */
            /* border-bottom-color: var(--metal-border-dark); */
            /* border-right-color: var(--metal-border-dark); */
            border-radius: 12px;
            box-shadow: 
                0 8px 25px rgba(0, 255, 65, 0.5), /* Strong green outer glow */
                inset 0 1px 2px var(--metal-highlight), /* Inner highlight */
                inset 0 -2px 5px var(--metal-inner-shadow); /* Inner shadow */
            padding: 20px;
            /* 替换 display: none 为 visibility 和 opacity */
            visibility: hidden;
            opacity: 0;
            flex-direction: column;
            z-index: 100;
            transform-origin: bottom left;
            transition: opacity 0.3s ease-out, visibility 0.3s ease-out; /* Add transition for smoothness */
            overflow-y: auto;
            /* Added subtle metal texture to the overall menu background */
            background-image: repeating-linear-gradient(90deg, transparent, transparent 1px, var(--metal-bg) 1px, var(--metal-bg) 2px); /* Metal texture */
            background-blend-mode: overlay; /* Blend with black background */
        }

        .start-menu.hidden {
            visibility: hidden;
            opacity: 0;
            transform: scale(0.6); /* Start from smaller scale for animation */
        }
        .start-menu.visible {
            visibility: visible;
            opacity: 1;
            transform: scale(1);
            animation: fadeInScaleUpFromBottomLeft 0.3s ease-out forwards;
        }

        /* 开始菜单头部（带个人信息） - 更高度拟物化的金属风格 */
        .start-menu-header {
            background: linear-gradient(to right, var(--metal-color-start) 0%, var(--metal-color-mid) 50%, var(--metal-color-end) 100%);
            border: 2px solid var(--metal-border-light);
            border-bottom-color: var(--metal-border-dark);
            border-right-color: var(--metal-border-dark);
            box-shadow: 
                inset 0 1px 2px var(--metal-highlight), 
                inset 0 -2px 5px var(--metal-inner-shadow),
                0 4px 10px var(--metal-shadow);
            cursor: pointer;
            transition: all 0.2s ease;
            position: relative;
            overflow: hidden;
            display: flex; /* Added display flex */
            align-items: center; /* Added align items */
            padding: 15px; /* Added padding */
            margin-bottom: 15px; /* Added margin bottom */
            border-radius: 8px; /* Added border radius */
        }
        .start-menu-header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: repeating-linear-gradient(90deg, transparent, transparent 1px, var(--metal-bg) 1px, var(--metal-bg) 2px); /* 细微的金属拉丝纹理 */
            border-radius: inherit;
            pointer-events: none;
            opacity: 0.8;
        }
        /* 移除闪光效果 */
        .start-menu-header::after {
            display: none;
        }
        .start-menu-header:hover {
            transform: translateY(-4px);
            box-shadow: 
                0 8px 20px var(--glow-matrix), 
                inset 0 1px 3px var(--metal-highlight),
                inset 0 -3px 6px var(--metal-inner-shadow);
            filter: brightness(1.1);
        }
        .start-menu-header:active {
            background: linear-gradient(to bottom, var(--metal-color-end) 0%, var(--metal-color-mid) 50%, var(--metal-color-start) 100%);
            transform: translateY(0);
            box-shadow: 
                inset 0 3px 10px var(--metal-shadow), 
                inset 0 -1px 3px var(--metal-highlight),
                0 2px 5px rgba(0,255,65,0.3);
            filter: brightness(0.9);
            border-top-color: var(--metal-border-dark);
            border-bottom-color: var(--metal-border-light);
            border-left-color: var(--metal-border-dark);
            border-right-color: var(--metal-border-light);
        }
        /* 更改开始菜单头部文字和图标颜色为深灰色，并移除光晕 */
        .start-menu-header span, .start-menu-header .icon-image {
            color: var(--metal-text-color); /* Change to dark grey */
            filter: none; /* Remove green glow from icon */
            text-shadow: none; /* Remove text glow */
        }
        .start-menu-header:hover span, .start-menu-header:hover .icon-image {
            color: var(--metal-text-color); /* Keep dark on hover */
            filter: none;
            text-shadow: none;
        }


        /* 开始菜单条目样式 - 更具交互性和代码感 */
        .start-menu-item {
            padding: 15px 20px;
            display: flex;
            align-items: center;
            color: var(--matrix-green-light);
            text-decoration: none;
            transition: background-color 0.2s ease, transform 0.15s ease, filter 0.2s ease, box-shadow 0.2s ease;
            cursor: pointer;
            font-size: 1.05rem;
            font-weight: normal;
            border-radius: 8px;
            margin: 6px 0;
            position: relative;
            overflow: hidden;
            box-shadow: var(--glass-inset-shadow);
            /* Card background to black */
            background-color: rgba(0, 0, 0, 0.7); 
            border: 1px solid var(--glass-border); /* Retain green border */
            /* Added subtle glass reflection */
            background-image: linear-gradient(to top right, rgba(255, 255, 255, 0.03) 0%, transparent 50%);
        }

        .start-menu-item::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(0,255,65,0.4), transparent);
            transition: left 0.5s ease;
        }

        .start-menu-item:hover::before {
            left: 100%;
        }

        .start-menu-item:hover {
            background: rgba(0, 0, 0, 0.9);
            transform: translateX(10px);
            color: white;
            text-shadow: var(--text-glow-matrix);
            filter: brightness(1.4);
            box-shadow: var(--glass-glow), inset 0 0 10px rgba(0,0,0,0.5);
        }

        .start-menu-item .icon-image {
            margin-right: 18px;
            width: 1.5em;
            height: 1.5em;
            filter: drop-shadow(0 0 8px rgba(0, 255, 65, 0.8));
            transition: filter 0.2s ease;
        }
        .start-menu-item:hover .icon-image {
            filter: brightness(2) drop-shadow(0 0 15px rgba(0, 255, 65, 1));
        }
        
        .start-menu-item .menu-item-label {
            flex-grow: 1;
            text-align: left;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        /* 开始菜单底部按钮容器（设置和关机） */
        .start-menu-buttons-container {
            display: flex;
            flex-direction: row;
            justify-content: flex-end;
            gap: 15px;
            padding-top: 18px;
            margin-top: 18px;
            padding-right: 10px;
            border-top: 1px solid var(--matrix-dark-grey);
        }

        /* 开始菜单底部图标按钮的新样式 - 高度拟物化的金属按钮 */
        .start-menu-footer-button {
            width: 58px;
            height: 58px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            background: linear-gradient(to bottom, var(--metal-color-start) 0%, var(--metal-color-mid) 50%, var(--metal-color-end) 100%);
            border: 2px solid var(--metal-border-light); /* 顶部高光 */
            border-bottom-color: var(--metal-border-dark); /* 底部阴影 */
            border-right-color: var(--metal-border-dark);
            border-radius: 8px;
            cursor: pointer;
            transition: background-color 0.2s ease, transform 0.1s ease, box-shadow 0.2s ease;
            color: var(--metal-text-color); /* 文字颜色改为深灰色 */
            box-shadow: 
                inset 0 1px 2px var(--metal-highlight), 
                inset 0 -2px 5px var(--metal-inner-shadow),
                0 4px 15px rgba(0,255,65,0.4);
            position: relative;
            overflow: hidden;
        }
        .start-menu-footer-button::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: repeating-linear-gradient(90deg, transparent, transparent 1px, var(--metal-bg) 1px, var(--metal-bg) 2px); /* 细微的金属拉丝纹理 */
            border-radius: inherit;
            pointer-events: none;
            opacity: 0.8;
        }

        .start-menu-footer-button:hover {
            background: linear-gradient(to top, var(--metal-color-start) 0%, var(--metal-color-mid) 50%, var(--metal-color-end) 100%);
            transform: translateY(-4px);
            box-shadow: 
                inset 0 1px 3px var(--metal-highlight), 
                inset 0 -3px 6px var(--metal-inner-shadow),
                0 6px 20px var(--glow-matrix);
        }

        .start-menu-footer-button:active {
            transform: translateY(0);
            background: linear-gradient(to bottom, var(--metal-color-end) 0%, var(--metal-color-mid) 50%, var(--metal-color-start) 100%);
            box-shadow: 
                inset 0 6px 15px var(--metal-shadow), /* Deeper inset shadow */
                inset 0 -2px 5px var(--metal-highlight), /* More pronounced highlight */
                0 0 10px rgba(0,255,65,0.7);
            filter: brightness(0.7); /* Slightly darker on press */
            border-top-color: var(--metal-border-dark);
            border-bottom-color: var(--metal-border-light);
            border-left-color: var(--metal-border-dark);
            border-right-color: var(--metal-border-light);
        }

        .start-menu-footer-button .icon-image {
            width: 32px;
            height: 32px;
            /* 修正：确保图标有绿色光晕 */
            filter: drop-shadow(0 0 8px rgba(0, 255, 65, 0.7));
        }

        /* 动画：菜单出现 - 从左下角放大淡入 */
        @keyframes fadeInScaleUpFromBottomLeft {
            from {
                opacity: 0;
                transform: scale(0.6);
            }
            to {
                opacity: 1;
                transform: scale(1);
            }
        }

        /* 窗口样式（黑色玻璃质感） */
        .os-window {
            position: absolute;
            background: var(--glass-bg);
            backdrop-filter: blur(8px);
            -webkit-backdrop-filter: blur(8px);
            border: 2px solid var(--glass-border);
            border-radius: 12px;
            box-shadow: var(--glass-glow), var(--glass-inset-shadow);
            display: flex;
            flex-direction: column;
            overflow: hidden;
            min-width: 400px;
            min-height: 300px;
            z-index: 5;
            animation: windowPopIn 0.3s ease-out forwards;
            resize: both;
            /* Added subtle glass reflection */
            background-image: linear-gradient(to top right, rgba(255, 255, 255, 0.05) 0%, transparent 50%),
                              radial-gradient(circle at 10% 10%, rgba(255, 255, 255, 0.05) 0%, transparent 30%);
            transition: box-shadow 0.3s ease-in-out, border-color 0.3s ease-in-out; /* Add transition for smoothness */
        }

        .os-window.minimized {
            display: none;
        }

        .os-window.maximized {
            top: 0 !important;
            left: 0 !important;
            width: 100% !important;
            height: calc(100% - var(--taskbar-height)) !important;
            border-radius: 0;
            box-shadow: none;
            transition: all 0.3s ease-in-out;
            border: none;
            background-image: none; /* Remove reflection when maximized */
        }

        /* 窗口标题栏 - 高度拟物化的金属边框和绿色文字 */
        .os-window-title-bar {
            background: linear-gradient(to top, var(--metal-color-start) 0%, var(--metal-color-mid) 50%, var(--metal-color-end) 100%);
            border-bottom: 2px solid var(--metal-border-dark); /* 底部阴影 */
            border-top: 1px solid var(--metal-border-light); /* 顶部高光 */
            padding: 10px 18px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: grab;
            border-radius: 12px 12px 0 0;
            position: relative;
            font-size: 1.1rem;
            font-weight: bold;
            color: var(--metal-text-color); /* Text color on metal, now uses variable */
            text-shadow: none; /* Removed text-shadow */
            box-shadow: 
                inset 0 1px 2px var(--metal-highlight), 
                inset 0 -2px 5px var(--metal-inner-shadow),
                0 2px 5px var(--metal-shadow);
            overflow: hidden;
        }
        .os-window-title-bar::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: repeating-linear-gradient(90deg, transparent, transparent 1px, var(--metal-bg) 1px, var(--metal-bg) 2px); /* 细微的金属拉丝纹理 */
            pointer-events: none;
            border-radius: inherit;
            opacity: 0.8;
        }

        .os-window-title-bar.inactive {
            background: linear-gradient(to top, #666666 0%, #444444 100%); /* Desaturated chrome for inactive */
            border-bottom: 1px solid #333333;
            box-shadow: inset 0 -1px 5px rgba(0,0,0,0.3);
            color: rgba(0,0,0,0.5); /* Inactive text color, make it darker */
            text-shadow: none;
        }
        .os-window-title-bar.inactive::after {
            background: linear-gradient(to bottom, rgba(255,255,255,0.05) 0%, transparent 60%); /* Subtle desaturated reflection */
            opacity: 0.5;
        }

        /* 窗口标题和Logo容器 */
        .os-window-title-content {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .os-window-title-content .icon-image {
            width: 32px;
            height: 32px;
            filter: drop-shadow(0 0 8px rgba(0, 255, 65, 0.8)); /* 确保标题栏图标有绿色光晕 */
        }
        .os-window-title-bar:not(.inactive) .os-window-title-content .icon-image {
             filter: drop-shadow(0 0 5px rgba(0,0,0,0.5)); /* Subtle dark shadow for depth */
        }
        .os-window-title-bar.inactive .os-window-title-content .icon-image {
            filter: drop-shadow(0 0 3px rgba(0,0,0,0.3)); /* Even more subtle dark shadow for inactive */
        }

        .os-window-title {
            color: var(--metal-text-color); /* Text color on metal, now uses variable */
            text-shadow: none; /* Removed text-shadow */
        }
        .os-window-title-bar.inactive .os-window-title {
            color: rgba(0,0,0,0.5); /* Inactive text color, make it darker */
            text-shadow: none;
        }


        /* 窗口控制按钮（最小化、最大化、关闭） - 高度拟物化的金属绿色按钮 */
        .os-window-controls { /* Added this rule to control button layout */
            display: flex;
            flex-direction: row; /* Ensure horizontal layout */
            align-items: center;
            gap: 8px; /* Spacing between buttons */
        }

        .os-window-controls .control-button {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.7em;
            color: var(--metal-text-color); /* Icon color on metal, now uses variable */
            cursor: pointer;
            transition: background-color 0.15s ease, transform 0.1s ease, box-shadow 0.15s ease;
            
            background: linear-gradient(to bottom, var(--metal-color-start) 0%, var(--metal-color-mid) 50%, var(--metal-color-end) 100%);
            border: 1px solid var(--metal-border-light); /* 顶部高光 */
            border-bottom-color: var(--metal-border-dark); /* 底部阴影 */
            border-right-color: var(--metal-border-dark);
            box-shadow: 
                inset 0 1px 2px var(--metal-highlight), 
                inset 0 -2px 5px var(--metal-inner-shadow),
                0 2px 6px var(--metal-shadow);

            position: relative;
            overflow: hidden;
        }
        .os-window-controls .control-button::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle at top left, rgba(0,255,65,0.05) 0%, transparent 60%); /* Very subtle green reflection */
            border-radius: 50%;
            opacity: 0.8;
            pointer-events: none;
        }

        /* 悬停/激活状态下的按钮颜色 */
        .os-window-controls .control-button:hover {
            transform: scale(1.1);
            filter: brightness(1.2);
            background: linear-gradient(to top, var(--metal-color-start) 0%, var(--metal-color-mid) 50%, var(--metal-color-end) 100%);
            border-color: var(--metal-border-light); /* Brighter border on hover */
            box-shadow: 
                inset 0 1px 3px var(--metal-highlight), 
                inset 0 -3px 6px var(--metal-inner-shadow),
                0 4px 10px var(--metal-shadow);
        }
        /* 关闭按钮的特殊悬停效果，如果需要红色 */
        .os-window-controls .control-button.close:hover {
             background: linear-gradient(to top, #FF4444 0%, #CC0000 100%); /* Red gradient for close */
             border-color: #FF0000;
             box-shadow: inset 0 -2px 10px rgba(0,0,0,0.6), 0 4px 10px rgba(255,0,0,0.6);
        }

        .os-window-controls .control-button:active {
            transform: scale(0.95);
            opacity: 1;
            background: linear-gradient(to bottom, var(--metal-color-end) 0%, var(--metal-color-mid) 50%, var(--metal-color-start) 100%);
            box-shadow: 
                inset 0 3px 10px var(--metal-shadow), 
                inset 0 -1px 3px var(--metal-highlight),
                0 2px 5px rgba(0,0,0,0.3); /* Subtle external shadow */
            filter: brightness(0.7); /* Darker on press */
            border-top-color: var(--metal-border-dark);
            border-bottom-color: var(--metal-border-light);
            border-left-color: var(--metal-border-dark);
            border-right-color: var(--metal-border-light);
        }
        .os-window-controls .control-button .icon-image {
            width: 0.9em;
            height: 0.9em;
            filter: drop-shadow(0 0 8px rgba(0, 255, 65, 0.8)); /* 修正：确保控制按钮图标有绿色光晕 */
        }
        .os-window-controls .control-button:not(.close):hover .icon-image { /* Restore green glow for non-close buttons on hover */
            filter: drop-shadow(0 0 5px var(--matrix-green-light));
        }


        /* 窗口内容区 - 黑色玻璃显示屏，绿色文字 */
        .os-window-content {
            flex-grow: 1;
            padding: 25px;
            background-color: rgba(0, 0, 0, 0.9); /* 黑色背景 */
            color: var(--matrix-green-light); /* 黑色背景上的文字为绿色 */
            font-size: 1rem;
            line-height: 1.7;
            overflow: auto;
            border-radius: 0 0 12px 12px; /* 底部圆角 */
            text-shadow: 0 0 1px rgba(0, 255, 65, 0.2); /* 绿色文字的微弱光晕 */
            /* Added subtle internal reflection */
            background-image: linear-gradient(to top right, rgba(255, 255, 255, 0.02) 0%, transparent 50%),
                              radial-gradient(circle at 5% 5%, rgba(255, 255, 255, 0.02) 0%, transparent 30%);
            box-shadow: inset 0 0 10px rgba(0, 255, 65, 0.1); /* Inner green glow for content area */
        }

        /* Markdown内容区专属样式 - 针对 Matrix 可读性优化 */
        .os-window-content .markdown-content h1 { font-size: 2.4em; margin-bottom: 0.7em; color: var(--matrix-green-light); border-bottom: 3px solid var(--matrix-green-dark); padding-bottom: 0.5em; text-shadow: var(--text-glow-matrix); }
        .os-window-content .markdown-content h2 { font-size: 2em; margin-bottom: 0.6em; color: var(--matrix-green-light); text-shadow: 0 0 1px rgba(0, 255, 65, 0.3); }
        .os-window-content .markdown-content h3 { font-size: 1.6em; margin-bottom: 0.5em; color: var(--matrix-green-light); text-shadow: 0 0 1px rgba(0, 255, 65, 0.2); }
        .os-window-content .markdown-content p { margin-bottom: 1.4em; opacity: 1; color: var(--matrix-green-light); text-shadow: 0 0 0.5px rgba(0, 255, 65, 0.1); }
        .os-window-content .markdown-content ul, .os-window-content .markdown-content ol { margin-left: 2.5em; margin-bottom: 1.4em; list-style-type: disc; opacity: 1; color: var(--matrix-green-light); text-shadow: 0 0 0.5px rgba(0, 255, 65, 0.1); }
        .os-window-content .markdown-content li { margin-bottom: 0.8em; }
        .os-window-content .markdown-content strong { font-weight: bold; color: var(--matrix-green-light); text-shadow: var(--text-glow-matrix); }
        .os-window-content .markdown-content em { font-style: italic; opacity: 1; color: var(--matrix-green-light); text-shadow: 0 0 0.5px rgba(0, 255, 65, 0.05); }
        .os-window-content .markdown-content a {
            color: var(--matrix-green-light);
            text-decoration: underline;
            text-shadow: var(--text-glow-matrix);
            transition: color 0.2s ease;
        }
        .os-window-content .markdown-content a:hover {
            color: white;
            text-shadow: 0 0 8px white;
        }
        .os-window-content .markdown-content code { background-color: #1a1a1a; padding: 0.3em 0.6em; border-radius: 4px; font-family: monospace; font-size: 0.95em; border: 1px solid var(--matrix-dark-grey); color: var(--matrix-green-light); text-shadow: 0 0 1px rgba(0,255,65,0.2); }
        .os-window-content .markdown-content pre { background-color: #111111; padding: 1.5em; border-radius: 8px; overflow-x: auto; margin-bottom: 1.8em; border: 1px solid var(--matrix-dark-grey); box-shadow: inset 0 0 5px rgba(0,255,65,0.1); color: var(--matrix-green-light); text-shadow: 0 0 1px rgba(0,255,65,0.2); }
        .os-window-content .markdown-content blockquote { border-left: 8px solid var(--matrix-green-light); padding-left: 2em; margin-left: 0; opacity: 1; background-color: #0d0d0d; border-radius: 8px; padding-top: 1em; padding-bottom: 1em; color: var(--matrix-green-light); text-shadow: 0 0 0.5px rgba(0,255,65,0.1); }


        /* 窗口弹出动画 */
        @keyframes windowPopIn {
            from {
                opacity: 0;
                transform: scale(0.9) translateY(20px);
            }
            to {
                opacity: 1;
                transform: scale(1) translateY(0);
            }
        }

        /* 作品集网格专属样式 */
        .works-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
            gap: 25px;
            padding: 20px;
        }

        .work-card {
            background: var(--glass-bg); /* Use glass background */
            border: 2px solid var(--glass-border);
            border-radius: 12px;
            overflow: hidden;
            cursor: pointer;
            transition: all 0.25s ease-in-out, filter 0.25s ease, box-shadow 0.25s ease;
            box-shadow: var(--glass-glow), var(--glass-inset-shadow);
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
            padding-bottom: 15px;
            position: relative;
            overflow: hidden;
            /* Added subtle glass reflection */
            background-image: linear-gradient(to top right, rgba(255, 255, 255, 0.05) 0%, transparent 50%),
                              radial-gradient(circle at 10% 10%, rgba(255, 255, 255, 0.05) 0%, transparent 30%);
        }
        .work-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle at top left, rgba(0,255,65,0.1) 0%, transparent 55%);
            border-radius: inherit;
            pointer-events: none;
        }


        .work-card:hover {
            transform: translateY(-10px) scale(1.05);
            box-shadow: 0 8px 25px var(--glow-matrix), var(--glass-inset-shadow);
            border-color: var(--matrix-green-light);
            filter: brightness(1.2);
            background: rgba(0, 0, 0, 0.9);
        }

        .work-card img {
            width: 100%;
            height: 180px;
            object-fit: cover;
            border-radius: 10px 10px 0 0;
            filter: brightness(0.8);
            transition: filter 0.2s ease;
        }

        .work-card:hover img {
            filter: brightness(1.0);
        }

        .work-card-title {
            font-size: 1.1rem;
            font-weight: bold;
            margin-top: 15px;
            color: var(--matrix-green-light);
            text-shadow: var(--text-glow-matrix);
        }

        .work-card-category {
            font-size: 0.9rem;
            color: rgba(0, 255, 65, 0.7);
            opacity: 0.95;
            margin-top: 6px;
        }

        /* 作品详情窗口专属样式 */
        .work-detail-content {
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .work-detail-content .gallery-main-image-container {
            position: relative;
            width: 100%;
            max-width: 700px;
            margin-bottom: 25px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
            border-radius: 8px;
            overflow: hidden;
            border: 3px solid var(--glass-border);
        }

        .work-detail-content .gallery-main-image {
            width: 100%;
            height: auto;
            display: block;
            border-radius: 6px;
        }

        .work-detail-content .gallery-nav-button {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            background: rgba(0, 0, 0, 0.8);
            color: var(--matrix-green-light);
            border: 2px solid var(--glass-border);
            padding: 15px;
            cursor: pointer;
            font-size: 2rem;
            border-radius: 50%;
            transition: background-color 0.25s ease, filter 0.25s ease, box-shadow 0.25s ease;
            z-index: 2;
            box-shadow: 0 6px 15px rgba(0,0,0,0.6), var(--glass-glow);
        }

        .work-detail-content .gallery-nav-button:hover {
            background: rgba(0, 0, 0, 0.95);
            filter: brightness(1.4);
            box-shadow: 0 8px 20px rgba(0,0,0,0.8), var(--glow-matrix);
        }
        .work-detail-content .gallery-nav-button .icon-image {
            width: 2em;
            height: 2em;
            filter: drop-shadow(0 0 8px rgba(0, 255, 65, 0.7));
        }

        .work-detail-content .gallery-nav-button.prev {
            left: 20px;
        }

        .work-detail-content .gallery-nav-button.next {
            right: 20px;
        }

        .work-detail-content .gallery-thumbnails {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 15px;
            margin-top: 20px;
            margin-bottom: 25px;
        }

        .work-detail-content .gallery-thumbnail {
            width: 100px;
            height: 80px;
            object-fit: cover;
            border-radius: 8px;
            border: 3px solid transparent;
            cursor: pointer;
            transition: border-color 0.25s ease, transform 0.15s ease, filter 0.25s ease, box-shadow 0.25s ease;
            box-shadow: 0 4px 12px rgba(0,0,0,0.4);
        }

        .work-detail-content .gallery-thumbnail.active {
            border-color: var(--matrix-green-light);
            transform: scale(1.15);
            box-shadow: var(--glass-glow);
        }
        .work-detail-content .gallery-thumbnail:hover {
            filter: brightness(1.2);
            box-shadow: var(--glass-glow);
        }

        .work-detail-content h3 {
            font-size: 2rem;
            font-weight: bold;
            color: var(--matrix-green-light);
            margin-bottom: 15px;
            text-align: center;
            text-shadow: var(--text-glow-matrix);
        }
        .work-detail-content p {
            margin-bottom: 15px;
            text-align: justify;
            font-size: 1rem;
            color: var(--matrix-green-light);
        }
        .work-detail-content .category-tag {
            display: inline-block;
            background-color: rgba(0, 255, 65, 0.3);
            border: 1px solid var(--matrix-green-dark);
            border-radius: 6px;
            padding: 6px 12px;
            font-size: 0.9rem;
            color: var(--matrix-green-light);
            margin-top: 15px;
            text-shadow: 0 0 5px rgba(0,0,0,0.6);
            box-shadow: inset 0 0 8px rgba(0,255,65,0.2);
        }
        .service-category-card {
            background: var(--glass-bg); /* Use glass background */
            border: 2px solid var(--glass-border);
            border-radius: 12px;
            overflow: hidden;
            cursor: pointer;
            transition: all 0.25s ease-in-out, filter 0.25s ease, box-shadow 0.25s ease;
            box-shadow: var(--glass-glow), var(--glass-inset-shadow);
            padding: 20px;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            min-height: 120px;
            position: relative;
            overflow: hidden;
            /* Added subtle glass reflection */
            background-image: linear-gradient(to top right, rgba(255, 255, 255, 0.05) 0%, transparent 50%),
                              radial-gradient(circle at 10% 10%, rgba(255, 255, 255, 0.05) 0%, transparent 30%);
        }
        .service-category-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle at top left, rgba(0,255,65,0.2) 0%, transparent 60%);
            border-radius: inherit;
            pointer-events: none;
        }
        .service-category-card:hover {
            transform: translateY(-8px) scale(1.03);
            box-shadow: 0 10px 25px var(--glow-matrix), var(--glass-inset-shadow);
            border-color: var(--matrix-green-light);
            filter: brightness(1.2);
            background: rgba(0, 0, 0, 0.9);
        }

        /* 任务栏最小化窗口图标 - 更玻璃质感 */
        .taskbar-minimized-icon {
            background: var(--glass-bg); /* Use glass background */
            border: 1px solid var(--glass-border);
            border-radius: 8px;
            padding: 8px 12px;
            margin: 0 5px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            color: var(--matrix-green-light);
            font-size: 0.9rem;
            box-shadow: var(--glass-inset-shadow), 0 2px 8px rgba(0,0,0,0.3);
            transition: all 0.25s ease;
            white-space: nowrap;
            max-width: 160px;
            overflow: hidden;
            text-overflow: ellipsis;
            position: relative;
            overflow: hidden;
            /* Added subtle glass reflection */
            background-image: linear-gradient(to top right, rgba(255, 255, 255, 0.03) 0%, transparent 50%);
        }
        .taskbar-minimized-icon::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle at top left, rgba(0,255,65,0.2) 0%, transparent 60%);
            border-radius: inherit;
            pointer-events: none;
        }


        .taskbar-minimized-icon:hover {
            background: rgba(0, 0, 0, 0.9);
            transform: translateY(-4px);
            box-shadow: var(--glass-glow), inset 0 -2px 10px rgba(0,0,0,0.6);
        }

        /* 激活状态下的任务栏图标样式 */
        .taskbar-minimized-icon.active {
            background: rgba(0, 0, 0, 0.95);
            border-color: var(--matrix-green-light);
            box-shadow: var(--glass-glow), inset 0 2px 8px rgba(0,0,0,0.7), 0 0 25px rgba(0, 255, 65, 0.9); /* Stronger outer glow */
            transform: translateY(0);
        }
        .taskbar-minimized-icon.active::before {
            background: radial-gradient(circle at top left, rgba(0,255,65,0.3) 0%, transparent 60%);
        }


        .taskbar-minimized-icon .icon-image {
            width: 1.2em;
            height: 1.2em;
            filter: drop-shadow(0 0 8px rgba(0, 255, 65, 0.8));
            transition: filter 0.2s ease;
        }
        .taskbar-minimized-icon.active .icon-image {
            filter: brightness(2) drop-shadow(0 0 15px rgba(0,255,65,1)); /* Even stronger icon glow */
        }

        /* 加载动画样式 */
        .loading-spinner {
            border: 5px solid rgba(0, 255, 65, 0.2);
            border-top: 5px solid var(--matrix-green-light);
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 0.8s linear infinite;
            margin: 25px auto;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* 语言选择子菜单 */
        .start-menu-submenu {
            position: absolute;
            left: 100%;
            top: 0;
            width: 250px;
            background: var(--glass-bg); /* Use glass background */
            backdrop-filter: blur(5px);
            -webkit-backdrop-filter: blur(5px);
            border: 2px solid var(--glass-border);
            border-radius: 12px;
            box-shadow: var(--glass-glow), var(--glass-inset-shadow);
            padding: 15px;
            display: none;
            flex-direction: column;
            z-index: 101;
            /* Added subtle glass reflection */
            background-image: linear-gradient(to top right, rgba(255, 255, 255, 0.05) 0%, transparent 50%);
        }
        .start-menu-item.has-submenu:hover .start-menu-submenu {
            display: flex;
        }

        /* 开关样式 - 更 Matrix 风格 */
        .toggle-switch {
            position: relative;
            display: inline-block;
            width: 70px;
            height: 40px;
        }

        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .toggle-slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: var(--matrix-dark-grey);
            -webkit-transition: .4s;
            transition: .4s;
            border-radius: 40px;
            box-shadow: inset 0 0 6px var(--metal-shadow);
            border: 2px solid var(--metal-border-dark);
        }

        .toggle-slider:before {
            position: absolute;
            content: "";
            height: 32px;
            width: 32px;
            left: 4px;
            bottom: 4px;
            /* Adjusted to use metal colors */
            background: linear-gradient(to bottom, var(--metal-color-mid) 0%, var(--metal-color-end) 100%); 
            -webkit-transition: .4s;
            transition: .4s;
            border-radius: 50%;
            box-shadow: 0 3px 8px var(--metal-shadow), inset 0 1px 4px var(--metal-highlight);
        }

        input:checked + .toggle-slider {
            background: linear-gradient(to right, var(--matrix-green-light) 0%, var(--matrix-green-dark) 100%);
            border-color: var(--matrix-green-dark);
        }

        input:focus + .toggle-slider {
            box-shadow: 0 0 1px var(--matrix-green-light), inset 0 0 8px var(--metal-shadow);
        }

        input:checked + .toggle-slider:before {
            -webkit-transform: translateX(30px);
            -ms-transform: translateX(30px);
            transform: translateX(30px);
        }

        /* 圆形滑块 */
        .toggle-slider.round {
            border-radius: 40px;
        }

        .toggle-slider.round:before {
            border-radius: 50%;
        }

        /* 自定义滚动条样式（Webkit浏览器如Chrome/Safari） */
        /* 滚动条轨道 */
        ::-webkit-scrollbar {
            width: 20px;
        }

        /* 滚动条滑块 */
        ::-webkit-scrollbar-thumb {
            background: linear-gradient(to bottom, var(--matrix-green-light), var(--matrix-green-dark));
            border-radius: 10px;
            border: 4px solid var(--matrix-dark-grey);
            transition: background 0.2s ease, box-shadow 0.2s ease;
            box-shadow: inset 0 0 10px rgba(0,255,65,0.3);
        }

        /* 滑块悬停时 */
        ::-webkit-scrollbar-thumb:hover {
            background: linear-gradient(to bottom, rgba(0, 255, 65, 1), rgba(0, 143, 17, 1));
            box-shadow: inset 0 0 12px rgba(0,255,65,0.4), 0 0 20px rgba(0,255,65,0.9);
        }

        /* 轨道背景 */
        ::-webkit-scrollbar-track {
            background: rgba(0, 0, 0, 0.5);
            border-radius: 10px;
        }

        /* 滚动条按钮（箭头） - 更突出更光泽 */
        .os-window ::-webkit-scrollbar-button {
            background: linear-gradient(to bottom, var(--metal-color-start) 0%, var(--metal-color-mid) 50%, var(--metal-color-end) 100%);
            border-radius: 50%;
            height: 28px;
            width: 28px;
            display: block;
            border: 2px solid var(--metal-border-light); /* 顶部高光 */
            border-bottom-color: var(--metal-border-dark); /* 底部阴影 */
            border-right-color: var(--metal-border-dark);
            box-shadow: 
                inset 0 1px 2px var(--metal-highlight), 
                inset 0 -2px 5px var(--metal-inner-shadow),
                0 2px 10px var(--metal-shadow);
            transition: background-color 0.15s ease, transform 0.08s ease, box-shadow 0.15s ease;
            color: var(--metal-text-color); /* Make arrow icons dark grey, now uses variable */
        }
        
        .os-window ::-webkit-scrollbar-button:hover {
            background: linear-gradient(to top, var(--metal-color-start) 0%, var(--metal-color-mid) 50%, var(--metal-color-end) 100%);
            transform: scale(1.15);
            filter: brightness(1.3);
            box-shadow: 
                inset 0 1px 3px var(--metal-highlight), 
                inset 0 -3px 6px var(--metal-inner-shadow),
                0 4px 15px var(--metal-shadow);
        }

        .os-window ::-webkit-scrollbar-button:active {
            background: linear-gradient(to bottom, var(--metal-color-end) 0%, var(--metal-color-mid) 50%, var(--metal-color-start) 100%);
            transform: scale(0.9);
            opacity: 1;
            box-shadow: 
                inset 0 3px 10px var(--metal-shadow), 
                inset 0 -1px 3px var(--metal-highlight),
                0 0 10px rgba(0,255,65,0.7);
            filter: brightness(0.8);
            border-top-color: var(--metal-border-dark);
            border-bottom-color: var(--metal-border-light);
            border-left-color: var(--metal-border-dark);
            border-right-color: var(--metal-border-light);
        }

        /* Firefox滚动条样式 */
        html {
            scrollbar-width: thin;
            scrollbar-color: var(--matrix-green-light) rgba(0, 0, 0, 0.5);
        }

        /* --- 移动端适配 (max-width: 768px) --- */
        @media (max-width: 768px) {
            .os-window {
                min-width: 90vw; /* 调整最小宽度 */
                min-height: 50vh; /* 调整最小高度 */
                width: 95vw !important; /* 强制窗口宽度为视口宽度的95% */
                height: 80vh !important; /* 强制窗口高度为视口高度的80% */
                left: 2.5vw !important; /* 居中 */
                top: 5vh !important; /* 顶部留白 */
                transform: none !important; /* 移除任何transform，确保位置正确 */
                border-radius: 8px; /* 移动端可以小一点的圆角 */
                box-shadow: 0 5px 20px rgba(0,0,0,0.5), inset 0 0 15px rgba(0,255,65,0.2);
            }

            .os-window.maximized {
                border-radius: 0; /* 最大化时无圆角 */
            }

            .start-menu {
                width: 95vw; /* 开始菜单占据大部分宽度 */
                left: 2.5vw; /* 居中 */
                padding: 15px; /* 调整内边距 */
                border-radius: 12px;
                max-height: calc(100% - var(--taskbar-height) - 20px); /* 适应移动端高度 */
            }

            .desktop-icon {
                width: 80px; /* 减小桌面图标宽度 */
                padding: 5px;
            }

            .desktop-icon .icon-image {
                width: 50px; /* 减小图标图片尺寸 */
                height: 50px;
            }

            .desktop-icon-label {
                font-size: 0.8rem; /* 减小标签字体大小 */
                margin-top: 5px;
            }

            .taskbar {
                height: 44px; /* 任务栏高度可以略小 */
            }

            .start-button {
                width: 40px; /* 开始按钮略小 */
                height: 40px;
            }

            .start-button .icon-image {
                width: 1.8em;
                height: 1.8em;
            }

            .system-tray-icon {
                font-size: 1rem; /* 系统托盘图标略小 */
                padding: 6px;
            }

            .system-tray-icon .icon-image {
                width: 1em;
                height: 1em;
            }

            #current-time {
                font-size: 0.8rem; /* 时间字体略小 */
            }

            .os-window-content {
                padding: 15px; /* 窗口内容区内边距调整 */
            }

            .os-window-content .markdown-content h1 { font-size: 2em; }
            .os-window-content .markdown-content h2 { font-size: 1.8em; }
            .os-window-content .markdown-content h3 { font-size: 1.4em; }
            .os-window-content .markdown-content p { font-size: 0.95rem; }

            .works-grid {
                grid-template-columns: repeat(auto-fill, minmax(140px, 1f r)); /* 作品集网格列数调整 */
                gap: 15px;
                padding: 10px;
            }

            .work-card img {
                height: 120px; /* 作品卡片图片高度调整 */
            }

            .work-card-title {
                font-size: 1rem;
            }
            .work-card-category {
                font-size: 0.8rem;
            }

            .work-detail-content .gallery-main-image-container {
                margin-bottom: 15px;
            }
            .work-detail-content .gallery-nav-button {
                font-size: 1.5rem; /* 画廊导航按钮尺寸调整 */
                padding: 10px;
            }
            .work-detail-content .gallery-thumbnail {
                width: 80px; /* 缩略图尺寸调整 */
                height: 60px;
            }
        }

        /* 窗口状态栏 - 高度拟物化的金属边框 */
        .os-window-status-bar {
            padding: 8px 18px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 0.85rem;
            background: linear-gradient(to bottom, var(--metal-color-start) 0%, var(--metal-color-mid) 50%, var(--metal-color-end) 100%);
            backdrop-filter: blur(5px);
            -webkit-backdrop-filter: blur(5px);
            border-top: 2px solid var(--metal-border-light); /* 顶部高光 */
            border-bottom: 1px solid var(--metal-border-dark); /* 底部阴影 */
            border-radius: 0 0 12px 12px;
            color: var(--metal-text-color); /* 文字颜色改为深灰色 */
            text-shadow: none; /* 移除文字阴影 */
            box-shadow: 
                inset 0 1px 2px var(--metal-highlight), 
                inset 0 -2px 5px var(--metal-inner-shadow),
                0 2px 5px var(--metal-shadow);
            overflow: hidden;
        }
        .os-window-status-bar::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: repeating-linear-gradient(90deg, transparent, transparent 1px, var(--metal-bg) 1px, var(--metal-bg) 2px); /* 细微的金属拉丝纹理 */
            pointer-events: none;
            opacity: 0.8;
        }

        .os-window-status-bar .status-text {
            color: var(--metal-text-color); /* 文字颜色改为深灰色 */
            opacity: 0.9;
            font-weight: 500;
        }

        .os-window-status-bar .system-branding-text {
            color: var(--metal-text-color); /* 文字颜色改为深灰色 */
            font-weight: bold;
            text-shadow: none; /* 移除文字阴影 */
            opacity: 0.9;
        }
    </style>
</head>
<body>
    <!-- 桌面背景层，用于动态 Frutiger Aero 风格背景 -->
    <div class="desktop-background" id="desktop-background"></div>

    <!-- 桌面容器，模拟屏幕 -->
    <div class="desktop-container" id="desktop-container">
        <!-- 桌面布局 - 包含主桌面区和任务栏 -->
        <div class="desktop-layout">
            <!-- 主桌面区 - 图标和窗口所在区域 -->
            <div class="main-desktop-area" id="main-desktop-area">
                <!-- 桌面图标（快捷方式） -->
                <div class="desktop-icons-container" id="desktop-icons-container">
                    <div class="desktop-icon" data-section="works" data-title-zh="我的作品集" data-title-en="My Works">
                        <span class="icon-placeholder" data-asset-key="icon_works"></span>
                        <span class="desktop-icon-label" data-lang-key="worksIcon">作品集</span>
                    </div>
                    <div class="desktop-icon" data-section="characters" data-title-zh="角色库" data-title-en="Characters">
                        <span class="icon-placeholder" data-asset-key="icon_characters"></span>
                        <span class="desktop-icon-label" data-lang-key="charactersIcon">角色</span>
                    </div>
                    <!-- 关于我图标更改为 mazko.exe 和 M 图标 -->
                    <div class="desktop-icon" data-section="about" data-title-zh="关于 MAZKO" data-title-en="About MAZKO">
                        <span class="icon-placeholder" data-asset-key="icon_mazko_logo"></span>
                        <span class="desktop-icon-label" data-lang-key="mazkoExeIcon">MAZKO</span>
                    </div>
                    <div class="desktop-icon" data-section="services" data-title-zh="服务与报价" data-title-en="Services & Pricing">
                        <span class="icon-placeholder" data-asset-key="icon_services"></span>
                        <span class="desktop-icon-label" data-lang-key="servicesIcon">服务</span>
                    </div>
                    <div class="desktop-icon" data-section="socials" data-title-zh="社交媒体" data-title-en="Social Media">
                        <span class="icon-placeholder" data-asset-key="icon_socials"></span>
                        <span class="desktop-icon-label" data-lang-key="socialsIcon">社交</span>
                    </div>
                    <!-- 新增的数据核心应用程序图标 -->
                    <div class="desktop-icon" data-section="data-core" data-title-zh="數據ᕼᣯ鈊 ⸸ Dᴬᵀᴬ.Cᴼᴿᴱ ☍" data-title-en="DATA.CORE">
                        <span class="icon-placeholder" data-asset-key="icon_datacore"></span>
                        <span class="desktop-icon-label" data-lang-key="datacoreIcon">數據核心</span>
                    </div>
                </div>
                <!-- 窗口将通过 JavaScript 附加在这里 -->
            </div>

            <!-- 开始菜单 -->
            <div id="start-menu" class="start-menu hidden">
                <div class="start-menu-header" data-section="about" data-title-zh="关于 MAZKO" data-title-en="About MAZKO"> <!-- 点击头部打开关于我 -->
                    <span class="icon-placeholder" data-asset-key="icon_mazko_logo"></span>
                    <span data-lang-key="profileName">MAZKO</span>
                </div>
                <a href="#" class="start-menu-item" data-section="works" data-lang-key="worksMenuItem" data-title-zh="我的作品集" data-title-en="My Works">
                    <span class="icon-placeholder" data-asset-key="icon_works"></span>
                    <span class="menu-item-label"></span>
                </a>
                <a href="#" class="start-menu-item" data-section="characters" data-lang-key="charactersMenuItem" data-title-zh="角色库" data-title-en="Characters">
                    <span class="icon-placeholder" data-asset-key="icon_characters"></span>
                    <span class="menu-item-label"></span>
                </a>
                <a href="#" class="start-menu-item" data-section="services" data-lang-key="servicesMenuItem" data-title-zh="服务与报价" data-title-en="Services & Pricing">
                    <span class="icon-placeholder" data-asset-key="icon_services"></span>
                    <span class="menu-item-label"></span>
                </a>
                <a href="#" class="start-menu-item" data-section="socials" data-lang-key="socialsMenuItem" data-title-zh="社交媒体" data-title-en="Social Media">
                    <span class="icon-placeholder" data-asset-key="icon_socials"></span>
                    <span class="menu-item-label"></span>
                </a>
                <!-- 新增的数据核心应用程序菜单项 -->
                <a href="#" class="start-menu-item" data-section="data-core" data-lang-key="datacoreMenuItem" data-title-zh="數據ᕼᣯ鈊 ⸸ Dᴬᵀᴬ.Cᴼᴿᴱ ☍" data-title-en="DATA.CORE">
                    <span class="icon-placeholder" data-asset-key="icon_datacore"></span>
                    <span class="menu-item-label"></span>
                </a>
                <!-- 移除水平分隔线 -->
                <!-- <div class="border-t border-gray-600 my-2 mx-4"></div> -->
                <!-- 设置和关机按钮在一个容器中，现在使用 start-menu-footer-button 类 -->
                <div class="start-menu-buttons-container">
                    <button class="start-menu-footer-button" data-section="settings" data-lang-key="settingsMenuItem" title="设置" data-title-zh="系统设置" data-title-en="Settings">
                        <span class="icon-placeholder" data-asset-key="icon_settings"></span>
                        <!-- 移除文本span -->
                    </button>
                    <button class="start-menu-footer-button" data-section="shutdown" data-lang-key="shutdownMenuItem" title="关闭系统" data-title-zh="关闭系统" data-title-en="Shutdown">
                        <span class="icon-placeholder" data-asset-key="icon_shutdown"></span>
                        <!-- 移除文本span -->
                    </button>
                </div>
            </div>

            <!-- 任务栏底部 -->
            <div class="taskbar" id="taskbar">
                <!-- 开始按钮更改为 M 图标 -->
                <button class="start-button" id="start-button-taskbar">
                    <span class="icon-placeholder" data-asset-key="icon_mazko_logo" id="start-button-icon-placeholder"></span>
                    <!-- <span data-lang-key="startButton">开始</span> 移除文本 -->
                </button>

                <!-- 任务栏图标（打开/最小化窗口） -->
                <div id="taskbar-icons" class="taskbar-icons-container">
                    <!-- 最小化窗口图标将附加在这里 -->
                </div>

                <!-- 右侧系统托盘 -->
                <div class="system-tray">
                    <div class="system-tray-icon">
                        <span class="icon-placeholder" data-asset-key="icon_wifi"></span>
                    </div>
                    <div class="system-tray-icon">
                        <span class="icon-placeholder" data-asset-key="icon_battery"></span>
                    </div>
                    <div class="system-tray-icon">
                        <span class="icon-placeholder" data-asset-key="icon_volume"></span>
                    </div>
                    <span class="text-sm opacity-80 system-tray-text" id="current-time"></span> <!-- 时间显示，使用新的system-tray-text类 -->
                </div>
            </div>
        </div>
    </div>

    <script>
        /**
         * @object ASSETS
         * @description 所有图片和图标路径的集中管理。
         * 所有资产现在都经过Base64编码或使用相对路径。
         */
        const ASSETS = {
            // 光标图像 (默认黑色点，活动时十字，指针时箭头)
            'cursor_default': 'data:image/svg+xml,%3Csvg width=\'16\' height=\'16\' viewBox=\'0 0 16 16\' fill=\'none\' xmlns=\'http://www.w3.org/2000/svg\'%3E%3Ccircle cx=\'8\' cy=\'8\' r=\'2\' fill=\'%2300FF41\'/%3E%3C/svg%3E',
            'cursor_active': 'data:image/svg+xml,%3Csvg width=\'16\' height=\'16\' viewBox=\'0 0 16 16\' fill=\'none\' xmlns=\'http://www.w3.org/2000/svg\'%3E%3Cpath d=\'M8 0V16M0 8H16\' stroke=\'%2300FF41\' stroke-width=\'2\'/%3E%3C/svg%3E',
            'cursor_pointer': 'data:image/svg+xml,%3Csvg width=\'16\' height=\'16\' viewBox=\'0 0 16 16\' fill=\'none\' xmlns=\'http://www.w3.org/2000/svg\'%3E%3Cpath d=\'M1 1L15 8L1 15V1L1 1Z\' fill=\'%2300FF41\' stroke=\'%2300FF41\' stroke-width=\'1\'/%3E%3C/svg%3E',

            // 桌面图标 / 开始菜单图标 (PNGs with relative paths) - 路径已修正为从 docs 目录开始
            'icon_works': '../assets/icon/file_icon.png', 
            'icon_characters': '../assets/icon/storage_icon.png', 
            'icon_mazko_logo': '../assets/icon/radiation m logo 1.png', 
            'icon_services': 'data:image/svg+xml,%3Csvg width=\'64\' height=\'64\' viewBox=\'0 0 24 24\' fill=\'none\' xmlns=\'http://www.w3.org/2000/svg\'%3E%3Cpath d=\'M18 13.5V18C18 19.1046 17.1046 20 16 20H4C2.89543 20 2 19.1046 2 18V6C2 4.89543 2.89543 4 4 4H10.5M18 13.5L22 9.5M22 9.5L18 5.5M22 9.5H16M13 10L10.5 12.5L13 15\' stroke=\'%2300FF41\' stroke-width=\'2\' stroke-linecap=\'round\' stroke-linejoin=\'round\'/%3E%3C/svg%3E',
            'icon_socials': 'data:image/svg+xml,%3Csvg width=\'64\' height=\'64\' viewBox=\'0 0 24 24\' fill=\'none\' xmlns=\'http://www.w3.org/2000/svg\'%3E%3Cpath d=\'M18 8C19.6569 8 21 6.65685 21 5C21 3.34315 19.6569 2 18 2C16.3431 2 15 3.34315 15 5C15 6.65685 16.3431 8 18 8Z\' stroke=\'%2300FF41\' stroke-width=\'2\' stroke-linecap=\'round\' stroke-linejoin=\'round\'/%3E%3Cpath d=\'M6 15C7.65685 15 9 13.6569 9 12C9 10.3431 7.65685 9 6 9C4.34315 9 3 10.3431 3 12C3 13.6569 4.34315 15 6 15Z\' stroke=\'%2300FF41\' stroke-width=\'2\' stroke-linecap=\'round\' stroke-linejoin=\'round\'/%3E%3Cpath d=\'M18 22C19.6569 22 21 20.6569 21 19C21 17.3431 19.6569 16 18 16C16.3431 16 15 17.3431 15 19C15 20.6569 16.3431 22 18 22Z\' stroke=\'%2300FF41\' stroke-width=\'2\' stroke-linecap=\'round\' stroke-linejoin=\'round\'/%3E%3Cpath d=\'M8.59 13.51L15.42 17.49\' stroke=\'%2300FF41\' stroke-width=\'2\' stroke-linecap=\'round\' stroke-linejoin=\'round\'/%3E%3Cpath d=\'M15.41 6.51L8.59 10.49\' stroke=\'%2300FF41\' stroke-width=\'2\' stroke-linecap=\'round\' stroke-linejoin=\'round\'/%3E%3C/svg%3E',
            'icon_datacore': '../assets/icon/datacore_logo.png', 
            
            // 任务栏系统托盘图标 (SVG with green strokes/fills) - 更新填充为绿色
            'icon_wifi': 'data:image/svg+xml,%3Csvg width=\'24\' height=\'24\' viewBox=\'0 0 24 24\' fill=\'none\' xmlns=\'http://www.w3.org/2000/svg\'%3E%3Cpath d=\'M12 18V22\' stroke=\'%2300FF41\' stroke-width=\'2\' stroke-linecap=\'round\' stroke-linejoin=\'round\'/%3E%3Cpath d=\'M12 12L12.01 12\' stroke=\'%2300FF41\' stroke-width=\'2\' stroke-linecap=\'round\' stroke-linejoin=\'round\'/%3E%3Cpath d=\'M2.99998 8.00002C5.99998 5.00002 9.00002 3.00002 12 3.00002C15 3.00002 18 5.00002 21 8.00002\' stroke=\'%2300FF41\' stroke-width=\'2\' stroke-linecap=\'round\' stroke-linejoin=\'round\'/%3E%3Cpath d=\'M5.99998 11C7.99998 9 10 7.99998 12 7.99998C14 7.99998 16 9 18 11\' stroke=\'%2300FF41\' stroke-width=\'2\' stroke-linecap=\'round\' stroke-linejoin=\'round\'/%3E%3C/svg%3E',
            'icon_battery': 'data:image/svg+xml,%3Csvg width=\'24\' height=\'24\' viewBox=\'0 0 24 24\' fill=\'none\' xmlns=\'http://www.w3.org/2000/svg\'%3E%3Cpath d=\'M15 6H19C19.5523 6 20 6.44772 20 7V17C20 17.5523 19.5523 18 19 18H5C4.44772 18 4 17.5523 4 17V7C4 6.44772 4.44772 6 5 6H9M15 6V4C15 3.44772 14.5523 3 14 3H10C9.44772 3 9 3.44772 9 4V6M15 6H9M22 10V14\' stroke=\'%2300FF41\' stroke-width=\'2\' stroke-linecap=\'round\' stroke-linejoin=\'round\'/%3E%3C/svg%3E',
            'icon_volume': 'data:image/svg+xml,%3Csvg width=\'24\' height=\'24\' viewBox=\'0 0 24 24\' fill=\'none\' xmlns=\'http://www.w3.org/2000/svg\'%3E%3Cpath d=\'M11 5L6 9H2V15H6L11 19V5Z\' stroke=\'%2300FF41\' stroke-width=\'2\' stroke-linecap=\'round\' stroke-linejoin=\'round\'/%3E%3Cpath d=\'M19.07 4.93C20.6695 6.52936 21.5583 8.70776 21.5583 11C21.5583 13.2922 20.6695 15.4706 19.07 17.07\' stroke=\'%2300FF41\' stroke-width=\'2\' stroke-linecap=\'round\' stroke-linejoin=\'round\'/%3E%3Cpath d=\'M15.54 8.46C16.3262 9.24614 16.7644 10.2986 16.7644 11.39C16.7644 12.4814 16.3262 13.5339 15.54 14.32\' stroke=\'%2300FF41\' stroke-width=\'2\' stroke-linecap=\'round\' stroke-linejoin=\'round\'/%3E%3C/svg%3E',

            // 开始菜单底部按钮图标 (SVG with black strokes/fills)
            'icon_settings': 'data:image/svg+xml,%3Csvg width=\'32\' height=\'32\' viewBox=\'0 0 24 24\' fill=\'none\' xmlns=\'http://www.w3.org/2000/svg\'%3E%3Cpath d=\'M12 2C12.5523 2 13 2.44772 13 3V5.07409C14.7351 5.25367 16.3475 5.92383 17.7088 6.98066L19.2912 5.3983C19.6817 5.00782 20.3183 5.00782 20.7088 5.3983L21.5983 6.28779C21.9888 6.67828 21.9888 7.31482 21.5983 7.70531L19.9575 9.34612C21.0143 10.7074 21.6845 12.3198 21.864 14H24V14C24 14.5523 23.5523 15 23 15H20.9259C20.7463 16.7351 20.0762 18.3475 19.0193 19.7088L20.6017 21.2912C20.9922 21.6817 20.9922 22.3183 20.6017 22.7088L19.7122 23.5983C19.3217 23.9888 18.6852 23.9888 18.2947 23.5983L16.6539 21.9575C15.2926 23.0143 13.6802 23.6845 12 23.864V24C11.4477 24 11 23.5523 11 23V21.864C9.26493 21.6845 7.65251 21.0143 6.29119 19.9575L4.70883 21.54C4.31834 21.9305 3.68179 21.9305 3.29131 21.54L2.40181 20.6505C2.01132 20.26 2.01132 19.6235 2.40181 19.233L4.04262 17.5922C2.98576 16.2309 2.31557 14.6185 2.13603 12.8833H0V12C0 11.4477 0.447715 11 1 11H3.07409C3.25367 9.26493 3.92383 7.65251 4.98066 6.29119L3.3983 4.70883C3.00782 4.31834 3.00782 3.68179 3.3983 3.29131L4.28779 2.40181C4.67828 2.01132 5.31482 2.01132 5.70531 2.40181L7.34612 4.04262C8.70744 2.98576 10.3198 2.31557 12 2.13603V2Z\' stroke=\'%23080808\' stroke-width=\'2\' stroke-linecap=\'round\' stroke-linejoin=\'round\'/%3E%3Ccircle cx=\'12\' cy=\'12\' r=\'3\' stroke=\'%23080808\' stroke-width=\'2\' stroke-linecap=\'round\' stroke-linejoin=\'round\'/%3E%3C/svg%3E',
            'icon_shutdown': 'data:image/svg+xml,%3Csvg width=\'24\' height=\'24\' viewBox=\'0 0 24 24\' fill=\'none\' xmlns=\'http://www.w3.org/2000/svg\'%3E%3Cpath d=\'M12 2V12\' stroke=\'%23080808\' stroke-width=\'2\' stroke-linecap=\'round\' stroke-linejoin=\'round\'/%3E%3Cpath d=\'M18.364 5.63604C20.4184 7.69036 21.5817 10.3913 21.5817 13.2091C21.5817 16.0269 20.4184 18.7277 18.364 20.7821C16.3096 22.8364 13.6087 24 10.7909 24C7.97314 24 5.27228 22.8364 3.21796 20.7821C1.16364 18.7277 0 16.0269 0 13.2091C0 10.3913 1.16364 7.69036 3.21796 5.63604\' stroke=\'%23080808\' stroke-width=\'2\' stroke-linecap=\'round\' stroke-linejoin=\'round\'/%3E%3C/svg%3E',

            // 窗口控制按钮图标 (SVG with black strokes/fills)
            'icon_minus': 'data:image/svg+xml,%3Csvg width=\'24\' height=\'24\' viewBox=\'0 0 24 24\' fill=\'none\' xmlns=\'http://www.w3.org/2000/svg\'%3E%3Cpath d=\'M5 12H19\' stroke=\'%23080808\' stroke-width=\'2\' stroke-linecap=\'round\' stroke-linejoin=\'round\'/%3E%3C/svg%3E',
            'icon_square': 'data:image/svg+xml,%3Csvg width=\'24\' height=\'24\' viewBox=\'0 0 24 24\' fill=\'none\' xmlns=\'http://www.w3.org/2000/svg\'%3E%3Crect x=\'3\' y=\'3\' width=\'18\' height=\'18\' rx=\'2\' stroke=\'%23080808\' stroke-width=\'2\' stroke-linecap=\'round\' stroke-linejoin=\'round\'/%3E%3C/svg%3E',
            'icon_times': 'data:image/svg+xml,%3Csvg width=\'24\' height=\'24\' viewBox=\'0 0 24 24\' fill=\'none\' xmlns=\'http://www.w3.org/2000/svg\'%3E%3Cpath d=\'M6 18L18 6M6 6L18 18\' stroke=\'%23080808\' stroke-width=\'2\' stroke-linecap=\'round\' stroke-linejoin=\'round\'/%3E%3C/svg%3E',
            'icon_window_restore': 'data:image/svg+xml,%3Csvg width=\'24\' height=\'24\' viewBox=\'0 0 24 24\' fill=\'none\' xmlns=\'http://www.w3.org/2000/svg\'%3E%3Cpath d=\'M4 14C4 12.8954 4.89543 12 6 12H18C19.1046 12 20 12.8954 20 14V18C20 19.1046 19.1046 20 18 20H6C4.89543 20 4 19.1046 4 18V14Z\' stroke=\'%23080808\' stroke-width=\'2\' stroke-linecap=\'round\' stroke-linejoin=\'round\'/%3E%3Cpath d=\'M8 4C8 2.89543 8.89543 2 10 2H18C19.1046 2 20 2.89543 20 4V8\' stroke=\'%23080808\' stroke-width=\'2\' stroke-linecap=\'round\' stroke-linejoin=\'round\'/%3E%3C/svg%3E',

            // 画廊导航按钮图标 (SVG with green strokes/fills)
            'icon_chevron_left': 'data:image/svg+xml,%3Csvg width=\'24\' height=\'24\' viewBox=\'0 0 24 24\' fill=\'none\' xmlns=\'http://www.w3.org/2000/svg\'%3E%3Cpath d=\'M15 18L9 12L15 6\' stroke=\'%2300FF41\' stroke-width=\'2\' stroke-linecap=\'round\' stroke-linejoin=\'round\'/%3E%3C/svg%3E',
            'icon_chevron_right': 'data:image/svg+xml,%3Csvg width=\'24\' height=\'24\' viewBox=\'0 0 24 24\' fill=\'none\' xmlns=\'http://www.w3.org/2000/svg\'%3E%3Cpath d=\'M9 18L15 12L9 6\' stroke=\'%2300FF41\' stroke-width=\'2\' stroke-linecap=\'round\' stroke-linejoin=\'round\'/%3E%3C/svg%3E',

            // 社交媒体图标 (SVG with green strokes/fills)
            'icon_weibo': 'data:image/svg+xml,%3Csvg width=\'24\' height=\'24\' viewBox=\'0 0 24 24\' fill=\'none\' xmlns=\'http://www.w3.org/2000/svg\'%3E%3Cpath d=\'M12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2Z\' fill=\'%2300FF41\'/%3E%3Cpath d=\'M15.5 8C15.5 7.44772 15.0523 7 14.5 7H9.5C8.94772 7 8.5 7.44772 8.5 8V16C8.5 16.5523 8.94772 17 9.5 17H14.5C15.0523 17 15.5 16.5523 15.5 16V8Z\' stroke=\'%2300FF41\' stroke-width=\'2\' stroke-linecap=\'round\' stroke-linejoin=\'round\'/%3E%3Cpath d=\'M12 10.5C12.8284 10.5 13.5 9.82843 13.5 9C13.5 8.17157 12.8284 7.5 12 7.5C11.1716 7.5 10.5 8.17157 10.5 9C10.5 9.82843 11.1716 10.5 12 10.5Z\' fill=\'%2300FF41\'/%3E%3Cpath d=\'M12 13C12.8284 13 13.5 12.3284 13.5 11.5C13.5 10.6716 12.8284 10 12 10C11.1716 10 10.5 10.6716 10.5 11.5C10.5 12.3284 11.1716 13 12 13Z\' fill=\'%2300FF41\'/%3E%3C/svg%3E',
            'icon_instagram': 'data:image/svg+xml,%3Csvg width=\'24\' height=\'24\' viewBox=\'0 0 24 24\' fill=\'none\' xmlns=\'http://www.w3.org/2000/svg\'%3E%3Crect x=\'2\' y=\'2\' width=\'20\' height=\'20\' rx=\'5\' stroke=\'%2300FF41\' stroke-width=\'2\' stroke-linecap=\'round\' stroke-linejoin=\'round\'/%3E%3Cpath d=\'M16 3H16.01\' stroke=\'%2300FF41\' stroke-width=\'2\' stroke-linecap=\'round\' stroke-linejoin=\'round\'/%3E%3Cpath d=\'M12 7C9.23858 7 7 9.23858 7 12C7 14.7614 9.23858 17 12 17C14.7614 17 17 14.7614 17 12C17 9.23858 14.7614 7 12 7Z\' stroke=\'%2300FF41\' stroke-width=\'2\' stroke-linecap=\'round\' stroke-linejoin=\'round\'/%3E%3C/svg%3E',
            'icon_artstation': 'data:image/svg+xml,%3Csvg width=\'24\' height=\'24\' viewBox=\'0 0 24 24\' fill=\'none\' xmlns=\'http://www.w3.org/2000/svg\'%3E%3Cpath d=\'M12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2Z\' fill=\'%2300FF41\'/%3E%3Cpath d=\'M12 6L18 18H6L12 6Z\' fill=\'%2300FF41\'/%3E%3C/svg%3E',
            'icon_behance_square': 'data:image/svg+xml,%3Csvg width=\'24\' height=\'24\' viewBox=\'0 0 24 24\' fill=\'none\' xmlns=\'http://www.w3.org/2000/svg\'%3E%3Crect x=\'2\' y=\'2\' width=\'20\' height=\'20\' rx=\'2\' stroke=\'%2300FF41\' stroke-width=\'2\' stroke-linecap=\'round\' stroke-linejoin=\'round\'/%3E%3Cpath d=\'M16 10C16 8.89543 15.1046 8 14 8H10C8.89543 8 8 8.89543 8 10V14C8 15.1046 8.89543 16 10 16H14C15.1046 16 16 15.1046 16 14V10Z\' stroke=\'%2300FF41\' stroke-width=\'2\' stroke-linecap=\'round\' stroke-linejoin=\'round\'/%3E%3Cpath d=\'M10 8L14 16\' stroke=\'%2300FF41\' stroke-width=\'2\' stroke-linecap=\'round\' stroke-linejoin=\'round\'/%3E%3C/svg%3E',
            'icon_envelope': 'data:image/svg+xml,%3Csvg width=\'24\' height=\'24\' viewBox=\'0 0 24 24\' fill=\'none\' xmlns=\'http://www.w3.org/2000/svg\'%3E%3Cpath d=\'M4 4H20C21.1046 4 22 4.89543 22 6V18C22 19.1046 21.1046 20 20 20H4C2.89543 20 2 19.1046 2 18V6C2 4.89543 2.89543 4 4 4Z\' stroke=\'%2300FF41\' stroke-width=\'2\' stroke-linecap=\'round\' stroke-linejoin=\'round\'/%3E%3Cpath d=\'M22 6L12 13L2 6\' stroke=\'%2300FF41\' stroke-width=\'2\' stroke-linecap=\'round\' stroke-linejoin=\'round\'/%3E%3C/svg%3E',

            // 桌面背景图像 (使用相对路径) - 路径已修正为从 ../assets/... 目录开始
            'desktop_background_image': '../assets/backgrounds/bg.jpg',

            // 作品集图片 - 路径已修正为从 ../assets/... 目录开始
            'work_001_thumbnail': '../assets/works/work_001_thumbnail.png',
            'work_001_full_1': '../assets/works/work_001_full_1.png',
            'work_001_full_2': '../assets/works/work_001_full_2.png',
            'work_001_full_3': '../assets/works/work_001_full_3.png',
            'work_002_thumbnail': '../assets/works/work_002_thumbnail.png',
            'work_002_full_1': '../assets/works/work_002_full_1.png',
            'work_002_full_2': '../assets/works/work_002_full_2.png',
            'work_002_full_3': '../assets/works/work_002_full_3.png',

            // 角色图片 - 路径已修正为从 ../assets/... 目录开始
            'char_001_image': '../assets/characters/char_001_image.png',
            'char_002_image': '../assets/characters/char_002_image.png',

            // 数据核心灵感图片 - 路径已修正为从 ../assets/... 目录开始
            'inspiration_1_thumb': '../assets/data-core/inspiration_1_thumb.jpg',
            'inspiration_1_full': '../assets/data-core/inspiration_1_full.jpg',
            'inspiration_2_thumb': '../assets/data-core/inspiration_2_thumb.jpg',
            'inspiration_2_full': '../assets/data-core/inspiration_2_full.jpg',
            'inspiration_3_thumb': '../assets/data-core/inspiration_3_thumb.jpg',
            'inspiration_3_full': '../assets/data-core/inspiration_3_full.jpg',
            'inspiration_4_thumb': '../assets/data-core/inspiration_4_thumb.jpg',
            'inspiration_4_full': '../assets/data-core/inspiration_4_full.jpg',
            'inspiration_5_thumb': '../assets/data-core/inspiration_5_thumb.jpg',
            'inspiration_5_full': '../assets/data-core/inspiration_5_full.jpg',
            'inspiration_6_thumb': '../assets/data-core/inspiration_6_thumb.jpg',
            'inspiration_6_full': '../assets/data-core/inspiration_6_full.jpg',
            'inspiration_7_thumb': '../assets/data-core/inspiration_7_thumb.jpg',
            'inspiration_7_full': '../assets/data-core/inspiration_7_full.jpg',
            'inspiration_8_thumb': '../assets/data-core/inspiration_8_thumb.jpg',
            'inspiration_8_full': '../assets/data-core/inspiration_8_full.jpg'
        };

        /**
         * @function getAssetUrl
         * @description 从 ASSETS 对象中检索指定资产的URL。
         * 如果资产值是 Base64 字符串，则直接返回。
         * 如果资产值是相对路径，则返回该路径。
         * @param {string} assetKey - ASSETS 对象中的键名。
         * @returns {string} 相应资产的URL路径。
         */
        function getAssetUrl(assetKey) {
            const assetValue = ASSETS[assetKey];
            if (!assetValue) {
                console.warn(`Asset with key "${assetKey}" not found.`);
                return ''; // Or a placeholder image URL
            }
            // Check if it's a Base64 string (starts with 'data:image/')
            if (assetValue.startsWith('data:image/')) {
                return assetValue;
            } else {
                // Assume it's a relative path to a file
                return assetValue;
            }
        }


        /**
         * @object LANG_CONTENT
         * @description 用于UI的集中式多语言内容。
         */
        const LANG_CONTENT = {
            zh: {
                systemName: 'MAX OS',
                systemVersion: 'v1.0.0',
                welcomeMessage: '欢迎来到 MAZKO 的虚拟终端',
                loadingMessage: '加载中...',
                errorLoadingContent: '加载内容失败：',
                unknownModule: '未知模块',
                profileName: 'MAZKO',
                startButton: '开始',
                // 桌面图标 / 菜单项
                worksIcon: '作品集',
                worksMenuItem: '我的作品集',
                charactersIcon: '角色',
                charactersMenuItem: '角色库',
                mazkoExeIcon: 'MAZKO',
                servicesIcon: '服务',
                servicesMenuItem: '服务与报价',
                socialsIcon: '社交',
                socialsMenuItem: '社交媒体',
                datacoreIcon: '數據核心', // 新增数据核心图标文本
                datacoreMenuItem: '數據ᕼᣯ鈊 ⸸ Dᴬᵀᴬ.Cᴼᴿᴱ ☍', // 新增数据核心菜单项文本
                settingsMenuItem: '系统设置',
                shutdownMenuItem: '关机',
                shutdownMessage: '系统正在关机，再见！', // Added missing translation

                // Status bar specific
                statusBarBranding: '⧉ мax 係統 ⸸ 𝙈𝙖𝙭 𝙊𝙎 [𝙑ᵉʳ¹․⁰․⁰]',
                statusBarStatusReady: '就绪',
                statusBarStatusDragging: '正在拖动窗口...',
                statusBarStatusResizing: '正在调整窗口大小...',

                // 作品集部分
                worksTitle: '我的作品集',
                worksClickPrompt: '点击作品查看详情',
                worksDetailsSuffix: ' 作品详情',

                // 角色部分
                charactersTitle: '角色库',
                charactersDescription: '这里展示了我设计的一些角色，它们来自不同的世界和故事。',

                // 关于部分
                aboutTitle: '关于 MAZKO',
                aboutContent: `
# 关于 MAZKO

MAZKO 是一位专注于 **赛博朋克、Y2K、PSX 和故障艺术风格** 的数字艺术家。

我的创作领域涵盖：

* **三维模型与渲染**：高精度与低多边形模型，专注于复古未来主义美学。
* **概念艺术与插画**：将抽象想法转化为具象视觉，带有独特的赛博朋克氛围。
* **视觉特效与动画**：为您的项目增添动态和沉浸感。
* **用户界面设计**：秉持 Frutiger Aero、Y2K 等风格，创造直观而美观的界面。

我致力于通过艺术表达对科技、未来与怀旧的思考。

**联系我：**

欢迎通过以下方式与我联系，共同探索数字艺术的无限可能。

`,
                // 数据核心部分
                datacoreTitle: '數據ᕼᣯ鈊 ⸸ Dᴬᵀᴬ.Cᴼᴿᴱ ☍',
                datacoreDescription: '探索我的灵感图库。',
                datacoreEmpty: '这里暂时没有灵感图片。',


                // 服务部分
                services: {
                    title: '服务与报价',
                    description: '我提供以下数字艺术服务。每个服务都旨在满足您特定的创意需求。',
                    categories: [
                        {
                            id: 'character-modeling-category',
                            name: '角色建模与设计',
                            nameEn: 'Character Modeling & Design',
                            shortDescription: '创建独特且风格化的 3D/2D 角色。',
                            detailContent: `
# 角色建模与设计

我擅长从概念到最终渲染的各类角色设计，尤其是在 **PSX风格和低多边形** 领域有深入研究。

服务包括：

* **概念草图**：根据您的想法，提供多角度的角色概念图。
* **3D建模**：使用 Blender/ZBrush 等工具进行角色高低模制作。
* **纹理绘制**：结合 Substance Painter，为角色赋予复古像素或科幻质感。
* **骨骼绑定与动画（基础）**：提供基础的角色绑定和姿态设置。

**报价示例：**

* **PSX风格低多边形角色**：¥1500 - ¥5000 (根据细节复杂程度)
* **精细概念角色插画**：¥800 - ¥3000 (根据细节和背景)

**项目周期**：通常为 1-3 周。
`
                        },
                        {
                            id: 'poster-design-category',
                            name: '海报与视觉设计',
                            nameEn: 'Poster & Visual Design',
                            shortDescription: '制作具有赛博朋克和故障艺术感的宣传海报。',
                            detailContent: `
# 海报与视觉设计

我能为您创作出引人注目的 **赛博朋克、Y2K 或故障艺术风格** 的海报和各类视觉宣传品。

服务包括：

* **活动海报**：音乐节、游戏发布、艺术展览等主题海报。
* **品牌视觉**：符合您品牌调性的独特图形元素和宣传图。
* **数字插画**：用于网站、社交媒体或印刷品的定制插画。
* **动态图形（基础））**：为海报添加简单的动画效果。

**报价示例：**

* **单页概念海报**：¥1200 - ¥4000 (根据复杂度和修订次数)
* **系列视觉宣传图（3张）：**：¥3000 - ¥8000

**项目周期**：通常为 0.5-2 周。
`
                        }
                    ]
                },

                // 社交部分
                socialsTitle: '社交媒体',
                socialsDescription: '欢迎在以下平台关注我，与我互动。',
                socialsLinks: [
                    { name: '微博', url: 'https://weibo.com/yourprofile', iconAssetKey: 'icon_weibo' },
                    { name: 'Instagram', url: 'https://instagram.com/yourprofile', iconAssetKey: 'icon_instagram' },
                    { name: 'ArtStation', url: 'https://artstation.com/yourprofile', iconAssetKey: 'icon_artstation' },
                    { name: 'Behance', url: 'https://behance.net/yourprofile', iconAssetKey: 'icon_behance_square' },
                    { name: '邮箱', url: 'mailto:your.email@example.com', iconAssetKey: 'icon_envelope' }
                ],

                // 设置部分
                settings: {
                    title: '系统设置',
                    description: '调整您的系统偏好设置。',
                    options: [
                        { id: 'language-toggle', type: 'language-toggle', label: '切换语言' }, 
                        { id: 'desktop-icons-toggle', type: 'toggle', checked: true, label: '显示桌面图标' },
                        { id: 'enable-animations', type: 'toggle', checked: true, disabled: true, label: '启用系统动画 (暂不可用)' },
                        { id: 'reset-settings', type: 'button', label: '重置所有设置' }
                    ]
                },
            }, // End of zh language content
            en: { // Add English content
                systemName: 'MAX OS',
                systemVersion: 'v1.0.0',
                welcomeMessage: 'Welcome to MAZKO\'s Virtual Terminal',
                loadingMessage: 'Loading...',
                errorLoadingContent: 'Failed to load content: ',
                unknownModule: 'Unknown Module',
                profileName: 'MAZKO',
                startButton: 'Start',
                // Desktop Icons / Menu Items
                worksIcon: 'Works',
                worksMenuItem: 'My Works',
                charactersIcon: 'Characters',
                charactersMenuItem: 'Characters Library',
                mazkoExeIcon: 'MAZKO',
                servicesIcon: 'Services',
                servicesMenuItem: 'Services & Pricing',
                socialsIcon: 'Socials',
                socialsMenuItem: 'Social Media',
                datacoreIcon: 'DATA CORE',
                datacoreMenuItem: 'DATA.CORE',
                settingsMenuItem: 'System Settings',
                shutdownMenuItem: 'Shutdown',
                shutdownMessage: 'System is shutting down, Goodbye!',

                // Status bar specific
                statusBarBranding: '⧉ мax 係統 ⸸ 𝙈𝙖𝙭 𝙊𝙎 [𝙑ᵉʳ¹․⁰․⁰]', // Same branding text for English
                statusBarStatusReady: 'Ready',
                statusBarStatusDragging: 'Dragging Window...',
                statusBarStatusResizing: 'Resizing Window...',

                // Works section
                worksTitle: 'My Works',
                worksClickPrompt: 'Click on a work to view details',
                worksDetailsSuffix: ' Details',

                // Characters section
                charactersTitle: 'Characters Library',
                charactersDescription: 'Here are some characters I\'ve designed, from different worlds and stories.',

                // About section
                aboutTitle: 'About MAZKO',
                aboutContent: `
# About MAZKO

MAZKO is a digital artist focused on **Cyberpunk, Y2K, PSX, and Glitch Art styles**.

My areas of expertise include:

* **3D Models & Renders**: High-fidelity and low-poly models, with a focus on retro-futuristic aesthetics.
* **Concept Art & Illustrations**: Transforming abstract ideas into concrete visuals with a unique cyberpunk atmosphere.
* **Visual Effects & Animation**: Adding dynamic and immersive elements to your projects.
* **User Interface Design**: Adhering to styles like Frutiger Aero, Y2K, to create intuitive and aesthetically pleasing interfaces.

I am dedicated to expressing thoughts on technology, the future, and nostalgia through art.

**Contact me:**

Feel free to contact me through the following channels to explore the infinite possibilities of digital art together.

`,
                // Data Core section
                datacoreTitle: 'DATA.CORE',
                datacoreDescription: 'Explore my inspiration gallery.',
                datacoreEmpty: 'No inspiration images here yet.',

                // Services section
                services: {
                    title: 'Services & Pricing',
                    description: 'I offer the following digital art services. Each service is designed to meet your specific creative needs.',
                    categories: [
                        {
                            id: 'character-modeling-category',
                            name: 'Character Modeling & Design',
                            nameEn: 'Character Modeling & Design',
                            shortDescription: 'Create unique and stylized 3D/2D characters.',
                            detailContent: `
# Character Modeling & Design

I specialize in character design from concept to final render, with a particular focus on **PSX style and low-poly** aesthetics.

Services include:

* **Concept Sketches**: Providing multi-angle character concepts based on your ideas.
* **3D Modeling**: Creating high-poly and low-poly models using tools like Blender/ZBrush.
* **Texture Painting**: Using Substance Painter to give characters retro pixelated or sci-fi textures.
* **Rigging & Basic Animation**: Providing basic character rigging and pose setup.

**Pricing Examples:**

* **PSX Style Low-Poly Character**: ¥1500 - ¥5000 (depending on detail complexity)
* **Detailed Concept Character Illustration**: ¥800 - ¥3000 (depending on detail and background)

**Project Duration**: Typically 1-3 weeks.
`
                        },
                        {
                            id: 'poster-design-category',
                            name: 'Poster & Visual Design',
                            nameEn: 'Poster & Visual Design',
                            shortDescription: 'Create promotional posters with a cyberpunk and glitch art feel.',
                            detailContent: `
# Poster & Visual Design

I can create eye-catching posters and various visual promotional materials for you in **Cyberpunk, Y2K, or Glitch Art styles**.

Services include:

* **Event Posters**: Themed posters for music festivals, game releases, art exhibitions, etc.
* **Brand Visuals**: Unique graphic elements and promotional images that align with your brand identity.
* **Digital Illustrations**: Custom illustrations for websites, social media, or print.
* **Motion Graphics (Basic)**: Adding simple animation effects to posters.

**Pricing Examples:**

* **Single-Page Concept Poster**: ¥1200 - ¥4000 (depending on complexity and revisions)
* **Series of Visual Promotional Images (3 images)**: ¥3000 - ¥8000

**Project Duration**: Typically 0.5-2 weeks.
`
                        }
                    ]
                },

                // 社交部分
                socialsTitle: 'Social Media',
                socialsDescription: 'Feel free to follow me on the platforms below and interact.',
                socialsLinks: [
                    { name: 'Weibo', url: 'https://weibo.com/yourprofile', iconAssetKey: 'icon_weibo' },
                    { name: 'Instagram', url: 'https://instagram.com/yourprofile', iconAssetKey: 'icon_instagram' },
                    { name: 'ArtStation', url: 'https://artstation.com/yourprofile', iconAssetKey: 'icon_artstation' },
                    { name: 'Behance', url: 'https://behance.net/yourprofile', iconAssetKey: 'icon_behance_square' },
                    { name: 'Email', url: 'mailto:your.email@example.com', iconAssetKey: 'icon_envelope' }
                ],

                // 设置部分
                settings: {
                    title: 'System Settings',
                    description: 'Adjust your system preferences.',
                    options: [
                        { id: 'language-toggle', type: 'language-toggle', label: 'Toggle Language' },
                        { id: 'desktop-icons-toggle', type: 'toggle', checked: true, label: 'Show Desktop Icons' },
                        { id: 'enable-animations', type: 'toggle', checked: true, disabled: true, label: 'Enable System Animations (Unavailable)' },
                        { id: 'reset-settings', type: 'button', label: 'Reset All Settings' }
                    ]
                },
            }
        };


        let currentLanguage = 'zh'; // 将声明移到 DOMContentLoaded 外部

        document.addEventListener('DOMContentLoaded', () => {
            console.log('脚本开始解析。'); // Added for debugging
            
            // JavaScript for dynamic elements (e.g., time display)
            // 用于动态元素（例如，时间显示）的 JavaScript
            function updateTime() {
                const now = new Date();
                const hours = String(now.getHours()).padStart(2, '0');
                const minutes = String(now.getMinutes()).padStart(2, '0');
                const timeElement = document.getElementById('current-time');
                if (timeElement) {
                    timeElement.textContent = `${hours}:${minutes}`;
                } else {
                    console.warn('未找到时间元素。');
                }
            }

            // Update time every minute
            // 每分钟更新时间
            setInterval(updateTime, 60000); // 每分钟更新 HH:MM
            // Initial call to display time immediately
            // 立即调用以显示时间
            updateTime();

            // Get elements for the desktop environment
            // 获取桌面环境的元素
            const startButton = document.getElementById('start-button-taskbar');
            const startMenu = document.getElementById('start-menu');
            const startMenuHeader = document.querySelector('.start-menu-header'); // Get the header
            // 获取头部
            const mainDesktopArea = document.getElementById('main-desktop-area');
            // Removed welcome message elements as requested
            // 按要求移除欢迎消息元素
            // const welcomeMessage = document.getElementById('welcome-message');
            // let welcomeMessageText = document.getElementById('welcome-message-text'); 
            const taskbarIconsContainer = document.getElementById('taskbar-icons');
            const desktopIconsContainer = document.getElementById('desktop-icons-container');
            const desktopBackground = document.getElementById('desktop-background'); // Get desktop background element
            // 获取桌面背景元素
            let highestZIndex = 5; // To manage window stacking order
            // 用于管理窗口堆叠顺序

            // Store references to open windows to re-render them on language change
            // 存储打开的窗口的引用，以便在语言更改时重新渲染它们
            const openWindowsMap = new Map(); // Map<windowId, {section, chineseTitle, englishTitle, windowElement}>

            console.log('核心DOM元素和变量已初始化。');

            /**
             * @function updateCursors
             * @description Dynamically updates CSS custom properties for cursors based on paths defined in ASSETS.
             * @returns {void}
             */
            /**
             * @function updateCursors
             * @description 根据 ASSETS 中定义的路径动态更新光标的 CSS 自定义属性。
             * @returns {void}
             */
            function updateCursors() {
                const root = document.documentElement;
                root.style.setProperty('--cursor-default', `url('${getAssetUrl('cursor_default')}'), auto`);
                root.style.setProperty('--cursor-active', `url('${getAssetUrl('cursor_active')}'), auto`);
                root.style.setProperty('--cursor-pointer', `url('${getAssetUrl('cursor_pointer')}'), auto`);
                // 为可拖拽元素设置抓手光标
                const grabElements = document.querySelectorAll('.os-window-title-bar');
                grabElements.forEach(el => {
                    el.style.cursor = `url('${getAssetUrl('cursor_grab')}') 12 12, grab`;
                });
                console.log('自定义光标已更新。');
            }

            /**
             * @function renderDynamicAssets
             * @description Iterates through all placeholder elements with `data-asset-key` attribute and replaces them with `<img>` tags, loading the corresponding images.
             * @returns {void}
             */
            /**
             * @function renderDynamicAssets
             * @description 遍历所有带有 `data-asset-key` 属性的占位符元素，并将其替换为 `<img>` 标签，加载相应的图像。
             * @returns {void}
             */
            function renderDynamicAssets() {
                document.querySelectorAll('.icon-placeholder[data-asset-key]').forEach(placeholder => {
                    const assetKey = placeholder.dataset.assetKey;
                    const iconUrl = getAssetUrl(assetKey);
                    if (iconUrl) {
                        // If placeholder already has an image, avoid adding duplicates
                        // 如果占位符已经有图像，则避免添加重复项
                        if (placeholder.querySelector('img')) {
                            placeholder.querySelector('img').src = iconUrl;
                        } else {
                            const img = document.createElement('img');
                            img.src = iconUrl;
                            img.alt = assetKey.replace('icon_', '').replace(/_/g, ' '); // Simple alt text
                            // 简单的alt文本
                            img.classList.add('icon-image'); // Apply general icon styles defined in CSS
                            // 应用CSS中定义的通用图标样式
                            placeholder.innerHTML = ''; // Clear any existing content
                            // 清除任何现有内容
                            placeholder.appendChild(img);
                        }
                    } else {
                        console.warn(`未找到键名为 "${assetKey}" 的资产。`);
                        // If asset not found, display a default broken icon, or keep it empty
                        // 如果未找到资产，则显示默认的损坏图标，或保持为空
                        placeholder.innerHTML = '⚠️';
                    }
                });

                // Check and set desktop background image (if defined in ASSETS)
                // 检查并设置桌面背景图像（如果ASSETS中定义）
                const desktopBgImage = getAssetUrl('desktop_background_image');
                console.log('尝试设置桌面背景。路径：', desktopBgImage); // Debug: Check path
                // 调试：检查路径
                if (desktopBgImage && desktopBackground) {
                    // Set CSS variable for the image URL
                    // 设置图像URL的CSS变量
                    desktopBackground.style.setProperty('--desktop-image-url', `url('${desktopBgImage}')`);
                    
                    desktopBackground.classList.add('desktop-background-image-active');
                    console.log('桌面背景图像已应用CSS属性。类列表：', desktopBackground.classList.value);
                } else if (desktopBackground) {
                    // Ensure default background and effects are active if no image is used
                    // 如果没有使用图像，请确保默认背景和效果处于活动状态
                    desktopBackground.classList.remove('desktop-background-image-active');
                    desktopBackground.classList.add('desktop-background');
                    desktopBackground.style.removeProperty('--desktop-image-url'); // Remove the CSS variable
                    // 移除CSS变量
                    // Re-apply default background gradients if no image is set
                    // 如果没有设置图像，则重新应用默认背景渐变
                    desktopBackground.style.backgroundImage = `
                        radial-gradient(circle at 10% 90%, rgba(0,191,255,0.3) 0%, transparent 45%),
                        radial-gradient(circle at 90% 10%, rgba(0,191,255,0.3) 0%, transparent 45%),
                        radial-gradient(ellipse at center, rgba(0,122,204,0.15) 0%, transparent 55%),
                        linear-gradient(to bottom right, #3A92CE, #CCEEFF)
                    `;
                    desktopBackground.style.opacity = '0.95';
                    desktopBackground.style.filter = 'brightness(0.9) contrast(1.1)';
                    console.log('未指定桌面背景图像，回退到渐变。');
                }
            }


            /**
             * @function updateUIForLanguage
             * @description Updates all UI text based on the current language setting.
             * @returns {void}
             */
            /**
             * @function updateUIForLanguage
             * @description 根据当前语言设置更新所有UI文本。
             * @returns {void}
             */
            function updateUIForLanguage() {
                const langData = LANG_CONTENT[currentLanguage];

                // Update Start Menu header profile name
                // 更新开始菜单标题栏个人资料名称
                const profileNameElement = startMenu.querySelector('[data-lang-key="profileName"]');
                if (profileNameElement) {
                    profileNameElement.textContent = langData.profileName;
                }

                // Update Desktop Icons
                // 更新桌面图标
                document.querySelectorAll('.desktop-icon').forEach(icon => {
                    const langKey = icon.querySelector('.desktop-icon-label').dataset.langKey;
                    if (langKey && langData[langKey]) {
                        icon.querySelector('.desktop-icon-label').textContent = langData[langKey];
                    }
                    // Update data-title for window opening (using current language for display)
                    // 更新窗口打开的data-title（使用当前语言显示）
                    icon.dataset.title = icon.dataset[`title-${currentLanguage}`];
                });

                // Update Start Menu Items (links and buttons)
                // 更新开始菜单项（链接和按钮）
                document.querySelectorAll('.start-menu-item').forEach(item => {
                    const langKey = item.dataset.langKey;
                    const labelSpan = item.querySelector('.menu-item-label');
                    if (labelSpan && langData[langKey]) {
                        labelSpan.textContent = langData[langKey]; 
                    }
                });

                // Update Start Menu Footer Buttons (now icon-only)
                // 更新开始菜单底部按钮（现在只有图标）
                document.querySelectorAll('.start-menu-footer-button').forEach(button => {
                    const langKey = button.dataset.langKey;
                    if (langKey && langData[langKey]) {
                        button.title = langData[langKey];
                    }
                });
                
                // Re-open/re-render all active windows
                // 重新打开/重新渲染所有活动窗口
                reopenAllWindows();
                // Re-render all dynamic assets (icons) for current language
                // 为当前语言重新渲染所有动态资产（图标）
                renderDynamicAssets();
            }

            /**
             * @function getWindowTitles
             * @description Generates window titles in both Chinese and English based on the section and optional content.
             * @param {string} section - The section identifier (e.g., 'works', 'about', 'work-detail-123').
             * @param {Object} [currentWork=null] - The work object if the section is a work detail.
             * @param {Object} [currentCategory=null] - The service category object if the section is a service category detail.
             * @returns {{chineseTitle: string, englishTitle: string}} An object containing the Chinese and English titles.
             */
            /**
             * @function getWindowTitles
             * @description 根据部分和可选内容生成中文和英文窗口标题。
             * @param {string} section - 部分标识符（例如，'works'，'about'，'work-detail-123'）。
             * @param {Object} [currentWork=null] - 如果部分是作品详情，则为作品对象。
             * @param {Object} [currentCategory=null] - 如果部分是服务类别详情，则为服务类别对象。
             * @returns {{chineseTitle: string, englishTitle: string}} 包含中文和英文标题的对象。
             */
            function getWindowTitles(section, currentWork = null, currentCategory = null) {
                let chineseTitle = LANG_CONTENT['zh']?.unknownModule || 'Untitled Window';
                let englishTitle = LANG_CONTENT['en']?.unknownModule || 'Untitled Window';

                if (section.startsWith('work-detail-') && currentWork) {
                    chineseTitle = currentWork.title + (LANG_CONTENT['zh']?.worksDetailsSuffix || '');
                    englishTitle = currentWork.title + (LANG_CONTENT['en']?.worksDetailsSuffix || ''); 
                } else if (section.startsWith('service-category-') && currentCategory) {
                    chineseTitle = currentCategory.name;
                    englishTitle = currentCategory.nameEn || currentCategory.name; // Use nameEn if available, otherwise fallback
                } else {
                    // For main sections, use data-title-zh and data-title-en from desktop icons or menu items
                    const desktopIcon = document.querySelector(`.desktop-icon[data-section="${section}"]`);
                    
                    if (desktopIcon) {
                        chineseTitle = desktopIcon.dataset.titleZh;
                        englishTitle = desktopIcon.dataset.titleEn;
                    } else if (LANG_CONTENT['zh'][`${section}MenuItem`]) { // Check for menu item translations directly
                        chineseTitle = LANG_CONTENT['zh'][`${section}MenuItem`]; 
                        englishTitle = LANG_CONTENT['en'][`${section}MenuItem`]; 
                    } else if (section === 'about') { // For the "About MAZKO" section
                        chineseTitle = LANG_CONTENT['zh'].aboutTitle;
                        englishTitle = LANG_CONTENT['en'].aboutTitle;
                    } else if (section === 'settings') {
                        chineseTitle = LANG_CONTENT['zh'].settings.title; 
                        englishTitle = LANG_CONTENT['en'].settings.title; 
                    } else if (section === 'shutdown') {
                        chineseTitle = LANG_CONTENT['zh'].shutdownMenuItem; 
                        englishTitle = LANG_CONTENT['en'].shutdownMenuItem; 
                    } else if (section === 'data-core') { 
                        chineseTitle = LANG_CONTENT['zh'].datacoreTitle;
                        englishTitle = LANG_CONTENT['en'].datacoreTitle;
                    }
                }
                return { chineseTitle, englishTitle };
            }


            /**
             * @function reopenAllWindows
             * @description Re-opens all currently active windows to update their content based on the current language.
             * @returns {Promise<void>}
             */
            async function reopenAllWindows() {
                // Get a snapshot of currently open windows and their original positions/sizes
                const activeWindowsData = [];
                document.querySelectorAll('.os-window').forEach(win => {
                    // Only re-open if not minimized, as minimized state will be re-applied
                    if (!win.classList.contains('minimized')) {
                        activeWindowsData.push({
                            section: win.dataset.section,
                            windowId: win.dataset.windowId,
                            originalLeft: win.dataset.originalLeft,
                            originalTop: win.dataset.originalTop,
                            originalWidth: win.dataset.originalWidth,
                            originalHeight: win.dataset.originalHeight,
                            isMaximized: win.classList.contains('maximized')
                        });
                        win.remove(); // Remove old window
                    }
                });
                // Clear taskbar icons for removed windows
                taskbarIconsContainer.innerHTML = '';

                // Re-open windows one by one
                for (const winData of activeWindowsData) {
                    let contentHTML = '';
                    let isMarkdown = false;
                    let currentWork = null;
                    let currentCategory = null;
                    let currentImageGallery = null; // For data-core gallery
                    let data = null; // Declare data variable

                    try {
                        data = await fetchContent(winData.section); // Re-fetch content in new language
                    } catch (error) {
                        console.error(`${LANG_CONTENT[currentLanguage]?.errorLoadingContent} ${winData.section}:`, error);
                        contentHTML = `<p class="text-xl text-red-400">${LANG_CONTENT[currentLanguage]?.errorLoadingContent} ${error.message || LANG_CONTENT[currentLanguage]?.unknownModule}</p>`;
                        await openWindow(winData.section, 'Error', 'Error', contentHTML, winData.windowId, winData);
                        continue; // Skip to next window
                    }

                    if (winData.section.startsWith('work-detail-')) {
                        const workId = winData.windowId.replace('work-detail-', '');
                        // Fetch works data to find the specific work using the new language
                        const worksData = await fetchContent('works'); 
                        currentWork = worksData.find(w => w.id === workId);
                    } else if (winData.section.startsWith('service-category-')) {
                        const categoryId = winData.windowId.replace('service-category-', '');
                        currentCategory = LANG_CONTENT[currentLanguage]?.services?.categories.find(cat => cat.id === categoryId);
                    } else if (winData.section === 'data-core') {
                        currentImageGallery = data; // Data for the data-core gallery is directly the array of images
                    }

                    const { chineseTitle, englishTitle } = getWindowTitles(winData.section, currentWork, currentCategory);

                    // Re-generate content based on section and new language
                    switch (winData.section) {
                        case 'works':
                            contentHTML = `
                                <h2 class="text-xl font-bold mb-4">${chineseTitle}</h2>
                                <div class="works-grid">
                                    ${data?.map(work => `
                                        <div class="work-card" data-work-id="${work.id}">
                                            <img src="${getAssetUrl(work.thumbnail_key)}" alt="${work.title}">
                                            <div class="work-card-title">${work.title}</div>
                                            <div class="work-card-category">${work.category}</div>
                                        </div>
                                    `).join('')}
                                </div>
                                <p class="mt-4 opacity-70 text-center">${LANG_CONTENT[currentLanguage]?.worksClickPrompt}</p>
                            `;
                            break;
                        case 'characters':
                            contentHTML = `
                                <h2 class="text-xl font-bold mb-4">${chineseTitle}</h2>
                                <p>${LANG_CONTENT[currentLanguage]?.charactersDescription}</p>
                                <div class="grid grid-cols-2 gap-4 mt-4">
                                    ${data?.map(char => `
                                        <div class="flex flex-col items-center">
                                            <img src="${getAssetUrl(char.image_key)}" alt="${char.name}" class="rounded-lg shadow-md mb-2">
                                            <p class="font-bold">${char.name}</p>
                                            <p class="text-sm opacity-80 text-center">${char.description}</p>
                                        </div>
                                    `).join('')}
                                </div>
                            `;
                            break;
                        case 'about':
                            contentHTML = LANG_CONTENT[currentLanguage]?.aboutContent;
                            isMarkdown = true;
                            break;
                        case 'services':
                            contentHTML = marked.parse(LANG_CONTENT[currentLanguage]?.services?.description || '') + `
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mt-4">
                                    ${data?.categories.map(category => `
                                        <div class="service-category-card p-4 rounded-lg border border-primary-blue hover:bg-glass-bg cursor-pointer transition-all duration-200" data-category-id="${category.id}">
                                            <h3 class="font-bold text-lg text-light-blue">${category.name}</h3>
                                            <p class="text-sm opacity-80 mt-1">${category.shortDescription}</p>
                                        </div>
                                    `).join('')}
                                </div>
                            `;
                            break;
                        case 'socials':
                            contentHTML = marked.parse(LANG_CONTENT[currentLanguage]?.socialsDescription || '') + `
                                <div class="flex flex-wrap gap-4 mt-4">
                                    ${data?.links.map(link => `
                                        <a href="${link.url}" target="_blank" class="flex items-center space-x-2 hover:text-primary-blue transition-colors">
                                            <span class="icon-placeholder" data-asset-key="${link.iconAssetKey}"></span>
                                            <span>${link.name}</span>
                                        </a>
                                    `).join('')}
                                </div>
                            `;
                            break;
                        case 'data-core': // New case for data-core window
                            if (currentImageGallery && currentImageGallery.length > 0) {
                                contentHTML = `
                                    <h2 class="text-xl font-bold mb-4">${chineseTitle}</h2>
                                    <p>${LANG_CONTENT[currentLanguage]?.datacoreDescription}</p>
                                    <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4 mt-4">
                                        ${currentImageGallery.map(image => `
                                            <div class="flex flex-col items-center p-2 rounded-lg bg-white bg-opacity-5 hover:bg-opacity-10 transition-colors">
                                                <img src="${getAssetUrl(image.thumb_key)}" alt="${image.alt}" class="w-full h-32 object-cover rounded-md mb-2 cursor-pointer" data-full-image="${getAssetUrl(image.full_key || image.thumb_key)}">
                                                <p class="text-sm text-center opacity-90">${image.alt}</p>
                                            </div>
                                        `).join('')}
                                    </div>
                                    <div id="image-modal" class="hidden fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50 p-4">
                                        <div class="relative max-w-4xl max-h-full">
                                            <img id="modal-image" src="" alt="Full size image" class="max-w-full max-h-[80vh] object-contain rounded-lg shadow-xl">
                                            <button id="close-modal" class="absolute top-4 right-4 text-white text-3xl font-bold p-2 rounded-full bg-red-600 hover:bg-red-700 transition-colors">&times;</button>
                                        </div>
                                    </div>
                                `;
                            } else {
                                contentHTML = `
                                    <h2 class="text-xl font-bold mb-4">${chineseTitle}</h2>
                                    <p>${LANG_CONTENT[currentLanguage]?.datacoreEmpty}</p>
                                `;
                            }
                            break;
                        case 'settings': 
                            contentHTML = marked.parse(LANG_CONTENT[currentLanguage]?.settings?.description || '') + `
                                <div class="flex flex-col gap-4 mt-4">
                                    ${data?.options.map(option => {
                                        const labelText = LANG_CONTENT[currentLanguage]?.settings?.options.find(opt => opt.id === option.id)?.label || option.label; 
                                        if (option.type === 'toggle') {
                                            return `
                                                <div class="flex items-center justify-between p-3 rounded-lg bg-white bg-opacity-5 border border-white border-opacity-20">
                                                    <label for="${option.id}" class="text-lg">${labelText}</label>
                                                    <label class="toggle-switch">
                                                        <input type="checkbox" id="${option.id}" ${option.checked ? 'checked' : ''} ${option.disabled ? 'disabled' : ''}>
                                                        <span class="toggle-slider round"></span>
                                                    </label>
                                                </div>
                                            `;
                                        } else if (option.type === 'language-toggle') {
                                            return `
                                                <div class="flex items-center justify-between p-3 rounded-lg bg-white bg-opacity-5 border border-white border-opacity-20">
                                                    <span class="text-lg">${labelText}</span>
                                                    <label class="toggle-switch">
                                                        <input type="checkbox" id="${option.id}" ${currentLanguage === 'en' ? 'checked' : ''}>
                                                        <span class="toggle-slider round"></span>
                                                    </label>
                                                </div>
                                            `;
                                        } else if (option.type === 'button') {
                                            return `
                                                <button id="${option.id}" class="py-2 px-4 rounded-lg bg-primary-blue hover:bg-dark-blue transition-colors text-white font-bold ${option.disabled ? 'opacity-50 cursor-not-allowed' : ''}" ${option.disabled ? 'disabled' : ''}>
                                                    ${labelText}
                                                </button>
                                            `;
                                        }
                                        return '';
                                    }).join('')}
                                </div>
                            `;
                            break;
                        case 'service-category-character-modeling-category': 
                        case 'service-category-poster-design-category':
                            contentHTML = currentCategory ? currentCategory.detailContent : `<p class="text-xl text-red-400">${LANG_CONTENT[currentLanguage]?.unknownModule}</p>`;
                            isMarkdown = true;
                            break;
                        case 'work-detail-' + winData.windowId.replace('work-detail-', ''):
                            if (currentWork) {
                                // For re-opening, we might need to preserve the image index if possible, but default to 0
                                // for simplicity here.
                                let initialImageIndex = 0; 
                                contentHTML = `
                                    <div class="work-detail-content">
                                        <div class="gallery-main-image-container">
                                            <img src="${getAssetUrl(currentWork.images_keys[initialImageIndex])}" alt="${currentWork.title}" class="gallery-main-image">
                                            ${currentWork.images_keys.length > 1 ? `
                                                <button class="gallery-nav-button prev" data-direction="prev" title="上一张图片">
                                                    <span class="icon-placeholder" data-asset-key="icon_chevron_left"></span>
                                                </button>
                                                <button class="gallery-nav-button next" data-direction="next" title="下一张图片">
                                                    <span class="icon-placeholder" data-asset-key="icon_chevron_right"></span>
                                                </button>
                                            ` : ''}
                                        </div>
                                        <div class="gallery-thumbnails">
                                            ${currentWork.images_keys.map((imgKey, index) => `
                                                <img src="${getAssetUrl(imgKey)}" alt="${currentWork.title} 缩略图" class="gallery-thumbnail ${index === initialImageIndex ? 'active' : ''}" data-index="${index}">
                                            `).join('')}
                                        </div>
                                        <h3>${currentWork.title}</h3>
                                        <p class="text-sm opacity-90 mb-2">${currentWork.category}</p>
                                        <p>${currentWork.description}</p>
                                        <div class="flex flex-wrap gap-2 mt-4">
                                            ${currentWork.tags.map(tag => `<span class="category-tag">${tag}</span>`).join('')}
                                        </div>
                                    </div>
                                `;
                            } else {
                                contentHTML = `<p class="text-xl text-red-400">${LANG_CONTENT[currentLanguage]?.unknownModule}</p>`;
                            }
                            break;
                        default:
                            contentHTML = `<p class="text-xl text-red-400">${LANG_CONTENT[currentLanguage]?.unknownModule || 'Unknown Module'}</p>`;
                    }

                    // Re-open the window with its original properties
                    const newWindowElement = await openWindow(winData.section, chineseTitle, englishTitle, contentHTML, winData.windowId, {
                        left: winData.originalLeft,
                        top: winData.originalTop,
                        width: winData.originalWidth,
                        height: winData.originalHeight
                    }, isMarkdown);

                    if (winData.isMaximized) {
                        newWindowElement.classList.add('maximized');
                        newWindowElement.style.borderRadius = '0';
                        newWindowElement.style.boxShadow = 'none';
                    }
                     // If it was minimized, re-apply minimized class
                    if (winData.isMinimized) { // Assuming you add a property 'isMinimized' to winData when minimizing
                        newWindowElement.classList.add('minimized');
                    }
                }
            }


            // --- 桌面图标定位逻辑 ---
            /**
             * @function positionDesktopIcons
             * @description 在主桌面区域内以网格布局定位桌面图标。
             * @returns {void}
             */
            function positionDesktopIcons() {
                const iconWidth = 100; // Defined in CSS .desktop-icon width
                const iconHeight = 100; // Approximate height including label and padding
                const paddingX = 20; // Horizontal padding from desktop edge
                const paddingY = 20; // Vertical padding from desktop edge
                const gapX = 20; // Gap between icons horizontally
                const gapY = 20; // Gap between icons vertically

                const icons = Array.from(desktopIconsContainer.children);
                let currentX = paddingX;
                let currentY = paddingY;
                let column = 0;

                icons.forEach((icon, index) => {
                    // Check if icon fits in current column, otherwise move to next column
                    if (currentY + iconHeight > mainDesktopArea.clientHeight - (paddingY + 10)) { // Add small buffer for taskbar
                        column++;
                        currentX = paddingX + (column * (iconWidth + gapX));
                        currentY = paddingY;
                    }

                    icon.style.left = `${currentX}px`;
                    icon.style.top = `${currentY}px`;
                    currentY += (iconHeight + gapY);
                });
            }

            // Call positioning function initially and on window resize
            positionDesktopIcons();
            window.addEventListener('resize', positionDesktopIcons);


            // --- Mock Data Fetching (Simulating Headless CMS API Calls) ---
            // In a real application, these would be actual fetch() calls to your CMS API endpoints.

            /**
             * @function fetchContent
             * @description Simulates fetching content for a given section. In a real app, this would be an API call.
             * @param {string} section - The section identifier (e.g., 'works', 'about').
             * @returns {Promise<Object|null>} A promise that resolves with the content data or null if not found.
             */
            async function fetchContent(section) {
                console.log(`正在获取 ${currentLanguage} 语言的 ${section} 内容...`);
                // Simulate network delay
                await new Promise(resolve => setTimeout(resolve, 300)); 

                const langData = LANG_CONTENT[currentLanguage];
                let data = null;

                switch (section) {
                    case 'works':
                        data = [
                            {
                                id: 'work-001',
                                title: '地下俱乐部场景',
                                category: '场景设计 / PSX风格',
                                thumbnail_key: 'work_001_thumbnail', 
                                images_keys: [
                                    'work_001_full_1', 
                                    'work_001_full_2', 
                                    'work_001_full_3'  
                                ],
                                description: '一个充满霓虹灯和低多边形元素的地下俱乐部场景，融合了Y2K和故障美学。',
                                tags: ['场景', 'PSX', 'Y2K', 'Blender']
                            },
                            {
                                id: 'work-002',
                                title: '赛博朋克角色 - KAI',
                                category: '角色设计 / Lowpoly',
                                thumbnail_key: 'work_002_thumbnail', 
                                images_keys: [
                                    'work_002_full_1', 
                                    'work_002_full_2', 
                                    'work_002_full_3'  
                                ],
                                description: '一个具有复古科幻感的赛博朋克角色，采用低多边形建模和像素质感纹理。',
                                tags: ['角色', 'Lowpoly', '赛博朋K', 'Substance Painter']
                            }
                        ];
                        // Apply English translations if currentLanguage is 'en'
                        if (currentLanguage === 'en') {
                            data = data.map(work => ({
                                ...work,
                                title: LANG_CONTENT.en.worksTitle, // You might want more specific English titles here
                                category: work.category, // Assuming category doesn't change
                                description: LANG_CONTENT.en.worksClickPrompt // You might want more specific English descriptions here
                            }));
                        }
                        break;
                    case 'characters':
                        data = [
                            {
                                id: 'char-001',
                                name: '星际漫游者',
                                description: '一个孤独的星际旅行者，探索宇宙深处的奥秘。PSX风格，低多边形设计。',
                                image_key: 'char_001_image' 
                            },
                            {
                                id: 'char-002',
                                name: '都市忍者',
                                description: '穿梭于霓虹都市阴影中的神秘忍者。',
                                image_key: 'char_002_image' 
                            }
                        ];
                        // Apply English translations if currentLanguage is 'en'
                        if (currentLanguage === 'en') {
                            data = data.map(char => ({
                                ...char,
                                name: char.name, // Assuming names are unique and don't need translation for simplicity
                                description: LANG_CONTENT.en.charactersDescription // You might want more specific English descriptions here
                            }));
                        }
                        break;
                    case 'about':
                        data = {
                            title: langData.aboutTitle,
                            content: langData.aboutContent
                        };
                        break;
                    case 'services':
                        data = {
                            title: langData.services.title,
                            description: langData.services.description,
                            categories: langData.services.categories
                        };
                        break;
                    case 'socials':
                        data = {
                            title: langData.socialsTitle,
                            description: langData.socialsDescription,
                            links: langData.socialsLinks
                        };
                        break;
                    case 'data-core': // Fetch content for the new Data Core app
                        data = [
                            { thumb_key: 'inspiration_1_thumb', full_key: 'inspiration_1_full', alt: '赛博朋克城市景观' },
                            { thumb_key: 'inspiration_2_thumb', full_key: 'inspiration_2_full', alt: '故障艺术肖像' },
                            { thumb_key: 'inspiration_3_thumb', full_key: 'inspiration_3_full', alt: 'Y2K美学设计' },
                            { thumb_key: 'inspiration_4_thumb', full_key: 'inspiration_4_full', alt: 'PSX风格场景' },
                            { thumb_key: 'inspiration_5_thumb', full_key: 'inspiration_5_full', alt: '霓虹灯管艺术' },
                            { thumb_key: 'inspiration_6_thumb', full_key: 'inspiration_6_full', alt: '科技感UI界面' },
                            { thumb_key: 'inspiration_7_thumb', full_key: 'inspiration_7_full', alt: '复古未来主义' },
                            { thumb_key: 'inspiration_8_thumb', full_key: 'inspiration_8_full', alt: '数字故障纹理' }
                        ];
                        // Apply English translations for alt text if currentLanguage is 'en'
                        if (currentLanguage === 'en') {
                            data = data.map(img => ({
                                ...img,
                                alt: img.alt // Placeholder: you might want specific English alt texts here
                            }));
                        }
                        break;
                    case 'settings': 
                        data = langData.settings;
                        break;
                    case 'shutdown':
                        data = null; // No specific data needed for shutdown
                        break;
                    default:
                        data = null;
                }
                console.log(`已获取 ${section} 的内容:`, data);
                return data;
            }

            /**
             * @function setActiveTaskbarIcon
             * @description Sets the active state for a taskbar icon.
             * @param {string} windowId - The ID of the window whose taskbar icon should be set active.
             * @returns {void}
             */
            function setActiveTaskbarIcon(windowId) {
                document.querySelectorAll('.taskbar-minimized-icon').forEach(icon => {
                    if (icon.dataset.windowId === windowId) {
                        icon.classList.add('active');
                    } else {
                        icon.classList.remove('active');
                    }
                });
            }

            /**
             * @function bringToFront
             * @description Brings a specified window element to the front of the stacking order.
             * @param {HTMLElement} windowElement - The window HTML element to bring to front.
             * @returns {void}
             */
            function bringToFront(windowElement) {
                highestZIndex++;
                windowElement.style.zIndex = highestZIndex;
                console.log(`窗口 "${windowElement.dataset.windowId}" 已置于最前。新z-index: ${highestZIndex}`);
                setActiveTaskbarIcon(windowElement.dataset.windowId); // Set its taskbar icon as active
                // Also set window title bar to active style
                document.querySelectorAll('.os-window-title-bar').forEach(bar => bar.classList.add('inactive'));
                const titleBar = windowElement.querySelector('.os-window-title-bar');
                if (titleBar) {
                    titleBar.classList.remove('inactive');
                }
                // Update status bar text to "Ready" when brought to front
                const statusBarTextElement = windowElement.querySelector('.os-window-status-bar .status-text');
                if (statusBarTextElement) {
                    statusBarTextElement.textContent = LANG_CONTENT[currentLanguage].statusBarStatusReady;
                }
            }
            /**
             * @function openWindow
             * @description Creates and opens a new window or brings an existing one to the front.
             * @param {string} section - The section identifier this window belongs to.
             * @param {string} chineseTitle - The Chinese title for the window.
             * @param {string} englishTitle - The English title for the window.
             * @param {string} contentHTML - The HTML content to display inside the window.
             * @param {string} [windowId=section] - A unique ID for this specific window instance.
             * @param {Object} [initialProps={}] - Initial position and size properties (left, top, width, height).
             * @param {boolean} [isMarkdown=false] - Whether the contentHTML should be parsed as Markdown.
             * @returns {Promise<HTMLElement>} A promise that resolves with the created or existing window element.
             */
            async function openWindow(section, chineseTitle, englishTitle, contentHTML, windowId = section, initialProps = {}, isMarkdown = false) {
                console.log(`尝试打开窗口：${chineseTitle} [${englishTitle}] (部分：${section}，ID：${windowId}，Markdown：${isMarkdown}`);

                // Check if a window for this section already exists
                let existingWindow = document.querySelector(`.os-window[data-window-id="${windowId}"]`);
                if (existingWindow) {
                    bringToFront(existingWindow);
                    // If it exists and is minimized, restore it
                    if (existingWindow.classList.contains('minimized')) {
                        restoreWindow(existingWindow);
                    }
                    return existingWindow; // Return existing window
                }

                const windowElement = document.createElement('div');
                windowElement.classList.add('os-window');
                windowElement.dataset.section = section; // Store section for identification
                windowElement.dataset.windowId = windowId; // Unique ID for this specific window instance
                
                // Store initial position and size for restore functionality
                const desktopWidth = mainDesktopArea.offsetWidth;
                const desktopHeight = mainDesktopArea.offsetHeight;

                let defaultWidth, defaultHeight, offsetX, offsetY;

                if (window.innerWidth <= 768) { // Mobile-specific sizing
                    defaultWidth = window.innerWidth * 0.95;
                    defaultHeight = window.innerHeight * 0.8;
                    offsetX = (window.innerWidth - defaultWidth) / 2;
                    offsetY = (window.innerHeight - defaultHeight) / 2 - (parseFloat(getComputedStyle(document.documentElement).getPropertyValue('--taskbar-height')) || 48) / 2;
                } else { // Desktop sizing
                    defaultWidth = Math.min(desktopWidth * 0.7, 800); // Max 800px or 70%
                    defaultHeight = Math.min(desktopHeight * 0.7, 600); // Max 600px or 70%
                    // Position new windows slightly offset from each other
                    const openWindows = document.querySelectorAll('.os-window:not(.minimized)');
                    offsetX = 50 * (openWindows.length % 5); // Max 5 offsets before repeating
                    offsetY = 50 * (openWindows.length % 5);
                    offsetX += (desktopWidth / 2 - defaultWidth / 2);
                    offsetY += (desktopHeight / 2 - defaultHeight / 2);
                }


                windowElement.style.width = initialProps.width || `${defaultWidth}px`;
                windowElement.style.height = initialProps.height || `${defaultHeight}px`;
                windowElement.style.left = initialProps.left || `${offsetX}px`;
                windowElement.style.top = initialProps.top || `${offsetY}px`;

                // Ensure window is within bounds after offset
                if (parseFloat(windowElement.style.left) + parseFloat(windowElement.style.width) > desktopWidth) {
                    windowElement.style.left = `${desktopWidth - parseFloat(windowElement.style.width) - 20}px`;
                }
                if (parseFloat(windowElement.style.top) + parseFloat(windowElement.style.height) > desktopHeight) {
                    windowElement.style.top = `${desktopHeight - parseFloat(windowElement.style.height) - 20}px`;
                }

                // Store current position and size for restoration
                windowElement.dataset.originalLeft = windowElement.style.left;
                windowElement.dataset.originalTop = windowElement.style.top;
                windowElement.dataset.originalWidth = windowElement.style.width;
                windowElement.dataset.originalHeight = windowElement.style.height;


                bringToFront(windowElement); // Bring new window to front
                console.log(`新窗口 "${windowId}" 创建于 left: ${windowElement.style.left}, top: ${windowElement.style.top}`);

                // Parse Markdown if required
                const finalContent = isMarkdown ? marked.parse(contentHTML) : contentHTML;
                const contentClass = isMarkdown ? 'markdown-content' : '';

                // Construct the full title bar text
                const fullTitle = `${chineseTitle} [${englishTitle}]`;
                windowElement.dataset.windowTitle = fullTitle; // Store the full title in dataset

                // Construct window HTML dynamically, using data-asset-key for icons
                windowElement.innerHTML = `
                    <div class="os-window-title-bar">
                        <div class="os-window-title-content">
                            <span class="icon-placeholder" data-asset-key="icon_mazko_logo"></span>
                            <span class="os-window-title">${fullTitle}</span>
                        </div>
                        <div class="os-window-controls">
                            <div class="control-button minimize" title="最小化">
                                <span class="icon-placeholder" data-asset-key="icon_minus"></span>
                            </div>
                            <div class="control-button maximize" title="最大化">
                                <span class="icon-placeholder" data-asset-key="icon_square"></span>
                            </div>
                            <div class="control-button close" title="关闭">
                                <span class="icon-placeholder" data-asset-key="icon_times"></span>
                            </div>
                        </div>
                    </div>
                    <div class="os-window-content ${contentClass}">
                        ${finalContent}
                    </div>
                    <div class="os-window-status-bar">
                        <span class="status-text">${LANG_CONTENT[currentLanguage].statusBarStatusReady}</span>
                        <span class="system-branding-text">${LANG_CONTENT[currentLanguage].statusBarBranding}</span>
                    </div>
                `;

                mainDesktopArea.appendChild(windowElement); // Append to main desktop area
                console.log(`窗口 "${windowId}" 已附加到主桌面区域。`);
                renderDynamicAssets(); // Render icons for the newly created window

                // Add to map for language switching
                openWindowsMap.set(windowId, {
                    section: section,
                    chineseTitle: chineseTitle, // Store both for re-rendering
                    englishTitle: englishTitle,
                    windowElement: windowElement
                });

                // Immediately create and add taskbar icon for the new window
                createTaskbarIcon(windowElement, chineseTitle, windowId);


                // Make window draggable
                const titleBar = windowElement.querySelector('.os-window-title-bar');
                const statusBarTextElement = windowElement.querySelector('.os-window-status-bar .status-text'); // Get status text element
                let isDraggingWindow = false; // Renamed to avoid conflict with desktop icon dragging
                let offsetXWindow, offsetYWindow;

                if (titleBar) { // Ensure titleBar exists
                    titleBar.addEventListener('mousedown', (e) => {
                        isDraggingWindow = true;
                        offsetXWindow = e.clientX - windowElement.getBoundingClientRect().left;
                        offsetYWindow = e.clientY - windowElement.getBoundingClientRect().top;
                        titleBar.style.cursor = 'grabbing'; // Changed to grab cursor
                        bringToFront(windowElement); // Bring to front when dragging starts
                        if (statusBarTextElement) { // Update status text
                            statusBarTextElement.textContent = LANG_CONTENT[currentLanguage].statusBarStatusDragging;
                        }
                        console.log(`开始拖动窗口 "${windowId}"。`);
                    });
                } else {
                    console.error(`未找到窗口 "${windowId}" 的标题栏。拖动已禁用。`);
                }

                document.addEventListener('mousemove', (e) => {
                    if (!isDraggingWindow) return;
                    let newX = e.clientX - offsetXWindow;
                    let newY = e.clientY - offsetYWindow;

                    // Boundary checks for dragging within mainDesktopArea
                    const parentRect = mainDesktopArea.getBoundingClientRect();
                    const windowRect = windowElement.getBoundingClientRect();

                    // Calculate bounds relative to the desktop area's top-left corner
                    const minX = 0;
                    const minY = 0;
                    const maxX = parentRect.width - windowRect.width;
                    const maxY = parentRect.height - windowRect.height;

                    newX = Math.max(minX, Math.min(newX, maxX));
                    newY = Math.max(minY, Math.min(newY, maxY));

                    windowElement.style.left = `${newX}px`;
                    windowElement.style.top = `${newY}px`;
                });

                document.addEventListener('mouseup', () => {
                    if (isDraggingWindow) {
                        isDraggingWindow = false;
                        if (titleBar) titleBar.style.cursor = 'grab'; // Changed to grab cursor
                        if (statusBarTextElement) { // Reset status text
                            statusBarTextElement.textContent = LANG_CONTENT[currentLanguage].statusBarStatusReady;
                        }
                        console.log(`停止拖动窗口 "${windowId}"。`);
                    }
                });

                // Handle window control buttons
                const closeButton = windowElement.querySelector('.control-button.close');
                const minimizeButton = windowElement.querySelector('.control-button.minimize');
                const maximizeButton = windowElement.querySelector('.control-button.maximize');

                if (closeButton) {
                    closeButton.addEventListener('click', () => {
                        windowElement.remove();
                        openWindowsMap.delete(windowId); // Remove from map
                        // Remove taskbar icon if it exists
                        const taskbarIcon = document.querySelector(`.taskbar-minimized-icon[data-window-id="${windowId}"]`);
                        if (taskbarIcon) {
                            taskbarIcon.remove();
                        }
                        console.log(`窗口 "${windowId}" 已关闭。`);
                    });
                } else {
                    console.error(`未找到窗口 "${windowId}" 的关闭按钮。`);
                }

                if (minimizeButton) {
                    minimizeButton.addEventListener('click', () => {
                        minimizeWindow(windowElement, chineseTitle, windowId);
                    });
                }
                if (maximizeButton) {
                    maximizeButton.addEventListener('click', () => {
                        toggleMaximizeWindow(windowElement);
                    });
                }

                // Bring to front on click anywhere on the window
                windowElement.addEventListener('mousedown', () => {
                    bringToFront(windowElement);
                });

                // Event listeners for image modal in Data Core app
                if (section === 'data-core') {
                    const imageModal = windowElement.querySelector('#image-modal');
                    const modalImage = windowElement.querySelector('#modal-image');
                    const closeModalButton = windowElement.querySelector('#close-modal');

                    windowElement.querySelectorAll('.os-window-content img[data-full-image]').forEach(img => {
                        img.addEventListener('click', (e) => {
                            modalImage.src = e.target.dataset.fullImage;
                            imageModal.classList.remove('hidden');
                        });
                    });

                    if (closeModalButton) {
                        closeModalButton.addEventListener('click', () => {
                            imageModal.classList.add('hidden');
                            modalImage.src = ''; // Clear image to save memory
                        });
                    }

                    // Close modal when clicking outside the image
                    if (imageModal) {
                        imageModal.addEventListener('click', (e) => {
                            if (e.target === imageModal) {
                                imageModal.classList.add('hidden');
                                modalImage.src = '';
                            }
                        });
                    }
                }

                return windowElement; // Return the newly created window element
            }

            /**
             * @function createTaskbarIcon
             * @description Creates and appends a taskbar icon for a given window.
             * @param {HTMLElement} windowElement - The window HTML element for which to create an icon.
             * @param {string} title - The title of the window (used for display in taskbar).
             * @param {string} windowId - The unique ID of the window.
             * @returns {void}
             */
            function createTaskbarIcon(windowElement, title, windowId) {
                console.log('createTaskbarIcon received title:', title, 'type:', typeof title, 'windowId:', windowId); // Debug log
                let taskbarIcon = document.querySelector(`.taskbar-minimized-icon[data-window-id="${windowId}"]`);
                if (!taskbarIcon) {
                    taskbarIcon = document.createElement('div');
                    taskbarIcon.classList.add('taskbar-minimized-icon');
                    taskbarIcon.dataset.windowId = windowId;

                    let displayTitle = String(title || 'Untitled Window'); // Start with the provided title, ensure it's a string and has a fallback

                    const langData = LANG_CONTENT[currentLanguage];
                    const section = windowElement.dataset.section;

                    if (langData && section) { // Ensure both langData and section are defined
                        if (langData[`${section}MenuItem`]) {
                            displayTitle = langData[`${section}MenuItem`]; // Use the simplified menu item label
                        } else if (section === 'about' && langData.mazkoExeIcon) {
                            displayTitle = langData.mazkoExeIcon;
                        } else if (section.startsWith('service-category-')) {
                            const categoryId = section.replace('service-category-', '');
                            const category = langData.services?.categories?.find(cat => cat.id === categoryId); // Use optional chaining
                            if (category?.name) {
                                displayTitle = category.name;
                            }
                        } else if (section.startsWith('work-detail-')) {
                            // For work-detail windows, the 'title' parameter already contains the full title
                            // which is usually in the format "Work Title [English Title]" or similar.
                            // We need to trim the "[English Title]" part if present.
                            const regex = /^(.*?)\s*\[.*?\]$/;
                            const match = String(title).match(regex);
                            if (match && match[1]) {
                                displayTitle = match[1].trim();
                            } else {
                                displayTitle = String(title).trim();
                            }
                        } else if (section === 'data-core') { // New logic for data-core
                            displayTitle = langData.datacoreIcon; // Use the short icon name
                        }
                    }
                    // Final fallback to ensure displayTitle is always a non-empty string and trimmed
                    displayTitle = displayTitle.trim() || 'Untitled';

                    taskbarIcon.innerHTML = `<span class="icon-placeholder" data-asset-key="icon_window_restore"></span> <span>${displayTitle}</span>`;
                    taskbarIconsContainer.appendChild(taskbarIcon);
                    renderDynamicAssets(); // Render icons for the newly created taskbar icon

                    taskbarIcon.addEventListener('click', () => {
                        restoreWindow(windowElement);
                    });
                }
                setActiveTaskbarIcon(windowId); // Set its taskbar icon as active
            }

            /**
             * @function minimizeWindow
             * @description Minimizes a given window.
             * @param {HTMLElement} windowElement - The window HTML element to minimize.
             * @param {string} title - The title of the window.
             * @param {string} windowId - The ID of the window.
             * @returns {void}
             */
            function minimizeWindow(windowElement, title, windowId) {
                windowElement.classList.add('minimized');
                console.log(`窗口 "${windowId}" 已最小化。`);
                // Ensure taskbar icon is active even when minimized
                setActiveTaskbarIcon(windowId); 
            }

            /**
             * @function restoreWindow
             * @description Restores a minimized or maximized window to its original size and position.
             * @param {HTMLElement} windowElement - The window HTML element to restore.
             * @returns {void}
             */
            function restoreWindow(windowElement) {
                windowElement.classList.remove('minimized');
                windowElement.classList.remove('maximized'); // Ensure it's not maximized either
                windowElement.style.width = windowElement.dataset.originalWidth;
                windowElement.style.height = windowElement.dataset.originalHeight;
                windowElement.style.left = windowElement.dataset.originalLeft;
                windowElement.style.top = windowElement.dataset.originalTop;
                windowElement.style.borderRadius = '12px'; // Restore border-radius for Aero
                /* Adjusted shadow for restored window to match unified border */
                // Corrected: Use camelCase for CSS property `boxShadow`
                windowElement.style.boxShadow = 'var(--glass-glow), var(--glass-inset-shadow)'; 
                bringToFront(windowElement);
                console.log(`窗口 "${windowElement.dataset.windowId}" 已恢复。`);
                setActiveTaskbarIcon(windowElement.dataset.windowId); // Set its taskbar icon as active
            }

            /**
             * @function toggleMaximizeWindow
             * @description Toggles the maximized state of a window.
             * @param {HTMLElement} windowElement - The window HTML element to toggle.
             * @returns {void}
             */
            function toggleMaximizeWindow(windowElement) {
                if (windowElement.classList.contains('maximized')) {
                    // Restore
                    windowElement.classList.remove('maximized');
                    windowElement.style.width = windowElement.dataset.originalWidth;
                    windowElement.style.height = windowElement.dataset.originalHeight;
                    windowElement.style.left = windowElement.dataset.originalLeft;
                    windowElement.style.top = windowElement.dataset.originalTop;
                    windowElement.style.borderRadius = '12px'; // Restore border-radius for Aero
                    /* Adjusted shadow for restored window to match unified border */
                    // Corrected: Use camelCase for CSS property `boxShadow`
                    windowElement.style.boxShadow = 'var(--glass-glow), var(--glass-inset-shadow)'; 
                    console.log(`窗口 "${windowElement.dataset.windowId}" 已从最大化恢复。`);
                } else {
                    // Maximize
                    // Save current position and size before maximizing (if not already saved)
                    if (!windowElement.dataset.originalLeft) {
                        windowElement.dataset.originalLeft = windowElement.style.left;
                        windowElement.dataset.originalTop = windowElement.style.top;
                        windowElement.dataset.originalWidth = windowElement.style.width;
                        windowElement.dataset.originalHeight = windowElement.style.height;
                    }
                    windowElement.classList.add('maximized');
                    // CSS handles the full-screen positioning via the .maximized class
                    console.log(`窗口 "${windowElement.dataset.windowId}" 已最大化。`);
                }
                bringToFront(windowElement); // Bring to front after state change
                setActiveTaskbarIcon(windowElement.dataset.windowId); // Set its taskbar icon as active
            }

            /**
             * @function openWorkDetail
             * @description Opens a detailed work view window with a gallery.
             * @param {Object} work - The work object containing details like title, images, description, etc.
             * @returns {void}
             */
            function openWorkDetail(work) {
                // Initialize current image index for this work
                let currentImageIndex = 0;

                const { chineseTitle, englishTitle } = getWindowTitles('work-detail-' + work.id, work);

                const detailContent = `
                    <div class="work-detail-content">
                        <div class="gallery-main-image-container">
                            <img src="${getAssetUrl(work.images_keys[currentImageIndex])}" alt="${work.title}" class="gallery-main-image">
                            ${work.images_keys.length > 1 ? `
                                <button class="gallery-nav-button prev" title="上一张图片">
                                    <span class="icon-placeholder" data-asset-key="icon_chevron_left"></span>
                                </button>
                                <button class="gallery-nav-button next" title="下一张图片">
                                    <span class="icon-placeholder" data-asset-key="icon_chevron_right"></span>
                                </button>
                            ` : ''}
                        </div>
                        <div class="gallery-thumbnails">
                            ${work.images_keys.map((imageKey, index) => `
                                <img src="${getAssetUrl(imageKey)}" alt="${work.title} 缩略图" class="gallery-thumbnail ${index === currentImageIndex ? 'active' : ''}" data-index="${index}">
                            `).join('')}
                        </div>
                        <h3>${work.title}</h3>
                        <p>${work.description}</p>
                        <div class="flex flex-wrap gap-2">
                            ${work.tags.map(tag => `<span class="category-tag">${tag}</span>`).join('')}
                        </div>
                    </div>
                `;
                
                // Open the window and then attach gallery event listeners
                openWindow('work-detail-' + work.id, chineseTitle, englishTitle, detailContent, 'work-detail-' + work.id)
                    .then(detailWindowElement => {
                        // Ensure window elements are present before attaching listeners
                        if (detailWindowElement) {
                            const mainImage = detailWindowElement.querySelector('.gallery-main-image');
                            const prevButton = detailWindowElement.querySelector('.gallery-nav-button.prev');
                            const nextButton = detailWindowElement.querySelector('.gallery-nav-button.next');
                            const thumbnailsContainer = detailWindowElement.querySelector('.gallery-thumbnails');
                            const thumbnails = detailWindowElement.querySelectorAll('.gallery-thumbnail');

                            /**
                             * @function updateGallery
                             * @description Updates the main image and active thumbnail based on the current image index.
                             * @returns {void}
                             */
                            const updateGallery = () => {
                                if (mainImage) {
                                    mainImage.src = getAssetUrl(work.images_keys[currentImageIndex]);
                                    mainImage.alt = `${work.title} - 图片 ${currentImageIndex + 1}`;
                                }
                                thumbnails.forEach((thumb, index) => {
                                    if (index === currentImageIndex) {
                                        thumb.classList.add('active');
                                    } else {
                                        thumb.classList.remove('active');
                                    }
                                });
                            };

                            if (prevButton) {
                                prevButton.addEventListener('click', () => {
                                    currentImageIndex = (currentImageIndex - 1 + work.images_keys.length) % work.images_keys.length;
                                    updateGallery();
                                });
                            }

                            if (nextButton) {
                                nextButton.addEventListener('click', () => {
                                    currentImageIndex = (currentImageIndex + 1) % work.images_keys.length;
                                    updateGallery();
                                });
                            }

                            if (thumbnailsContainer) {
                                thumbnailsContainer.addEventListener('click', (e) => {
                                    const clickedThumbnail = e.target.closest('.gallery-thumbnail');
                                    if (clickedThumbnail) {
                                        const newIndex = parseInt(clickedThumbnail.dataset.index, 10);
                                        if (!isNaN(newIndex) && newIndex !== currentImageIndex) {
                                            currentImageIndex = newIndex;
                                            updateGallery();
                                        }
                                    }
                                });
                            }
                            updateGallery(); // Initial display of the gallery
                        }
                    });
            }

            function openServiceCategoryDetail(category) {
                const { chineseTitle, englishTitle } = getWindowTitles('service-category-' + category.id, null, category);

                const detailContent = marked.parse(category.detailContent || '');

                openWindow('service-category-' + category.id, chineseTitle, englishTitle, detailContent, 'service-category-' + category.id, {}, true);
            }


            // Toggle Start Menu visibility
            if (startButton && startMenu) { // Ensure elements exist before adding listeners
                console.log('找到“开始”按钮和“开始菜单”元素。正在附加事件监听器。');
                startButton.addEventListener('click', (event) => {
                    event.stopPropagation(); // Prevent click from propagating to document
                    console.log('“开始”按钮被点击了！'); // Debug: Confirm button click
                    startMenu.classList.toggle('hidden');
                    // No need to explicitly add/remove 'visible' class as 'hidden' toggles opacity/visibility
                    console.log(`开始菜单可见性已切换。当前类：${startMenu.classList}`);
                });

                // Hide Start Menu when clicking outside of it
                document.addEventListener('click', (event) => {
                    if (!startMenu.contains(event.target) && !startButton.contains(event.target)) {
                        if (startMenu.classList.contains('visible')) { // Check for 'visible' class
                            startMenu.classList.add('hidden');
                            console.log('点击菜单外部，开始菜单已隐藏。');
                        }
                    }
                });
            } else {
                console.error('错误：在DOM中未找到“开始”按钮或“开始菜单”元素。请检查ID和HTML结构。');
            }

            // Handle Start Menu item clicks (for links)
            document.querySelectorAll('.start-menu-item, .start-menu-footer-button').forEach(item => {
                item.addEventListener('click', async (event) => { // Made async to await fetchContent
                    event.preventDefault(); // Prevent default link behavior

                    const section = item.dataset.section;
                    const { chineseTitle, englishTitle } = getWindowTitles(section);
                    
                    startMenu.classList.add('hidden'); // Hide menu after clicking an item
                    console.log(`开始菜单项“${section}”被点击。菜单已隐藏。`);

                    let content = '';
                    let data = null;
                    let isMarkdown = false;

                    // Show loading spinner while fetching data
                    content = `
                        <div class="flex flex-col items-center justify-center h-full">
                            <div class="loading-spinner"></div>
                            <p class="mt-4 text-lg">${LANG_CONTENT[currentLanguage]?.loadingMessage}</p>
                        </div>
                    `;
                    // Pass windowId to openWindow for correct targeting
                    const openedWindow = await openWindow(section, chineseTitle, englishTitle, content, section); 

                    try {
                        data = await fetchContent(section); // Fetch data
                    } catch (error) {
                        console.error(`${LANG_CONTENT[currentLanguage]?.errorLoadingContent} ${section}:`, error);
                        content = `<p class="text-xl text-red-400">${LANG_CONTENT[currentLanguage]?.errorLoadingContent} ${error.message || LANG_CONTENT[currentLanguage]?.unknownModule}</p>`;
                        // Update existing window with error message
                        if (openedWindow) {
                            openedWindow.querySelector('.os-window-content').innerHTML = content;
                            renderDynamicAssets(); // Re-render icons after content update
                        }
                        return;
                    }

                    // Re-render content based on fetched data
                    switch (section) {
                        case 'works':
                            content = `
                                <h2 class="text-xl font-bold mb-4">${LANG_CONTENT[currentLanguage]?.worksTitle}</h2>
                                <div class="works-grid">
                                    ${data?.map(work => `
                                        <div class="work-card" data-work-id="${work.id}">
                                            <img src="${getAssetUrl(work.thumbnail_key)}" alt="${work.title}">
                                            <div class="work-card-title">${work.title}</div>
                                            <div class="work-card-category">${work.category}</div>
                                        </div>
                                    `).join('')}
                                </div>
                                <p class="mt-4 opacity-70 text-center">${LANG_CONTENT[currentLanguage]?.worksClickPrompt}</p>
                            `;
                            // Update content of existing window
                            if (openedWindow) {
                                openedWindow.querySelector('.os-window-content').innerHTML = content;
                                // Attach event listeners to newly created work cards
                                setTimeout(() => { // Use setTimeout to ensure elements are rendered
                                    openedWindow.querySelectorAll('.work-card').forEach(card => {
                                        card.addEventListener('click', () => {
                                            const workId = card.dataset.workId;
                                            const selectedWork = data?.find(w => w.id === workId); // Use fetched data
                                            if (selectedWork) {
                                                console.log(`作品卡片“${workId}”被点击。正在打开详细信息窗口。`);
                                                openWorkDetail(selectedWork);
                                            } else {
                                                console.warn(`未找到ID为“${workId}”的作品。`);
                                            }
                                        });
                                    });
                                }, 100); // Small delay
                                renderDynamicAssets(); // Re-render icons after content update
                            }
                            break;
                        case 'characters':
                            content = `
                                <h2 class="text-xl font-bold mb-4">${LANG_CONTENT[currentLanguage]?.charactersTitle}</h2>
                                <p>${LANG_CONTENT[currentLanguage]?.charactersDescription}</p>
                                <div class="grid grid-cols-2 gap-4 mt-4">
                                    ${data?.map(char => `
                                        <div class="flex flex-col items-center">
                                            <img src="${getAssetUrl(char.image_key)}" alt="${char.name}" class="rounded-lg shadow-md mb-2">
                                            <p class="font-bold">${char.name}</p>
                                            <p class="text-sm opacity-80 text-center">${char.description}</p>
                                        </div>
                                    `).join('')}
                                </div>
                            `;
                            if (openedWindow) {
                                openedWindow.querySelector('.os-window-content').innerHTML = content;
                                renderDynamicAssets(); // Re-render icons after content update
                            }
                            break;
                        case 'about':
                            content = data?.content;
                            isMarkdown = true;
                            if (openedWindow) {
                                openedWindow.querySelector('.os-window-content').innerHTML = marked.parse(content || '');
                                renderDynamicAssets(); // Re-render icons after content update
                            }
                            break;
                        case 'services':
                            content = marked.parse(data?.description || '') + `
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mt-4">
                                    ${data?.categories.map(category => `
                                        <div class="service-category-card p-4 rounded-lg border border-primary-blue hover:bg-glass-bg cursor-pointer transition-all duration-200" data-category-id="${category.id}">
                                            <h3 class="font-bold text-lg text-light-blue">${category.name}</h3>
                                            <p class="text-sm opacity-80 mt-1">${category.shortDescription}</p>
                                        </div>
                                    `).join('')}
                                </div>
                            `;
                            if (openedWindow) {
                                openedWindow.querySelector('.os-window-content').innerHTML = content;
                                // Attach event listeners to newly created service category cards
                                setTimeout(() => {
                                    openedWindow.querySelectorAll('.service-category-card').forEach(card => {
                                        card.addEventListener('click', () => {
                                            const categoryId = card.dataset.categoryId;
                                            const selectedCategory = data?.categories.find(cat => cat.id === categoryId);
                                            if (selectedCategory) {
                                                console.log(`服务类别“${categoryId}”被点击。正在打开详细信息窗口。`);
                                                openServiceCategoryDetail(selectedCategory);
                                            } else {
                                                console.warn(`未找到ID为“${categoryId}”的服务类别。`);
                                            }
                                        });
                                    });
                                }, 100);
                                renderDynamicAssets(); // Re-render icons after content update
                            }
                            break;
                        case 'socials':
                            content = marked.parse(data?.description || '') + `
                                <div class="flex flex-wrap gap-4 mt-4">
                                    ${data?.links.map(link => `
                                        <a href="${link.url}" target="_blank" class="flex items-center space-x-2 hover:text-primary-blue transition-colors">
                                            <span class="icon-placeholder" data-asset-key="${link.iconAssetKey}"></span>
                                            <span>${link.name}</span>
                                        </a>
                                    `).join('')}
                                </div>
                            `;
                            if (openedWindow) {
                                openedWindow.querySelector('.os-window-content').innerHTML = content;
                                renderDynamicAssets(); // Re-render icons after content update
                            }
                            break;
                        case 'data-core': // New content rendering for Data Core
                            if (data && data.length > 0) {
                                content = `
                                    <h2 class="text-xl font-bold mb-4">${chineseTitle}</h2>
                                    <p>${LANG_CONTENT[currentLanguage]?.datacoreDescription}</p>
                                    <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4 mt-4">
                                        ${data.map(image => `
                                            <div class="flex flex-col items-center p-2 rounded-lg bg-white bg-opacity-5 hover:bg-opacity-10 transition-colors">
                                                <img src="${getAssetUrl(image.thumb_key)}" alt="${image.alt}" class="w-full h-32 object-cover rounded-md mb-2 cursor-pointer" data-full-image="${getAssetUrl(image.full_key || image.thumb_key)}">
                                                <p class="text-sm text-center opacity-90">${image.alt}</p>
                                            </div>
                                        `).join('')}
                                    </div>
                                    <div id="image-modal" class="hidden fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50 p-4">
                                        <div class="relative max-w-4xl max-h-full">
                                            <img id="modal-image" src="" alt="Full size image" class="max-w-full max-h-[80vh] object-contain rounded-lg shadow-xl">
                                            <button id="close-modal" class="absolute top-4 right-4 text-white text-3xl font-bold p-2 rounded-full bg-red-600 hover:bg-red-700 transition-colors">&times;</button>
                                        </div>
                                    </div>
                                `;
                            } else {
                                content = `
                                    <h2 class="text-xl font-bold mb-4">${chineseTitle}</h2>
                                    <p>${LANG_CONTENT[currentLanguage]?.datacoreEmpty}</p>
                                `;
                            }
                            if (openedWindow) {
                                openedWindow.querySelector('.os-window-content').innerHTML = content;
                                renderDynamicAssets(); // Re-render icons after content update
                                // Re-attach modal event listeners for the new content
                                setTimeout(() => {
                                    const imageModal = openedWindow.querySelector('#image-modal');
                                    const modalImage = openedWindow.querySelector('#modal-image');
                                    const closeModalButton = openedWindow.querySelector('#close-modal');

                                    openedWindow.querySelectorAll('.os-window-content img[data-full-image]').forEach(img => {
                                        img.addEventListener('click', (e) => {
                                            modalImage.src = e.target.dataset.fullImage;
                                            imageModal.classList.remove('hidden');
                                        });
                                    });

                                    if (closeModalButton) {
                                        closeModalButton.addEventListener('click', () => {
                                            imageModal.classList.add('hidden');
                                            modalImage.src = '';
                                        });
                                    }

                                    if (imageModal) {
                                        imageModal.addEventListener('click', (e) => {
                                            if (e.target === imageModal) {
                                                imageModal.classList.add('hidden');
                                                modalImage.src = '';
                                            }
                                        });
                                    }
                                }, 100);
                            }
                            break;
                        case 'settings':
                            content = marked.parse(data?.description || '') + `
                                <div class="flex flex-col gap-4 mt-4">
                                    ${data?.options.map(option => {
                                        const labelText = LANG_CONTENT[currentLanguage]?.settings?.options.find(opt => opt.id === option.id)?.label || option.label;
                                        if (option.type === 'toggle') {
                                            return `
                                                <div class="flex items-center justify-between p-3 rounded-lg bg-white bg-opacity-5 border border-white border-opacity-20">
                                                    <label for="${option.id}" class="text-lg">${labelText}</label>
                                                    <label class="toggle-switch">
                                                        <input type="checkbox" id="${option.id}" ${option.checked ? 'checked' : ''} ${option.disabled ? 'disabled' : ''}>
                                                        <span class="toggle-slider round"></span>
                                                    </label>
                                                </div>
                                            `;
                                        } else if (option.type === 'language-toggle') {
                                            return `
                                                <div class="flex items-center justify-between p-3 rounded-lg bg-white bg-opacity-5 border border-white border-opacity-20">
                                                    <span class="text-lg">${labelText}</span>
                                                    <label class="toggle-switch">
                                                        <input type="checkbox" id="${option.id}" ${currentLanguage === 'en' ? 'checked' : ''}>
                                                        <span class="toggle-slider round"></span>
                                                    </label>
                                                </div>
                                            `;
                                        } else if (option.type === 'button') {
                                            return `
                                                <button id="${option.id}" class="py-2 px-4 rounded-lg bg-primary-blue hover:bg-dark-blue transition-colors text-white font-bold ${option.disabled ? 'opacity-50 cursor-not-allowed' : ''}" ${option.disabled ? 'disabled' : ''}>
                                                    ${labelText}
                                                </button>
                                            `;
                                        }
                                        return '';
                                    }).join('')}
                                </div>
                            `;
                            if (openedWindow) {
                                openedWindow.querySelector('.os-window-content').innerHTML = content;
                                setTimeout(() => {
                                    const languageToggle = openedWindow.querySelector('#language-toggle');
                                    if (languageToggle) {
                                        languageToggle.addEventListener('change', (e) => {
                                            const newLang = e.target.checked ? 'en' : 'zh';
                                            if (newLang !== currentLanguage) {
                                                currentLanguage = newLang;
                                                console.log(`通过设置切换语言到: ${currentLanguage}`);
                                                updateUIForLanguage();
                                                // Re-render the settings window to reflect the new language
                                                const { chineseTitle: settingsZh, englishTitle: settingsEn } = getWindowTitles('settings');
                                                openWindow('settings', settingsZh, settingsEn, content, 'settings');
                                            }
                                        });
                                    }

                                    const desktopIconsToggle = openedWindow.querySelector('#desktop-icons-toggle');
                                    if (desktopIconsToggle) {
                                        desktopIconsToggle.addEventListener('change', (e) => {
                                            if (e.target.checked) {
                                                desktopIconsContainer.style.display = 'block';
                                                console.log('桌面图标已启用。');
                                            } else {
                                                desktopIconsContainer.style.display = 'none';
                                                console.log('桌面图标已禁用。');
                                            }
                                        });
                                    }
                                }, 100);
                                renderDynamicAssets(); // Re-render icons after content update
                            }
                            break;
                        case 'shutdown':
                            content = `
                                <h2 class="text-xl font-bold mb-4 text-red-400">${LANG_CONTENT[currentLanguage]?.shutdownMenuItem}...</h2>
                                <p>${LANG_CONTENT[currentLanguage]?.shutdownMessage}</p>
                                <p class="mt-4 opacity-70">${(LANG_CONTENT[currentLanguage]?.loadingMessage || '加载中...').replace('加载中...', '请稍候...')}</p>
                            `;
                            if (openedWindow) {
                                openedWindow.querySelector('.os-window-content').innerHTML = content;
                                renderDynamicAssets(); // Re-render icons after content update
                            }
                            // For a real shutdown, you might redirect or show a final message
                            setTimeout(() => {
                                console.log(LANG_CONTENT[currentLanguage]?.shutdownMessage);
                                mainDesktopArea.innerHTML = `<div id="welcome-message" class="absolute inset-0 flex items-center justify-center pointer-events-none">
                                    <p class="text-3xl text-white opacity-70" id="welcome-message-text">${LANG_CONTENT[currentLanguage]?.shutdownMessage}</p>
                                </div>`;
                                // Clear all open windows from map and taskbar
                                openWindowsMap.clear();
                                taskbarIconsContainer.innerHTML = '';
                                renderDynamicAssets(); // Ensure icons in shutdown message are rendered if any
                            }, 2000);
                            break;
                    }
                });
            });


            // Handle Start Menu header click to open About Me
            if (startMenuHeader) {
                startMenuHeader.addEventListener('click', async (event) => {
                    event.preventDefault();
                    event.stopPropagation(); // Prevent start menu from closing immediately
                    startMenu.classList.add('hidden');

                    const section = 'about';
                    // Directly get titles from LANG_CONTENT, as getWindowTitles is for generic sections
                    const aboutTitleForWindow = LANG_CONTENT[currentLanguage]?.aboutTitle;
                    const aboutContentForWindow = LANG_CONTENT[currentLanguage]?.aboutContent;

                    if (aboutContentForWindow) { // Check if content exists
                        openWindow('about', aboutTitleForWindow, LANG_CONTENT['en']?.aboutTitle, aboutContentForWindow, 'about', {}, true);
                    } else {
                        console.error(`错误：未找到关于 MAZKO 的内容，语言 ${currentLanguage} 或未定义。`);
                        openWindow('about', '错误', '错误', `<p class="text-xl text-red-400">无法加载关于 MAZKO 的内容。</p>`, 'about', {}, false);
                    }
                });
            }


            // --- 桌面图标拖动逻辑 ---
            let isDraggingIcon = false;
            let currentDraggedIcon = null;
            let initialMouseX, initialMouseY;
            let initialIconX, initialIconY;

            if (desktopIconsContainer) {
                desktopIconsContainer.querySelectorAll('.desktop-icon').forEach(icon => {
                    // Set initial positions (from inline style)
                    icon.style.position = 'absolute'; // Ensure position is absolute for dragging

                    icon.addEventListener('mousedown', (e) => {
                        if (e.button !== 0) return; // Only allow left-click drag
                        isDraggingIcon = true;
                        currentDraggedIcon = icon;
                        initialMouseX = e.clientX;
                        initialMouseY = e.clientY;
                        initialIconX = icon.offsetLeft;
                        initialIconY = icon.offsetTop;

                        // Bring the icon to front while dragging (optional, but good UX)
                        currentDraggedIcon.style.zIndex = highestZIndex + 1; 

                        e.preventDefault(); // Prevent default browser drag behavior (e.g., ghost image)
                        console.log(`开始拖动图标: ${icon.dataset.title}`);
                    });

                    // Handle icon click (separate from drag)
                    icon.addEventListener('click', (event) => {
                        // If it was a drag, don't open the window
                        if (currentDraggedIcon === icon && (Math.abs(event.clientX - initialMouseX) > 5 || Math.abs(event.clientY - initialMouseY) > 5)) {
                            console.log("图标被拖动，阻止点击操作。");
                            return; 
                        }

                        const section = icon.dataset.section;
                        const { chineseTitle, englishTitle } = getWindowTitles(section);
                        
                        let existingWindow = document.querySelector(`.os-window[data-window-id="${section}"]`);
                        if (existingWindow) {
                            if (existingWindow.classList.contains('minimized')) {
                                restoreWindow(existingWindow);
                            } else {
                                bringToFront(existingWindow);
                            }
                            return;
                        }

                        // Simulate click on the corresponding start menu item or button to trigger window opening logic
                        // For mazko.exe, directly open the about window
                        if (section === 'about') {
                            console.log('桌面 MAZKO 图标被点击。当前语言:', currentLanguage);
                            // Directly access aboutTitle and aboutContent from LANG_CONTENT
                            const aboutTitleForWindow = LANG_CONTENT[currentLanguage]?.aboutTitle;
                            const aboutContentForWindow = LANG_CONTENT[currentLanguage]?.aboutContent;

                            if (aboutContentForWindow) { // Check if content exists
                                openWindow('about', aboutTitleForWindow, LANG_CONTENT['en']?.aboutTitle, aboutContentForWindow, 'about', {}, true);
                            } else {
                                console.error(`错误：未找到关于 MAZKO 的内容，语言 ${currentLanguage} 或未定义。`);
                                openWindow('about', '错误', '错误', `<p class="text-xl text-red-400">无法加载关于 MAZKO 的内容。</p>`, 'about', {}, false);
                            }
                        } else {
                            // Find the corresponding start menu item or button and click it
                            const startMenuItem = document.querySelector(`.start-menu-item[data-section="${section}"]`);
                            const startMenuFooterButton = document.querySelector(`.start-menu-footer-button[data-section="${section}"]`);
                            // Also check for the new data-core menu item
                            const datacoreMenuItem = document.querySelector(`.start-menu-item[data-section="data-core"]`);

                            if (startMenuItem) {
                                startMenuItem.click();
                            } else if (startMenuFooterButton) {
                                startMenuFooterButton.click();
                            } else if (datacoreMenuItem && section === 'data-core') { // Specific click for data-core if it's the target
                                datacoreMenuItem.click();
                            } else {
                                console.warn(`未找到模块: ${section} 的开始菜单项或底部按钮`);
                            }
                        }
                    });
                });
            }

            document.addEventListener('mousemove', (e) => {
                if (!isDraggingIcon || !currentDraggedIcon) return;

                const dx = e.clientX - initialMouseX;
                const dy = e.clientY - initialMouseY;

                let newX = initialIconX + dx;
                let newY = initialIconY + dy;

                // Boundary checks for dragging within mainDesktopArea
                const desktopRect = mainDesktopArea.getBoundingClientRect();
                const iconRect = currentDraggedIcon.getBoundingClientRect();

                // Calculate bounds relative to the desktop area's top-left corner
                const minX = 0;
                const minY = 0;
                const maxX = desktopRect.width - iconRect.width;
                const maxY = desktopRect.height - iconRect.height;

                newX = Math.max(minX, Math.min(newX, maxX));
                newY = Math.max(minY, Math.min(newY, maxY));

                currentDraggedIcon.style.left = `${newX}px`;
                currentDraggedIcon.style.top = `${newY}px`;
            });

            document.addEventListener('mouseup', () => {
                if (isDraggingIcon) {
                    isDraggingIcon = false;
                    if (currentDraggedIcon) {
                        // Reset z-index if desired, or keep it high if windows can overlap icons
                        currentDraggedIcon.style.zIndex = 2; 
                        console.log(`停止拖动图标: ${currentDraggedIcon.dataset.title}`);
                    }
                    currentDraggedIcon = null;
                }
            });

            // Handle window focus/blur to update title bar active state
            document.addEventListener('mousedown', (e) => {
                const clickedWindow = e.target.closest('.os-window');
                document.querySelectorAll('.os-window').forEach(win => {
                    const titleBar = win.querySelector('.os-window-title-bar');
                    if (titleBar) {
                        if (win === clickedWindow) {
                            titleBar.classList.remove('inactive');
                        } else {
                            titleBar.classList.add('inactive');
                        }
                    }
                });
            });

            // Initial UI update based on default language
            updateCursors(); // Set cursors initially
            updateUIForLanguage(); // Render text and initial assets
            renderDynamicAssets(); // Render all initial icons
            console.log('所有事件监听器已附加，脚本初始化完成。');
        });
    </script>
</body>
</html>
