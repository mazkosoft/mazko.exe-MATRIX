<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>𝗠𝗔𝗫 _𝗢𝗦 _ [𝖬𝙰𝚃𝚁𝖨𝚇 𝖤𝙳𝖨𝚃𝖨𝙴𝙳𝖨𝚃𝖨𝖤𝙳𝖨𝖮𝖭]</title>
    <!-- Favicon - 使用一个简单的SVG作为示例 -->
    <link rel="icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'><text x='0' y='14' font-size='16'>🌟</text></svg>\" type="image/svg+xml">
    <!-- 引入 Tailwind CSS CDN，用于快速构建和响应式布局 -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- 引入 Google Fonts - Inter 字体作为通用字体，如果需要 'Chocolate Classical Sans'，请在此处引入其 CDN 或本地路径 -->
    <link href="https://fonts.googleapis.com/css2?family=Roboto+Mono:wght@400;700&display=swap" rel="stylesheet">
    <!-- Marked.js 用于 Markdown 解析 -->
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <style>
        /* 全局样式和变量，针对 Matrix 视觉风格优化 */
        :root {
            /* 核心黑客帝国绿色调色板 */
            --matrix-green-light: #00FF41; /* 明亮的绿色文字，用于高光和激活状态 */
            --matrix-green-dark: #008F11; /* 深绿色，用于背景和阴影 */
            --matrix-black: #080808; /* 深黑色，作为主要背景 */
            --matrix-dark-grey: #1A1A1A; /* 稍微亮一点的深灰色，用于边框和结构 */
            --matrix-light-grey: #333333; /* 用于更亮的金属纹理 */

            /* 金属拟物化效果 - 增强版 (改为铬合金颜色，更亮、更反射，更强对比) */
            --metal-color-start: #f8f8f8; /* 极浅的银色，接近纯白色，用于最强高光 */
            --metal-color-mid: #d0d0d0;   /* 亮银色 */
            --metal-color-end: #707070;   /* 显著更深的银灰色，用于深阴影 */
            --metal-highlight: rgba(255, 255, 255, 0.98); /* 极强的反射高光，几乎白色 */
            --metal-shadow: rgba(0, 0, 0, 0.9);         /* 极深阴影深度，更实 */
            --metal-inner-shadow: rgba(0, 0, 0, 0.9);   /* 内部阴影，更深 */
            --metal-border-light: rgba(255, 255, 255, 0.99); /* 极浅金属色，用于高光边框，极亮 */
            --metal-border-dark: rgba(30, 30, 30, 0.98); /* 极深金属色，用于阴影边框，极深 */
            --metal-bg: rgba(100, 100, 100, 0.35); /* 金属背景的微妙光泽，略微更可见 */
            --metal-text-color: var(--matrix-dark-grey); /* 用于金属背景上的文字颜色 */


            /* 黑色玻璃显示屏效果 - 增加玻璃质感，降低模糊度以提高清晰度 */
            --glass-bg: rgba(0, 0, 0, 0.6); /* 更不透明的黑色半透明背景 */
            --glass-blur: 5px; /* 略微增加模糊度，使玻璃感更强 */
            --glass-border: rgba(0, 255, 65, 0.6); /* 绿色半透明边框，更明显 */
            --glass-glow: 0 0 15px rgba(0, 255, 65, 0.6); /* 绿色光晕，强度适中 */
            --glass-inset-shadow: inset 0 0 8px rgba(0, 255, 65, 0.2); /* 绿色内阴影，强度适中 */

            /* 字体 - 使用等宽字体模拟代码终端 */
            --font-main: 'Roboto Mono', monospace;

            /* 阴影与光晕 - 绿色调 */
            --shadow-matrix: 0 4px 15px rgba(0, 255, 65, 0.2); /* 柔和的绿色阴影 */
            --glow-matrix: 0 0 16px rgba(0, 255, 65, 0.7); /* 强烈的绿色光晕 */
            --text-glow-matrix: 0 0 5px rgba(0, 255, 65, 0.7), 0 0 10px rgba(0, 255, 65, 0.5); /* 调整文字光晕强度 */

            --taskbar-height: 48px;

            /* 鼠标指针 - 由 JavaScript 动态设置 */
            --cursor-default: auto;
            --cursor-active: auto;
            --cursor-pointer: pointer;

            /* 桌面背景图片的CSS变量 - 修正路径为 ./assets/... */
            --desktop-image-url: url('./assets/backgrounds/bg.jpg');
        }

        body {
            /* 全局字体应用新主字体 */
            font-family: var(--font-main);
            /* 深色背景 */
            background-color: var(--matrix-black);
            /* 文本颜色设置为绿色 */
            color: var(--matrix-green-light); /* 默认文字颜色为绿色，适用于深色背景 */
            margin: 0;
            padding: 0;
            overflow: hidden; /* 防止滚动条出现，模拟桌面环境 */
            position: relative; /* 用于背景动画定位 */
            width: 100vw; /* 确保主体占满整个视口宽度 */
            height: 100vh; /* 确保主体占满整个视口高度 */
            cursor: var(--cursor-default);
            display: flex; /* 使用弹性盒子布局桌面容器 */
            flex-direction: column;
            
            /* CRT 纹理和发光效果 - 移除频闪动画 */
            position: relative;
            overflow: hidden; /* 确保伪元素不会溢出 */
        }

        body::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1000; /* 确保在其他内容之上 */
            opacity: 0.08; /* 调整 CRT 纹理的透明度，使其更不显眼 */
            background: repeating-linear-gradient(
                #080808,
                #080808 1px,
                #00FF41 1px,
                #00FF41 2px
            ); /* 细微的绿色扫描线 */
            background-size: 100% 4px;
            filter: blur(0.4px) hue-rotate(0deg) saturate(1.5); /* 稍微模糊和饱和度，模拟旧屏幕 */
        }

        .os-window-content, 
        .start-menu-item,
        .work-card,
        .service-category-card,
        .taskbar-minimized-icon,
        .work-detail-content,
        .system-tray-display { /* Applied to new system-tray-display */
            position: relative; /* 确保伪元素相对于自身定位 */
            overflow: hidden;
            z-index: 1; /* 确保内容在 CRT 纹理之下 */
        }

        .os-window-content::after, 
        .start-menu-item::after,
        .work-card::after,
        .service-category-card::after,
        .taskbar-minimized-icon::after,
        .work-detail-content::after,
        .system-tray-display::after { /* Applied to new system-tray-display */
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 2; /* 确保在内容之上 */
            opacity: 0.08; /* 调整 CRT 纹理的透明度，使其更不显眼 */
            background: repeating-linear-gradient(
                #080808,
                #080808 1px,
                #00FF41 1px,
                #00FF41 2px
            ); /* 细微的绿色扫描线 */
            background-size: 100% 4px;
            filter: blur(0.4px) hue-rotate(0deg) saturate(1.5); /* 稍微模糊和饱和度，模拟旧屏幕 */
        }

        body:active {
            cursor: var(--cursor-active);
        }

        a, button, .clickable-element {
            cursor: var(--cursor-pointer);
        }

        /* Matrix 风格桌面背景 */
        .desktop-background {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            min-height: 100vh;
            background-image: var(--desktop-image-url);
            background-size: cover;
            background-position: center;
            opacity: 0.9;
            filter: brightness(0.7) contrast(1.2); /* 使背景更暗更具对比度 */
            z-index: -1;
        }
        .desktop-background::before,
        .desktop-background::after {
            display: none !important; /* 隐藏原始的伪元素效果 */
        }
        /* 当背景图片激活时，隐藏伪元素 */
        .desktop-background-image-active {
            background-image: var(--desktop-image-url) !important;
            background-color: transparent !important;
            opacity: 0.9 !important;
            filter: brightness(0.7) contrast(1.2) !important;
        }
        .desktop-background-image-active::before,
        .desktop-background-image-active::after {
            display: none !important;
        }

        /* 桌面容器，作为主要内容包装器 */
        .desktop-container {
            position: relative;
            flex-grow: 1;
            width: 100%;
            height: 100%;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            z-index: 3;
        }

        /* 桌面布局 - 包含主桌面区和任务栏 */
        .desktop-layout {
            display: flex;
            flex-direction: column;
            width: 100%;
            height: 100%;
        }

        /* 主桌面区 - 图标和窗口所在区域 */
        .main-desktop-area {
            flex-grow: 1;
            position: relative;
            overflow: hidden;
            padding: 10px;
            padding-bottom: calc(10px + var(--taskbar-height));
        }

        /* 任务栏 - 高度拟物化金属边框 */
        .taskbar {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: var(--taskbar-height);
            background: linear-gradient(to top, var(--metal-color-start) 0%, var(--metal-color-mid) 50%, var(--metal-color-end) 100%); /* 显著的金属渐变 */
            border-top: 2px solid var(--metal-border-light); /* 顶部高光 */
            border-bottom: 2px solid var(--metal-border-dark); /* 底部阴影 */
            box-shadow: 
                0 -1px 0 var(--metal-border-light), /* 顶部薄高光 */
                0 -8px 30px rgba(0, 255, 65, 0.3), /* 绿色光晕 */
                inset 0 1px 2px var(--metal-highlight), /* 内部高光 */
                inset 0 -2px 5px var(--metal-inner-shadow); /* 内部阴影，模拟深度 */
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 10px;
            z-index: 100;
            position: fixed;
            overflow: hidden; /* 防止内容溢出 */
        }
        .taskbar::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: repeating-linear-gradient(90deg, transparent, transparent 1px, var(--metal-bg) 1px, var(--metal-bg) 2px); /* 细微的金属拉丝纹理 */
            pointer-events: none;
            opacity: 0.8;
        }

        /* 开始按钮 - 高度拟物化的金属按钮 */
        .start-button {
            background: linear-gradient(to bottom, var(--metal-color-start) 0%, var(--metal-color-mid) 50%, var(--metal-color-end) 100%);
            border: 2px solid var(--metal-border-light); /* 顶部高光 */
            border-bottom-color: var(--metal-border-dark); /* 底部阴影 */
            border-right-color: var(--metal-border-dark);
            border-radius: 8px;
            width: 48px;
            height: 48px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--metal-text-color); /* 文字颜色改为深灰色 */
            font-size: 0.9rem;
            font-weight: bold;
            text-shadow: none; /* 移除绿色文字阴影 */
            box-shadow: 
                0 6px 20px rgba(0,255,65,0.4), /* 绿色外部光晕 */
                inset 0 1px 2px var(--metal-highlight), /* 内部高光 */
                inset 0 -2px 5px var(--metal-inner-shadow), /* 内部阴影 */
                inset 0 0 1px rgba(255,255,255,0.5); /* 微妙的光泽 */
            cursor: pointer;
            transition: all 0.2s ease-in-out;
            position: relative;
            overflow: hidden;
        }

        /* 移除闪光效果的伪元素 */
        .start-button::before,
        .start-button::after {
            display: none; 
        }

        .start-button:hover {
            background: linear-gradient(to top, var(--metal-color-start) 0%, var(--metal-color-mid) 50%, var(--metal-color-end) 100%);
            transform: translateY(-4px);
            border-color: var(--matrix-green-light);
            box-shadow: 
                0 8px 25px var(--glow-matrix), /* 更强的外部光晕 */
                inset 0 1px 3px var(--metal-highlight), /* 更强的内部高光 */
                inset 0 -3px 6px var(--metal-inner-shadow); /* 更深的内部阴影 */
        }

        .start-button:active {
            background: linear-gradient(to bottom, var(--metal-color-end) 0%, var(--metal-color-mid) 50%, var(--metal-color-start) 100%); /* 按下时的反向渐变 */
            transform: translateY(0);
            box-shadow: 
                inset 0 6px 15px var(--metal-shadow), /* Deeper inset shadow */
                inset 0 -2px 5px var(--metal-highlight), /* More pronounced highlight */
                0 2px 5px rgba(0,255,65,0.3); /* Smaller external shadow */
            filter: brightness(0.7); /* Slightly darker on press */
            border-top-color: var(--metal-border-dark);
            border-bottom-color: var(--metal-border-light);
            border-left-color: var(--metal-border-dark);
            border-right-color: var(--metal-border-light);
        }

        .start-button .icon-image {
            width: 1.6em; /* Start button icon size slightly reduced */
            height: auto; /* Ensure aspect ratio is maintained */
            filter: drop-shadow(var(--text-glow-matrix));
            object-fit: contain; /* Prevent stretching */
        }

        /* 任务栏图标（打开/最小化窗口） */
        .taskbar-icons-container {
            display: flex;
            flex-grow: 1;
            justify-content: flex-start;
            align-items: center;
            height: 100%;
            overflow-x: auto;
            padding: 0 10px;
            gap: 10px;
        }

        /* 系统托盘 */
        .system-tray {
            display: flex;
            align-items: center;
            gap: 8px; /* Slightly reduced gap */
        }

        /* 新增：系统托盘显示屏效果 */
        .system-tray-display {
            background-color: var(--matrix-black);
            border: 1px solid var(--matrix-green-dark);
            border-radius: 6px; /* Rounded corners for the display */
            padding: 4px 8px;
            display: flex;
            align-items: center;
            box-shadow: inset 0 0 5px rgba(0, 255, 65, 0.1), 0 0 8px rgba(0, 255, 65, 0.2);
            position: relative;
            overflow: hidden;
            gap: 6px; /* Space between items inside the display */
        }

        .system-tray-display .icon-image {
            width: 1.1em; /* Slightly smaller icons inside display */
            height: auto;
            vertical-align: middle;
            filter: drop-shadow(0 0 6px var(--matrix-green-light)); /* Green glow for icons */
            transition: filter 0.2s ease;
        }

        .system-tray-display #current-time {
            font-size: 0.85rem; /* Time font size */
            color: var(--matrix-green-light); /* Green time */
            text-shadow: 0 0 4px var(--matrix-green-light); /* Green text glow */
        }

        /* 桌面图标（快捷方式） */
        .desktop-icons-container {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: calc(100% - var(--taskbar-height));
            padding: 20px;
            z-index: 2;
        }

        .desktop-icon {
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
            width: 100px;
            cursor: pointer;
            transition: transform 0.15s ease, filter 0.15s ease;
            padding: 10px;
            border-radius: 15px;
            user-select: none;
            position: absolute;
        }

        .desktop-icon:hover {
            filter: brightness(1.1);
            background-color: rgba(0, 255, 65, 0.1);
            transform: translateY(-5px); /* Add subtle lift on hover */
        }

        .desktop-icon:active {
            transform: scale(0.95) translateY(0); /* Reset Y on active */
            filter: brightness(0.9);
            background-color: rgba(0, 255, 65, 0.05);
        }

        .desktop-icon .icon-image {
            width: 60px;
            height: auto; /* Allow height to adjust naturally */
            max-width: 100%; /* Ensure it doesn't overflow its container */
            object-fit: contain; /* Prevent stretching */
            filter: drop-shadow(0 4px 8px rgba(0,0,0,0.8));
            transition: filter 0.15s ease;
        }

        .desktop-icon:hover .icon-image {
            filter: drop-shadow(0 0 8px var(--matrix-green-light))
                    drop-shadow(0 0 15px rgba(0, 255, 65, 0.5))
                    drop-shadow(0 0 25px rgba(0, 255, 65, 0.3));
        }

        .desktop-icon:active .icon-image {
            filter: drop-shadow(0 0 3px rgba(0,0,0,0.6));
        }

        .desktop-icon-label {
            font-size: 0.9rem;
            color: var(--matrix-green-light);
            text-shadow: var(--text-glow-matrix);
            margin-top: 10px;
            word-wrap: break-word;
            max-width: 100%;
        }

        /* 开始菜单样式 - 黑色玻璃感，现在改为只有金属外框，内部卡片黑色*/
        .start-menu {
            position: absolute;
            bottom: var(--taskbar-height);
            left: 10px;
            width: 380px;
            height: auto;
            max-height: calc(100% - var(--taskbar-height) - 40px);
            background: rgba(0,0,0,0.8); /* Changed to black background */
            backdrop-filter: blur(var(--glass-blur)); /* 使用变量控制模糊度 */
            -webkit-backdrop-filter: blur(var(--glass-blur));
            border-radius: 12px;
            box-shadow: 
                0 8px 25px rgba(0, 255, 65, 0.5), /* Strong green outer glow */
                inset 0 1px 2px var(--metal-highlight), /* Inner highlight */
                inset 0 -2px 5px var(--metal-inner-shadow); /* Inner shadow */
            padding: 20px;
            /* 初始隐藏状态 */
            visibility: hidden;
            opacity: 0;
            transform: scale(0.6);
            flex-direction: column;
            z-index: 100;
            transform-origin: bottom left;
            transition: opacity 0.3s ease-out, transform 0.3s ease-out, visibility 0.3s ease-out; /* Add transition for smoothness */
            overflow-y: auto;
            /* Added subtle metal texture to the overall menu background */
            background-image: repeating-linear-gradient(90deg, transparent, transparent 1px, var(--metal-bg) 1px, var(--metal-bg) 2px); /* Metal texture */
            background-blend-mode: overlay; /* Blend with black background */
        }

        /* 新增的打开状态类 */
        .start-menu.is-open {
            visibility: visible;
            opacity: 1;
            transform: scale(1);
            /* 动画现在由 transition 属性本身处理 */
        }

        /* 开始菜单头部（带个人信息） - 更高度拟物化的金属风格 */
        .start-menu-header {
            background: linear-gradient(to right, var(--metal-color-start) 0%, var(--metal-color-mid) 50%, var(--metal-color-end) 100%);
            border: 2px solid var(--metal-border-light);
            border-bottom-color: var(--metal-border-dark);
            border-right-color: var(--metal-border-dark);
            box-shadow: 
                inset 0 1px 2px var(--metal-highlight), 
                inset 0 -2px 5px var(--metal-inner-shadow),
                0 4px 10px var(--metal-shadow);
            cursor: pointer;
            transition: all 0.2s ease;
            position: relative;
            overflow: hidden;
            display: flex; /* Added display flex */
            align-items: center; /* Added align items */
            padding: 15px; /* Added padding */
            margin-bottom: 15px; /* Added margin bottom */
            border-radius: 8px; /* Added border radius */
        }
        .start-menu-header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: repeating-linear-gradient(90deg, transparent, transparent 1px, var(--metal-bg) 1px, var(--metal-bg) 2px); /* 细微的金属拉丝纹理 */
            border-radius: inherit;
            pointer-events: none;
            opacity: 0.8;
        }
        /* 移除闪光效果的伪元素 */
        .start-menu-header::after {
            display: none;
        }
        .start-menu-header:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 20px var(--glow-matrix), 
                        inset 0 1px 3px var(--metal-highlight),
                        inset 0 -3px 6px var(--metal-inner-shadow);
            filter: brightness(1.1);
        }
        .start-menu-header:active {
            background: linear-gradient(to bottom, var(--metal-color-end) 0%, var(--metal-color-mid) 50%, var(--metal-color-start) 100%);
            transform: translateY(0);
            box-shadow: 
                inset 0 6px 15px var(--metal-shadow), 
                inset 0 -1px 3px var(--metal-highlight),
                0 2px 5px rgba(0,255,65,0.3);
            filter: brightness(0.9);
            border-top-color: var(--metal-border-dark);
            border-bottom-color: var(--metal-border-light);
            border-left-color: var(--metal-border-dark);
            border-right-color: var(--metal-border-light);
        }
        /* 更改开始菜单头部文字和图标颜色为深灰色，并移除光晕 */
        .start-menu-header span, .start-menu-header .icon-image {
            color: var(--metal-text-color); /* Change to dark grey */
            filter: none; /* Remove green glow from icon */
            text-shadow: none; /* Remove text glow */
        }
        .start-menu-header .icon-image {
            width: 2em; /* Reduced size for start menu header icon */
            height: auto; /* Maintain aspect ratio */
            object-fit: contain; /* Prevent stretching */
            margin-right: 12px; /* Add some spacing */
        }
        .start-menu-header:hover span, .start-menu-header:hover .icon-image {
            color: var(--metal-text-color); /* Keep dark on hover */
            filter: none;
            text-shadow: none;
        }


        /* 开始菜单条目样式 - 更具交互性和代码感 */
        .start-menu-item {
            padding: 15px 20px;
            display: flex;
            align-items: center;
            color: var(--matrix-green-light);
            text-decoration: none;
            transition: background-color 0.2s ease, transform 0.15s ease, filter 0.2s ease, box-shadow 0.2s ease;
            cursor: pointer;
            font-size: 1.05rem;
            font-weight: normal;
            border-radius: 8px;
            margin: 6px 0;
            position: relative;
            overflow: hidden;
            box-shadow: var(--glass-inset-shadow);
            /* Card background to black */
            background-color: rgba(0, 0, 0, 0.7); 
            border: 1px solid var(--glass-border); /* Retain green border */
            /* Added subtle glass reflection */
            background-image: linear-gradient(to top right, rgba(255, 255, 255, 0.03) 0%, transparent 50%);
        }

        .start-menu-item::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(0,255,65,0.4), transparent);
            transition: left 0.5s ease;
        }

        .start-menu-item:hover::before {
            left: 100%;
        }

        .start-menu-item:hover {
            background: rgba(0, 0, 0, 0.9);
            transform: translateX(10px);
            color: white;
            text-shadow: var(--text-glow-matrix);
            filter: brightness(1.4);
            box-shadow: var(--glass-glow), inset 0 0 10px rgba(0,0,0,0.5);
        }

        .start-menu-item .icon-image {
            margin-right: 18px;
            width: 1.5em;
            height: auto; /* Ensure aspect ratio */
            object-fit: contain; /* Prevent stretching */
            filter: drop-shadow(0 0 8px rgba(0, 255, 65, 0.8));
            transition: filter 0.2s ease;
        }
        .start-menu-item:hover .icon-image {
            filter: brightness(2) drop-shadow(0 0 15px rgba(0, 255, 65, 1));
        }
        
        .start-menu-item .menu-item-label {
            flex-grow: 1;
            text-align: left;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        /* 开始菜单底部按钮容器（设置和关机） */
        .start-menu-buttons-container {
            display: flex;
            flex-direction: row;
            justify-content: flex-end;
            gap: 15px;
            padding-top: 18px;
            margin-top: 18px;
            padding-right: 10px;
            border-top: 1px solid var(--matrix-dark-grey);
        }

        /* 开始菜单底部图标按钮的新样式 - 高度拟物化的金属按钮 */
        .start-menu-footer-button {
            width: 58px;
            height: 58px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            background: linear-gradient(to bottom, var(--metal-color-start) 0%, var(--metal-color-mid) 50%, var(--metal-color-end) 100%);
            border: 2px solid var(--metal-border-light); /* 顶部高光 */
            border-bottom-color: var(--metal-border-dark); /* 底部阴影 */
            border-right-color: var(--metal-border-dark);
            border-radius: 8px;
            cursor: pointer;
            transition: background-color 0.2s ease, transform 0.1s ease, box-shadow 0.2s ease;
            color: var(--metal-text-color); /* 文字颜色改为深灰色 */
            box-shadow: 
                inset 0 1px 2px var(--metal-highlight), 
                inset 0 -2px 5px var(--metal-inner-shadow),
                0 4px 15px rgba(0,255,65,0.4);
            position: relative;
            overflow: hidden;
        }
        .start-menu-footer-button::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: repeating-linear-gradient(90deg, transparent, transparent 1px, var(--metal-bg) 1px, var(--metal-bg) 2px); /* 细微的金属拉丝纹理 */
            border-radius: inherit;
            pointer-events: none;
            opacity: 0.8;
        }

        .start-menu-footer-button:hover {
            background: linear-gradient(to top, var(--metal-color-start) 0%, var(--metal-color-mid) 50%, var(--metal-color-end) 100%);
            transform: translateY(-4px);
            box-shadow: 
                inset 0 1px 3px var(--metal-highlight), 
                inset 0 -3px 6px var(--metal-inner-shadow),
                0 6px 20px var(--glow-matrix);
        }

        .start-menu-footer-button:active {
            transform: translateY(0);
            background: linear-gradient(to bottom, var(--metal-color-end) 0%, var(--metal-color-mid) 50%, var(--metal-color-start) 100%);
            box-shadow: 
                inset 0 6px 15px var(--metal-shadow), 
                inset 0 -2px 5px var(--metal-highlight),
                0 0 10px rgba(0,255,65,0.7);
            filter: brightness(0.7); /* Slightly darker on press */
            border-top-color: var(--metal-border-dark);
            border-bottom-color: var(--metal-border-light);
            border-left-color: var(--metal-border-dark);
            border-right-color: var(--metal-border-light);
        }

        .start-menu-footer-button .icon-image {
            width: 32px;
            height: auto; /* Ensure aspect ratio */
            object-fit: contain; /* Prevent stretching */
            /* 修正：确保图标有绿色光晕 */
            filter: drop-shadow(0 0 8px rgba(0, 255, 65, 0.7));
        }

        /* 动画：菜单出现 - 从左下角放大淡入 (保留，但现在由 is-open 状态触发) */
        @keyframes fadeInScaleUpFromBottomLeft {
            from {
                opacity: 0;
                transform: scale(0.6);
            }
            to {
                opacity: 1;
                transform: scale(1);
            }
        }

        /* 窗口样式（黑色玻璃质感） */
        .os-window {
            position: absolute;
            background: var(--glass-bg);
            backdrop-filter: blur(var(--glass-blur)); /* 使用变量控制模糊度 */
            -webkit-backdrop-filter: blur(var(--glass-blur));
            border: 2px solid var(--glass-border);
            border-radius: 12px;
            box-shadow: var(--glass-glow), var(--glass-inset-shadow);
            display: flex;
            flex-direction: column;
            overflow: hidden;
            min-width: 400px;
            min-height: 300px;
            z-index: 5;
            animation: windowPopIn 0.3s ease-out forwards;
            resize: both;
            /* Added subtle glass reflection */
            background-image: linear-gradient(to top right, rgba(255, 255, 255, 0.05) 0%, transparent 50%),
                              radial-gradient(circle at 10% 10%, rgba(255, 255, 255, 0.05) 0%, transparent 30%);
            transition: box-shadow 0.3s ease-in-out, border-color 0.3s ease-in-out; /* Add transition for smoothness */
        }

        .os-window.minimized {
            display: none;
        }

        .os-window.maximized {
            top: 0 !important;
            left: 0 !important;
            width: 100% !important;
            height: calc(100% - var(--taskbar-height)) !important;
            border-radius: 0;
            box-shadow: none;
            transition: all 0.3s ease-in-out;
            border: none;
            background-image: none; /* Remove reflection when maximized */
        }

        /* 窗口标题栏 - 高度拟物化的金属边框和绿色文字 */
        .os-window-title-bar {
            background: linear-gradient(to top, var(--metal-color-start) 0%, var(--metal-color-mid) 50%, var(--metal-color-end) 100%);
            border-bottom: 2px solid var(--metal-border-dark); /* 底部阴影 */
            border-top: 1px solid var(--metal-border-light); /* 顶部高光 */
            padding: 10px 18px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: grab;
            border-radius: 12px 12px 0 0;
            position: relative;
            font-size: 1.1rem;
            font-weight: bold;
            color: var(--metal-text-color); /* Text color on metal, now uses variable */
            text-shadow: none; /* Removed text-shadow */
            box-shadow: 
                inset 0 1px 2px var(--metal-highlight), 
                inset 0 -2px 5px var(--metal-inner-shadow),
                0 2px 5px var(--metal-shadow);
            overflow: hidden;
        }
        .os-window-title-bar::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: repeating-linear-gradient(90deg, transparent, transparent 1px, var(--metal-bg) 1px, var(--metal-bg) 2px); /* 细微的金属拉丝纹理 */
            pointer-events: none;
            border-radius: inherit;
            opacity: 0.8;
        }

        .os-window-title-bar.inactive {
            background: linear-gradient(to top, #666666 0%, #444444 100%); /* Desaturated chrome for inactive */
            border-bottom: 1px solid #333333;
            box-shadow: inset 0 -1px 5px rgba(0,0,0,0.3);
            color: rgba(0,0,0,0.5); /* Inactive text color, make it darker */
            text-shadow: none;
        }
        .os-window-title-bar.inactive::after {
            background: linear-gradient(to bottom, rgba(255,255,255,0.05) 0%, transparent 60%); /* Subtle desaturated reflection */
            opacity: 0.5;
        }

        /* 窗口标题和Logo容器 */
        .os-window-title-content {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .os-window-title-content .icon-image {
            width: 28px; /* Slightly smaller for title bar */
            height: auto; /* Allow height to adjust naturally */
            object-fit: contain; /* Prevent stretching */
            filter: drop-shadow(0 0 8px rgba(0, 255, 65, 0.8)); /* 确保标题栏图标有绿色光晕 */
        }
        .os-window-title-bar:not(.inactive) .os-window-title-content .icon-image {
             filter: drop-shadow(0 0 5px rgba(0,0,0,0.5)); /* Subtle dark shadow for depth */
        }
        .os-window-title-bar.inactive .os-window-title-content .icon-image {
            filter: drop-shadow(0 0 3px rgba(0,0,0,0.3)); /* Even more subtle dark shadow for inactive */
        }

        .os-window-title {
            color: var(--metal-text-color); /* Text color on metal, now uses variable */
            text-shadow: none; /* Removed text-shadow */
        }
        .os-window-title-bar.inactive .os-window-title {
            color: rgba(0,0,0,0.5); /* Inactive text color, make it darker */
            text-shadow: none;
        }


        /* 窗口控制按钮（最小化、最大化、关闭） - 高度拟物化的金属绿色按钮 */
        .os-window-controls { /* Added this rule to control button layout */
            display: flex;
            flex-direction: row; /* Ensure horizontal layout */
            align-items: center;
            gap: 8px; /* Spacing between buttons */
        }

        .os-window-controls .control-button {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.7em;
            color: var(--metal-text-color); /* Icon color on metal, now uses variable */
            cursor: pointer;
            transition: background-color 0.15s ease, transform 0.1s ease, box-shadow 0.15s ease;
            
            background: linear-gradient(to bottom, var(--metal-color-start), var(--metal-color-mid), var(--metal-color-end));
            border: 1px solid var(--metal-border-light); /* 顶部高光 */
            border-bottom-color: var(--metal-border-dark); /* 底部阴影 */
            border-right-color: var(--metal-border-dark);
            box-shadow: 
                inset 0 1px 2px var(--metal-highlight), 
                inset 0 -2px 5px var(--metal-inner-shadow),
                0 2px 6px var(--metal-shadow);

            position: relative;
            overflow: hidden;
        }
        .os-window-controls .control-button::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle at top left, rgba(0,255,65,0.05) 0%, transparent 60%); /* Very subtle green reflection */
            border-radius: 50%;
            opacity: 0.8;
            pointer-events: none;
        }

        /* 悬停/激活状态下的按钮颜色 */
        .os-window-controls .control-button:hover {
            transform: scale(1.1);
            filter: brightness(1.2);
            background: linear-gradient(to top, var(--metal-color-start), var(--metal-color-mid), var(--metal-color-end));
            border-color: var(--metal-border-light); /* Brighter border on hover */
            box-shadow: 
                inset 0 1px 3px var(--metal-highlight), 
                inset 0 -3px 6px var(--metal-inner-shadow),
                0 4px 10px var(--metal-shadow);
        }
        /* 关闭按钮的特殊悬停效果，如果需要红色 */
        .os-window-controls .control-button.close:hover {
             background: linear-gradient(to top, #FF4444 0%, #CC0000 100%); /* Red gradient for close */
             border-color: #FF0000;
             box-shadow: inset 0 -2px 10px rgba(0,0,0,0.6), 0 4px 10px rgba(255,0,0,0.6);
        }

        .os-window-controls .control-button:active {
            transform: scale(0.95);
            opacity: 1;
            background: linear-gradient(to bottom, var(--metal-color-end) 0%, var(--metal-color-mid) 50%, var(--metal-color-start) 100%);
            box-shadow: 
                inset 0 3px 10px var(--metal-shadow), 
                inset 0 -1px 3px var(--metal-highlight),
                0 2px 5px rgba(0,0,0,0.3);
            filter: brightness(0.7); /* Darker on press */
            border-top-color: var(--metal-border-dark);
            border-bottom-color: var(--metal-border-light);
            border-left-color: var(--metal-border-dark);
            border-right-color: var(--metal-border-light);
        }
        .os-window-controls .control-button .icon-image {
            width: 0.9em;
            height: auto; /* Ensure aspect ratio */
            object-fit: contain; /* Prevent stretching */
            filter: drop-shadow(0 0 8px rgba(0, 255, 65, 0.8)); /* 修正：确保控制按钮图标有绿色光晕 */
        }
        .os-window-controls .control-button:not(.close):hover .icon-image { /* Restore green glow for non-close buttons on hover */
            filter: drop-shadow(0 0 5px var(--matrix-green-light));
        }


        /* 窗口内容区 - 黑色玻璃显示屏，绿色文字 */
        .os-window-content {
            flex-grow: 1;
            padding: 25px;
            background-color: rgba(0, 0, 0, 0.85); /* 黑色背景，略微不透明 */
            color: var(--matrix-green-light); /* 黑色背景上的文字为绿色 */
            font-size: 1rem;
            line-height: 1.7;
            overflow: auto;
            border-radius: 0 0 12px 12px; /* 底部圆角 */
            text-shadow: 0 0 1px rgba(0, 255, 65, 0.2); /* 绿色文字的微弱光晕 */
            /* Added subtle internal reflection */
            background-image: linear-gradient(to top right, rgba(255, 255, 255, 0.02) 0%, transparent 50%),
                              radial-gradient(circle at 5% 5%, rgba(255, 255, 255, 0.02) 0%, transparent 30%);
            box-shadow: inset 0 0 10px rgba(0, 255, 65, 0.1); /* Inner green glow for content area */
        }

        /* Markdown内容区专属样式 - 针对 Matrix 可读性优化 */
        .os-window-content .markdown-content h1 { font-size: 2.4em; margin-bottom: 0.7em; color: var(--matrix-green-light); border-bottom: 3px solid var(--matrix-green-dark); padding-bottom: 0.5em; text-shadow: var(--text-glow-matrix); }
        .os-window-content .markdown-content h2 { font-size: 2em; margin-bottom: 0.6em; color: var(--matrix-green-light); text-shadow: 0 0 1px rgba(0, 255, 65, 0.3); }
        .os-window-content .markdown-content h3 { font-size: 1.6em; margin-bottom: 0.5em; color: var(--matrix-green-light); text-shadow: 0 0 1px rgba(0, 255, 65, 0.2); }
        .os-window-content .markdown-content p { margin-bottom: 1.4em; opacity: 1; color: var(--matrix-green-light); text-shadow: 0 0 0.5px rgba(0, 255, 65, 0.1); }
        .os-window-content .markdown-content ul, .os-window-content .markdown-content ol { margin-left: 2.5em; margin-bottom: 1.4em; list-style-type: disc; opacity: 1; color: var(--matrix-green-light); text-shadow: 0 0 0.5px rgba(0, 255, 65, 0.1); }
        .os-window-content .markdown-content li { margin-bottom: 0.8em; }
        .os-window-content .markdown-content strong { font-weight: bold; color: var(--matrix-green-light); text-shadow: var(--text-glow-matrix); }
        .os-window-content .markdown-content em { font-style: italic; opacity: 1; color: var(--matrix-green-light); text-shadow: 0 0 0.5px rgba(0, 255, 65, 0.05); }
        .os-window-content .markdown-content a {
            color: var(--matrix-green-light);
            text-decoration: underline;
            text-shadow: var(--text-glow-matrix);
            transition: color 0.2s ease;
        }
        .os-window-content .markdown-content a:hover {
            color: white;
            text-shadow: 0 0 8px white;
        }
        .os-window-content .markdown-content code { background-color: #1a1a1a; padding: 0.3em 0.6em; border-radius: 4px; font-family: monospace; font-size: 0.95em; border: 1px solid var(--matrix-dark-grey); color: var(--matrix-green-light); text-shadow: 0 0 1px rgba(0,255,65,0.2); }
        .os-window-content .markdown-content pre { background-color: #111111; padding: 1.5em; border-radius: 8px; overflow-x: auto; margin-bottom: 1.8em; border: 1px solid var(--matrix-dark-grey); box-shadow: inset 0 0 5px rgba(0,255,65,0.1); color: var(--matrix-green-light); text-shadow: 0 0 1px rgba(0,255,65,0.2); }
        .os-window-content .markdown-content blockquote { border-left: 8px solid var(--matrix-green-light); padding-left: 2em; margin-left: 0; opacity: 1; background-color: #0d0d0d; border-radius: 8px; padding-top: 1em; padding-bottom: 1em; color: var(--matrix-green-light); text-shadow: 0 0 0.5px rgba(0,255,65,0.1); }


        /* 窗口弹出动画 */
        @keyframes windowPopIn {
            from {
                opacity: 0;
                transform: scale(0.9) translateY(20px);
            }
            to {
                opacity: 1;
                transform: scale(1) translateY(0);
            }
        }

        /* 音乐播放器皮肤 - 整体拟物化MP3样式 */
        .music-player-standalone {
            position: absolute;
            background-color: #1a1a1a; /* Dark background for MP3 player body */
            border: 2px solid #555;
            border-radius: 20px; /* Slightly larger border-radius for softer look */
            padding: 25px; /* Increased padding */
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 20px; /* Increased gap */
            box-shadow: 
                inset 0 0 15px rgba(0,0,0,0.6), /* Deeper inner shadow */
                0 8px 25px rgba(0,255,65,0.3); /* Stronger outer glow */
            min-width: 340px; /* Adjusted min-width */
            min-height: 480px; /* Adjusted min-height */
            z-index: 5; /* Ensure it layers correctly */
            animation: windowPopIn 0.3s ease-out forwards; /* Reuse window pop-in animation */
            
            /* Enhanced metal texture on the player body itself */
            background-image: 
                linear-gradient(135deg, var(--metal-color-mid) 0%, var(--metal-color-end) 100%),
                repeating-linear-gradient(45deg, rgba(255,255,255,0.02) 0%, rgba(255,255,255,0.02) 2px, transparent 2px, transparent 4px); /* Subtle brushed metal lines */
            background-blend-mode: overlay; /* Blend brushed lines with base gradient */
            border: 3px solid var(--metal-border-light); /* Thicker, brighter border */
            box-shadow: 
                inset 0 1px 5px var(--metal-highlight), 
                inset 0 -5px 10px var(--metal-inner-shadow),
                0 10px 30px rgba(0, 255, 65, 0.4), /* Even stronger outer glow */
                0 0 5px rgba(0, 255, 65, 0.2); /* Subtle green edge glow */
            
            .drag-handle {
                width: 100%;
                height: 35px; /* Slightly taller */
                background: linear-gradient(to right, var(--metal-color-mid), var(--metal-color-start), var(--metal-color-mid)); /* Brighter handle */
                border-radius: 10px 10px 0 0; /* Adjusted radius */
                cursor: grab;
                margin-top: -25px; /* Pull it slightly inside the padding */
                margin-bottom: 15px; /* Increased margin */
                box-shadow: 
                    inset 0 1px 4px var(--metal-highlight), 
                    inset 0 -2px 6px var(--metal-inner-shadow),
                    0 2px 8px var(--metal-shadow);
                display: flex;
                align-items: center;
                justify-content: flex-end;
                padding-right: 15px; /* Increased padding */
                position: relative;
                z-index: 10;
                overflow: hidden; /* For inner texture */
                background-image: repeating-linear-gradient(90deg, transparent, transparent 1px, var(--metal-bg) 1px, var(--metal-bg) 2px); /* Metal texture */
                background-blend-mode: overlay;
            }
            .drag-handle .close-button-custom {
                width: 25px; /* Slightly larger */
                height: 25px; /* Slightly larger */
                background-color: #DD0000; /* Brighter red */
                border-radius: 50%;
                display: flex;
                align-items: center;
                justify-content: center;
                color: white;
                font-size: 1.2rem; /* Larger icon */
                font-weight: bold;
                cursor: pointer;
                transition: background-color 0.2s ease, box-shadow 0.2s ease, transform 0.1s ease;
                box-shadow: 0 3px 8px rgba(0,0,0,0.5); /* Deeper shadow */
                border: 1px solid rgba(255,255,255,0.3); /* Subtle white border */
            }
            .drag-handle .close-button-custom:hover {
                background-color: #FF2222;
                box-shadow: 0 0 12px rgba(255,0,0,0.8);
                transform: scale(1.1);
            }
            .drag-handle .close-button-custom:active {
                background-color: #AA0000;
                box-shadow: inset 0 2px 5px rgba(0,0,0,0.5);
                transform: scale(0.95);
            }
        }

        .mp3-display {
            width: calc(100% - 20px); /* Adjust width to fit padding */
            height: 90px; /* Slightly taller display */
            background-color: #000; /* Black display screen */
            border-radius: 10px; /* Slightly larger radius */
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.4rem; /* Larger font size */
            color: var(--matrix-green-light); /* Green text on display */
            overflow: hidden; /* For scrolling text */
            position: relative;
            box-shadow: 
                inset 0 0 20px rgba(0, 255, 65, 0.3), /* Stronger inner green glow */
                0 0 10px rgba(0,0,0,0.5); /* Outer dark shadow for depth */
            border: 2px solid rgba(0,255,65,0.4); /* Green border for display */
            padding: 0 10px; /* Add padding for scrolling text */
        }

        .mp3-song-title {
            white-space: nowrap;
            /* animation: scrollText 10s linear infinite; */ /* Managed by JS now */
            padding: 0 100%; /* Ensure text scrolls completely off screen */
            text-shadow: 0 0 8px var(--matrix-green-light); /* Stronger text glow */
            position: absolute;
            left: 0;
        }

        @keyframes scrollText {
            0% { transform: translateX(100%); }
            100% { transform: translateX(-100%); }
        }

        .mp3-progress-container {
            width: 100%;
            height: 10px; /* Slightly thicker progress bar */
            background-color: #555;
            border-radius: 5px; /* Matched radius */
            cursor: pointer;
            position: relative;
            box-shadow: 
                inset 0 1px 3px rgba(0,0,0,0.5), /* Inner shadow for depth */
                0 1px 0 rgba(255,255,255,0.1); /* Subtle highlight */
        }

        .mp3-progress-bar {
            height: 100%;
            background-color: var(--matrix-green-light);
            border-radius: 5px;
            box-shadow: 0 0 8px var(--matrix-green-light); /* Green glow for the bar */
        }

        .mp3-controls {
            display: flex;
            gap: 20px; /* Increased gap */
        }

        .mp3-control-button {
            width: 55px; /* Larger buttons */
            height: 55px; /* Larger buttons */
            border-radius: 50%;
            background: linear-gradient(to bottom, var(--metal-color-start) 0%, var(--metal-color-mid) 50%, var(--metal-color-end) 100%);
            border: 3px solid var(--metal-border-light); /* Thicker, brighter border */
            box-shadow: 
                inset 0 2px 5px var(--metal-highlight), /* Stronger inner highlight */
                inset 0 -4px 8px var(--metal-inner-shadow), /* Stronger inner shadow */
                0 5px 15px var(--metal-shadow); /* More pronounced external shadow */
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.2s ease;
            position: relative; /* For inner texture */
            overflow: hidden;
            background-image: repeating-linear-gradient(45deg, rgba(255,255,255,0.03) 0%, rgba(255,255,255,0.03) 2px, transparent 2px, transparent 4px); /* Subtle brushed lines */
            background-blend-mode: overlay; /* Blend with base gradient */
        }
        .mp3-control-button:hover {
            transform: translateY(-3px); /* More pronounced lift */
            filter: brightness(1.2);
            box-shadow: 
                inset 0 2px 6px var(--metal-highlight), 
                inset 0 -5px 10px var(--metal-inner-shadow),
                0 8px 20px rgba(0,255,65,0.6); /* Stronger green glow on hover */
            border-color: var(--matrix-green-light); /* Green border on hover */
        }
        .mp3-control-button:active {
            transform: translateY(0);
            box-shadow: 
                inset 0 5px 12px var(--metal-shadow), /* Even deeper inset shadow */
                inset 0 -2px 5px var(--metal-highlight),
                0 0 15px rgba(0,255,65,0.8); /* Intense green glow on active */
            filter: brightness(0.7);
            background: linear-gradient(to bottom, var(--metal-color-end) 0%, var(--metal-color-mid) 50%, var(--metal-color-start) 100%); /* Pressed state gradient */
            border-top-color: var(--metal-border-dark); /* Invert borders for pressed look */
            border-bottom-color: var(--metal-border-light);
            border-left-color: var(--metal-border-dark);
            border-right-color: var(--metal-border-light);
        }
        .mp3-control-button .icon-image {
            width: 1.8em; /* Larger icons */
            height: auto;
            object-fit: contain;
            filter: drop-shadow(0 0 10px var(--matrix-green-light)); /* Stronger icon glow */
        }

        .mp3-playlist {
            width: 100%;
            max-height: 180px; /* Increased max height */
            overflow-y: auto;
            background-color: rgba(0,0,0,0.7); /* Slightly more opaque */
            border-radius: 10px; /* Larger radius */
            padding: 15px; /* Increased padding */
            color: var(--matrix-green-light);
            font-size: 1em; /* Slightly larger font */
            text-shadow: 0 0 4px rgba(0,255,65,0.4); /* Stronger text shadow */
            box-shadow: inset 0 0 10px rgba(0,255,65,0.2); /* Stronger inner glow */
            border: 1px solid rgba(0,255,65,0.5); /* Border for playlist */
        }
        .mp3-playlist ul {
            list-style: none;
            padding: 0;
            margin: 0;
        }
        .mp3-playlist li {
            padding: 8px 0; /* More padding */
            cursor: pointer;
            transition: color 0.1s ease, text-shadow 0.1s ease, background-color 0.1s ease;
            border-bottom: 1px dashed rgba(0,255,65,0.2); /* Dashed separator */
            last-child: border-bottom: none; /* No border for last item */
        }
        .mp3-playlist li:hover {
            color: white;
            text-shadow: 0 0 8px white;
            background-color: rgba(0,255,65,0.1); /* Subtle highlight on hover */
        }
        .mp3-playlist li.active-song {
            color: var(--matrix-green-light);
            font-weight: bold;
            text-shadow: var(--text-glow-matrix);
            background-color: rgba(0,255,65,0.2); /* Stronger active background */
            border-radius: 4px;
        }

        .mp3-mode-buttons {
            display: flex;
            gap: 12px; /* Adjusted gap */
            margin-top: 15px; /* Adjusted margin */
        }
        .mp3-mode-button {
            padding: 10px 16px; /* Larger padding */
            border-radius: 8px; /* Larger radius */
            background-color: var(--matrix-dark-grey);
            color: var(--matrix-green-light);
            border: 2px solid var(--matrix-green-dark); /* Thicker border */
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 0.9em; /* Slightly larger font */
            text-shadow: 0 0 5px rgba(0,255,65,0.4); /* Stronger text shadow */
            box-shadow: inset 0 0 5px rgba(0,0,0,0.3); /* Inner shadow for depth */
            position: relative;
            overflow: hidden;
            background-image: repeating-linear-gradient(45deg, rgba(255,255,255,0.01) 0%, rgba(255,255,255,0.01) 1px, transparent 1px, transparent 2px); /* Subtle texture */
            background-blend-mode: overlay;
        }
        .mp3-mode-button:hover {
            background-color: rgba(0,255,65,0.3);
            box-shadow: 0 0 10px rgba(0,255,65,0.7), inset 0 0 8px rgba(0,255,65,0.3);
        }
        .mp3-mode-button.active-mode {
            background-color: var(--matrix-green-dark);
            color: white;
            box-shadow: var(--glow-matrix), inset 0 0 10px rgba(0,0,0,0.6);
        }

        /* 文件夹样式 */
        .folder-content-wrapper { /* Wrapper to contain items and allow flex layout for inner content */
            display: flex;
            flex-direction: column;
            gap: 12px; /* Increased gap */
            padding: 18px; /* Increased padding */
            height: 100%; /* Ensure it fills parent height for scrollbar */
            overflow-y: auto; /* Enable scrolling */
        }
        .folder-item {
            display: flex;
            align-items: center;
            gap: 12px; /* Increased gap */
            padding: 10px; /* Increased padding */
            border-radius: 10px; /* Larger border radius */
            cursor: pointer;
            transition: background-color 0.15s ease, border-color 0.15s ease, box-shadow 0.15s ease;
            user-select: none;
            position: relative; /* For right-click menu positioning */
            border: 2px solid transparent; /* default transparent border */
            background-color: rgba(0, 0, 0, 0.4); /* Subtle background for items */
            box-shadow: inset 0 0 5px rgba(0, 255, 65, 0.1); /* Subtle inner glow */
        }
        .folder-item:hover {
            background-color: rgba(0, 255, 65, 0.15); /* Stronger hover background */
            border-color: rgba(0, 255, 65, 0.5); /* More prominent border on hover */
            box-shadow: inset 0 0 8px rgba(0, 255, 65, 0.3), 0 0 10px rgba(0, 255, 65, 0.4); /* Stronger glow on hover */
        }
        .folder-item.selected {
            background-color: rgba(0, 255, 65, 0.3); /* Stronger selected background */
            border: 2px solid var(--matrix-green-light); /* Solid green border when selected */
            box-shadow: inset 0 0 10px rgba(0, 255, 65, 0.4), 0 0 15px rgba(0, 255, 65, 0.6); /* Intense glow when selected */
        }
        .folder-item .icon-image {
            width: 28px; /* Slightly larger icon */
            height: auto;
            object-fit: contain;
            filter: drop-shadow(0 0 8px rgba(0, 255, 65, 0.7)); /* Stronger icon glow */
        }
        .folder-item-name {
            flex-grow: 1;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            font-size: 1.05rem; /* Slightly larger font */
            text-shadow: 0 0 2px rgba(0,255,65,0.2); /* Subtle text glow */
        }

        /* 右键菜单样式 - 更加玻璃化和清晰 */
        .context-menu {
            position: fixed; /* Changed to fixed for correct positioning over everything */
            background-color: rgba(0, 0, 0, 0.95); /* More opaque */
            border: 2px solid var(--matrix-green-light); /* Brighter green border */
            border-radius: 10px; /* Larger radius */
            box-shadow: 0 6px 20px rgba(0, 255, 65, 0.6); /* Stronger glow */
            padding: 10px 0; /* Increased padding */
            z-index: 10000; /* Higher than any window */
            display: none; /* Hidden by default */
            flex-direction: column;
            min-width: 180px; /* Wider menu */
            backdrop-filter: blur(var(--glass-blur)); /* Add blur to menu */
            -webkit-backdrop-filter: blur(var(--glass-blur));
            background-image: linear-gradient(to bottom right, rgba(255, 255, 255, 0.05) 0%, transparent 60%); /* Subtle reflection */
        }
        .context-menu-item {
            padding: 10px 20px; /* Increased padding */
            color: var(--matrix-green-light);
            cursor: pointer;
            transition: background-color 0.15s ease, color 0.15s ease, text-shadow 0.15s ease;
            display: flex; /* For icon alignment */
            align-items: center;
            gap: 10px; /* Increased gap */
            font-size: 1.05rem; /* Slightly larger font */
            text-shadow: 0 0 3px rgba(0,255,65,0.3); /* Subtle text glow */
        }
        .context-menu-item:hover {
            background-color: rgba(0, 255, 65, 0.3); /* Stronger hover background */
            color: white;
            text-shadow: 0 0 8px white;
        }
        .context-menu-separator {
            height: 2px; /* Thicker separator */
            background-color: var(--matrix-dark-grey);
            margin: 8px 0; /* Increased margin */
            box-shadow: inset 0 1px 2px rgba(0,0,0,0.5); /* Shadow for separator */
        }

        /* ---------------------------------------------------- */
        /* 作品集网格专属样式 */
        .works-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
            gap: 25px;
            padding: 20px;
        }

        .work-card {
            background: var(--glass-bg); /* Use glass background */
            border: 2px solid var(--glass-border);
            border-radius: 12px;
            overflow: hidden;
            cursor: pointer;
            transition: all 0.25s ease-in-out, filter 0.25s ease, box-shadow 0.25s ease;
            box-shadow: var(--glass-glow), var(--glass-inset-shadow);
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
            padding-bottom: 15px;
            position: relative;
            overflow: hidden;
            /* Added subtle glass reflection */
            background-image: linear-gradient(to top right, rgba(255, 255, 255, 0.05) 0%, transparent 50%),
                              radial-gradient(circle at 10% 10%, rgba(255, 255, 255, 0.05) 0%, transparent 30%);
        }
        .work-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle at top left, rgba(0,255,65,0.1) 0%, transparent 55%);
            border-radius: inherit;
            pointer-events: none;
        }


        .work-card:hover {
            transform: translateY(-10px) scale(1.05);
            box-shadow: 0 8px 25px var(--glow-matrix), var(--glass-inset-shadow);
            border-color: var(--matrix-green-light);
            filter: brightness(1.2);
            background: rgba(0, 0, 0, 0.9);
        }

        .work-card img {
            width: 100%;
            height: 180px;
            object-fit: cover;
            border-radius: 10px 10px 0 0;
            filter: brightness(0.8);
            transition: filter 0.2s ease;
        }

        .work-card:hover img {
            filter: brightness(1.0);
        }

        .work-card-title {
            font-size: 1.1rem;
            font-weight: bold;
            margin-top: 15px;
            color: var(--matrix-green-light);
            text-shadow: var(--text-glow-matrix);
        }

        .work-card-category {
            font-size: 0.9rem;
            color: rgba(0, 255, 65, 0.7);
            opacity: 0.95;
            margin-top: 6px;
        }

        /* 作品详情窗口专属样式 */
        .work-detail-content {
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .work-detail-content .gallery-main-image-container {
            position: relative;
            width: 100%;
            max-width: 700px;
            margin-bottom: 25px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
            border-radius: 8px;
            overflow: hidden;
            border: 3px solid var(--glass-border);
        }

        .work-detail-content .gallery-main-image {
            width: 100%;
            height: auto;
            display: block;
            border-radius: 6px;
        }

        .work-detail-content .gallery-nav-button {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            background: rgba(0, 0, 0, 0.8);
            color: var(--matrix-green-light);
            border: 2px solid var(--glass-border);
            padding: 15px;
            cursor: pointer;
            font-size: 2rem;
            border-radius: 50%;
            transition: background-color 0.25s ease, filter 0.25s ease, box-shadow 0.25s ease;
            z-index: 2;
            box-shadow: 0 6px 15px rgba(0,0,0,0.6), var(--glass-glow);
        }

        .work-detail-content .gallery-nav-button:hover {
            background: rgba(0, 0, 0, 0.95);
            filter: brightness(1.4);
            box-shadow: 0 8px 20px rgba(0,0,0,0.8), var(--glow-matrix);
        }
        .work-detail-content .gallery-nav-button .icon-image {
            width: 2em;
            height: 2em;
            filter: drop-shadow(0 0 8px rgba(0, 255, 65, 0.7));
        }

        .work-detail-content .gallery-nav-button.prev {
            left: 20px;
        }

        .work-detail-content .gallery-nav-button.next {
            right: 20px;
        }

        .work-detail-content .gallery-thumbnails {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 15px;
            margin-top: 20px;
            margin-bottom: 25px;
        }

        .work-detail-content .gallery-thumbnail {
            width: 100px;
            height: 80px;
            object-fit: cover;
            border-radius: 8px;
            border: 3px solid transparent;
            cursor: pointer;
            transition: border-color 0.25s ease, transform 0.15s ease, filter 0.25s ease, box-shadow 0.25s ease;
            box-shadow: 0 4px 12px rgba(0,0,0,0.4);
        }

        .work-detail-content .gallery-thumbnail.active {
            border-color: var(--matrix-green-light);
            transform: scale(1.15);
            box-shadow: var(--glass-glow);
        }
        .work-detail-content .gallery-thumbnail:hover {
            filter: brightness(1.2);
            box-shadow: var(--glass-glow);
        }

        .work-detail-content h3 {
            font-size: 2rem;
            font-weight: bold;
            color: var(--matrix-green-light);
            margin-bottom: 15px;
            text-align: center;
            text-shadow: var(--text-glow-matrix);
        }
        .work-detail-content p {
            margin-bottom: 15px;
            text-align: justify;
            font-size: 1rem;
            color: var(--matrix-green-light);
        }
        .work-detail-content .category-tag {
            display: inline-block;
            background-color: rgba(0, 255, 65, 0.3);
            border: 1px solid var(--matrix-green-dark);
            border-radius: 6px;
            padding: 6px 12px;
            font-size: 0.9rem;
            color: var(--matrix-green-light);
            margin-top: 15px;
            text-shadow: 0 0 5px rgba(0,0,0,0.6);
            box-shadow: inset 0 0 8px rgba(0,255,65,0.2);
        }
        .service-category-card {
            background: var(--glass-bg); /* Use glass background */
            border: 2px solid var(--glass-border);
            border-radius: 12px;
            overflow: hidden;
            cursor: pointer;
            transition: all 0.25s ease-in-out, filter 0.25s ease, box-shadow 0.25s ease;
            box-shadow: var(--glass-glow), var(--glass-inset-shadow);
            padding: 20px;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            min-height: 120px;
            position: relative;
            overflow: hidden;
            /* Added subtle glass reflection */
            background-image: linear-gradient(to top right, rgba(255, 255, 255, 0.05) 0%, transparent 50%),
                              radial-gradient(circle at 10% 10%, rgba(255, 255, 255, 0.05) 0%, transparent 30%);
        }
        .service-category-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle at top left, rgba(0,255,65,0.2) 0%, transparent 60%);
            border-radius: inherit;
            pointer-events: none;
        }
        .service-category-card:hover {
            transform: translateY(-8px) scale(1.03);
            box-shadow: 0 10px 25px var(--glow-matrix), var(--glass-inset-shadow);
            border-color: var(--matrix-green-light);
            filter: brightness(1.2);
            background: rgba(0, 0, 0, 0.9);
        }

        /* 任务栏最小化窗口图标 - 更玻璃质感 */
        .taskbar-minimized-icon {
            background: var(--glass-bg); /* Use glass background */
            border: 1px solid var(--glass-border);
            border-radius: 8px;
            padding: 8px 12px;
            margin: 0 5px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            color: var(--matrix-green-light);
            font-size: 0.9rem;
            box-shadow: var(--glass-inset-shadow), 0 2px 8px rgba(0,0,0,0.3);
            transition: all 0.25s ease;
            white-space: nowrap;
            max-width: 160px;
            overflow: hidden;
            text-overflow: ellipsis;
            position: relative;
            overflow: hidden;
            /* Added subtle glass reflection */
            background-image: linear-gradient(to top right, rgba(255, 255, 255, 0.03) 0%, transparent 50%);
        }
        .taskbar-minimized-icon::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle at top left, rgba(0,255,65,0.2) 0%, transparent 60%);
            border-radius: inherit;
            pointer-events: none;
        }


        .taskbar-minimized-icon:hover {
            background: rgba(0, 0, 0, 0.9);
            transform: translateY(-4px);
            box-shadow: var(--glass-glow), inset 0 -2px 10px rgba(0,0,0,0.6);
        }

        /* 激活状态下的任务栏图标样式 */
        .taskbar-minimized-icon.active {
            background: rgba(0, 0, 0, 0.95);
            border-color: var(--matrix-green-light);
            box-shadow: var(--glass-glow), inset 0 2px 8px rgba(0,0,0,0.7), 0 0 25px rgba(0, 255, 65, 0.9); /* Stronger outer glow */
            transform: translateY(0);
        }
        .taskbar-minimized-icon.active::before {
            background: radial-gradient(circle at top left, rgba(0,255,65,0.3) 0%, transparent 60%);
        }


        .taskbar-minimized-icon .icon-image {
            width: 1.2em;
            height: auto; /* Ensure aspect ratio */
            object-fit: contain; /* Prevent stretching */
            filter: drop-shadow(0 0 8px rgba(0, 255, 65, 0.8));
            transition: filter 0.2s ease;
        }
        .taskbar-minimized-icon.active .icon-image {
            filter: brightness(2) drop-shadow(0 0 15px rgba(0,255,65,1)); /* Even stronger icon glow */
        }

        /* 加载动画样式 */
        .loading-spinner {
            border: 5px solid rgba(0, 255, 65, 0.2);
            border-top: 5px solid var(--matrix-green-light);
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 0.8s linear infinite;
            margin: 25px auto;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* 语言选择子菜单 */
        .start-menu-submenu {
            position: absolute;
            left: 100%;
            top: 0;
            width: 250px;
            background: var(--glass-bg); /* Use glass background */
            backdrop-filter: blur(var(--glass-blur)); /* 使用变量控制模糊度 */
            -webkit-backdrop-filter: blur(var(--glass-blur));
            border: 2px solid var(--glass-border);
            border-radius: 12px;
            box-shadow: var(--glass-glow), var(--glass-inset-shadow);
            padding: 15px;
            display: none;
            flex-direction: column;
            z-index: 101;
            /* Added subtle glass reflection */
            background-image: linear-gradient(to top right, rgba(255, 255, 255, 0.05) 0%, transparent 50%);
        }
        .start-menu-item.has-submenu:hover .start-menu-submenu {
            display: flex;
        }

        /* 开关样式 - 更 Matrix 风格 */
        .toggle-switch {
            position: relative;
            display: inline-block;
            width: 70px;
            height: 40px;
        }

        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .toggle-slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: var(--matrix-dark-grey);
            -webkit-transition: .4s;
            transition: .4s;
            border-radius: 40px;
            box-shadow: inset 0 0 6px var(--metal-shadow);
            border: 2px solid var(--metal-border-dark);
        }

        .toggle-slider:before {
            position: absolute;
            content: "";
            height: 32px;
            width: 32px;
            left: 4px;
            bottom: 4px;
            /* Adjusted to use metal colors */
            background: linear-gradient(to bottom, var(--metal-color-mid) 0%, var(--metal-color-end) 100%); 
            -webkit-transition: .4s;
            transition: .4s;
            border-radius: 50%;
            box-shadow: 0 3px 8px var(--metal-shadow), inset 0 1px 4px var(--metal-highlight);
        }

        input:checked + .toggle-slider {
            background: linear-gradient(to right, var(--matrix-green-light) 0%, var(--matrix-green-dark) 100%);
            border-color: var(--matrix-green-dark);
        }

        input:focus + .toggle-slider {
            box-shadow: 0 0 1px var(--matrix-green-light), inset 0 0 8px var(--metal-shadow);
        }

        input:checked + .toggle-slider:before {
            -webkit-transform: translateX(30px);
            -ms-transform: translateX(30px);
            transform: translateX(30px);
        }

        /* 圆形滑块 */
        .toggle-slider.round {
            border-radius: 40px;
        }

        .toggle-slider.round:before {
            border-radius: 50%;
        }

        /* 自定义滚动条样式（Webkit浏览器如Chrome/Safari） */
        /* 滚动条轨道 */
        ::-webkit-scrollbar {
            width: 20px; /* Wider scrollbar */
        }

        /* 滚动条滑块 */
        ::-webkit-scrollbar-thumb {
            background: linear-gradient(to bottom, var(--metal-color-start), var(--metal-color-mid), var(--metal-color-end)); /* Metal gradient */
            border-radius: 10px;
            border: 4px solid var(--metal-border-dark); /* Darker border for depth */
            transition: background 0.2s ease, box-shadow 0.2s ease, border-color 0.2s ease;
            box-shadow: 
                inset 0 1px 3px var(--metal-highlight), 
                inset 0 -2px 5px var(--metal-inner-shadow),
                0 2px 8px var(--metal-shadow); /* More prominent shadow */
        }

        /* 滑块悬停时 */
        ::-webkit-scrollbar-thumb:hover {
            background: linear-gradient(to top, var(--metal-color-start), var(--metal-color-mid), var(--metal-color-end)); /* Reverse gradient on hover */
            box-shadow: 
                inset 0 1px 4px var(--metal-highlight), 
                inset 0 -3px 6px var(--metal-inner-shadow),
                0 4px 12px rgba(0,255,65,0.6); /* Green glow on hover */
            border-color: var(--matrix-green-light); /* Green border on hover */
        }

        /* 轨道背景 */
        ::-webkit-scrollbar-track {
            background: rgba(0, 0, 0, 0.5);
            border-radius: 10px;
            border: 1px solid var(--matrix-dark-grey); /* Subtle border for track */
            box-shadow: inset 0 0 5px rgba(0,0,0,0.3);
        }

        /* 滚动条按钮（箭头） - 更突出更光泽 */
        .os-window ::-webkit-scrollbar-button {
            background: linear-gradient(to bottom, var(--metal-color-start) 0%, var(--metal-color-mid) 50%, var(--metal-color-end) 100%);
            border-radius: 50%;
            height: 28px;
            width: 28px;
            display: block;
            border: 2px solid var(--metal-border-light); /* 顶部高光 */
            border-bottom-color: var(--metal-border-dark); /* 底部阴影 */
            border-right-color: var(--metal-border-dark);
            box-shadow: 
                inset 0 1px 2px var(--metal-highlight), 
                inset 0 -2px 5px var(--metal-inner-shadow),
                0 2px 10px var(--metal-shadow);
            transition: background-color 0.15s ease, transform 0.08s ease, box-shadow 0.15s ease;
            color: var(--metal-text-color); /* Make arrow icons dark grey, now uses variable */
        }
        
        .os-window ::-webkit-scrollbar-button:hover {
            background: linear-gradient(to top, var(--metal-color-start) 0%, var(--metal-color-mid) 50%, var(--metal-color-end) 100%);
            transform: scale(1.15);
            filter: brightness(1.3);
            box-shadow: 
                inset 0 1px 3px var(--metal-highlight), 
                inset 0 -3px 6px var(--metal-inner-shadow),
                0 4px 15px var(--metal-shadow);
        }

        .os-window ::-webkit-scrollbar-button:active {
            background: linear-gradient(to bottom, var(--metal-color-end) 0%, var(--metal-color-mid) 50%, var(--metal-color-start) 100%);
            transform: scale(0.9);
            opacity: 1;
            box-shadow: 
                inset 0 3px 10px var(--metal-shadow), 
                inset 0 -1px 3px var(--metal-highlight),
                0 0 10px rgba(0,255,65,0.7);
            filter: brightness(0.8);
            border-top-color: var(--metal-border-dark);
            border-bottom-color: var(--metal-border-light);
            border-left-color: var(--metal-border-dark);
            border-right-color: var(--metal-border-light);
        }

        /* Firefox滚动条样式 */
        html {
            scrollbar-width: thin;
            scrollbar-color: var(--matrix-green-light) rgba(0, 0, 0, 0.5);
        }

        /* --- 移动端适配 (max-width: 768px) --- */
        @media (max-width: 768px) {
            .os-window {
                min-width: 90vw; /* 调整最小宽度 */
                min-height: 50vh; /* 调整最小高度 */
                width: 95vw !important; /* 强制窗口宽度为视口宽度的95% */
                height: 80vh !important; /* 强制窗口高度为视口高度的80% */
                left: 2.5vw !important; /* 居中 */
                top: 5vh !important; /* 顶部留白 */
                transform: none !important; /* 移除任何transform，确保位置正确 */
                border-radius: 8px; /* 移动端可以小一点的圆角 */
                box-shadow: 0 5px 20px rgba(0,0,0,0.5), inset 0 0 15px rgba(0,255,65,0.2);
            }

            .os-window.maximized {
                border-radius: 0; /* 最大化时无圆角 */
            }

            .start-menu {
                width: 95vw; /* 开始菜单占据大部分宽度 */
                left: 2.5vw; /* 居中 */
                padding: 15px; /* 调整内边距 */
                border-radius: 12px;
                max-height: calc(100% - var(--taskbar-height) - 20px); /* 适应移动端高度 */
            }

            .desktop-icon {
                width: 80px; /* 减小桌面图标宽度 */
                padding: 5px;
            }

            .desktop-icon .icon-image {
                width: 50px; /* 减小图标图片尺寸 */
                height: auto; /* Ensure aspect ratio */
                object-fit: contain; /* Prevent stretching */
            }

            .desktop-icon-label {
                font-size: 0.8rem; /* 减小标签字体大小 */
                margin-top: 5px;
            }

            .taskbar {
                height: 44px; /* 任务栏高度可以略小 */
            }

            .start-button {
                width: 40px; /* 开始按钮略小 */
                height: 40px;
            }

            .start-button .icon-image {
                width: 1.4em; /* Slightly smaller for mobile */
                height: auto; /* Ensure aspect ratio */
                object-fit: contain; /* Prevent stretching */
            }

            .system-tray-display .icon-image {
                font-size: 1rem; /* 系统托盘图标略小 */
                padding: 4px;
            }

            #current-time {
                font-size: 0.8rem; /* 时间字体略小 */
            }

            .os-window-content {
                padding: 15px; /* 窗口内容区内边距调整 */
            }

            .os-window-content .markdown-content h1 { font-size: 2em; }
            .os-window-content .markdown-content h2 { font-size: 1.8em; }
            .os-window-content .markdown-content h3 { font-size: 1.4em; }
            .os-window-content .markdown-content p { font-size: 0.95rem; }

            .works-grid {
                grid-template-columns: repeat(auto-fill, minmax(140px, 1f r)); /* 作品集网格列数调整 */
                gap: 15px;
                padding: 10px;
            }

            .work-card img {
                height: 120px; /* 作品卡片图片高度调整 */
            }

            .work-card-title {
                font-size: 1rem;
            }
            .work-card-category {
                font-size: 0.8rem;
            }
            /* Music Player adjustments for mobile */
            .music-player-standalone {
                min-width: unset;
                width: 95vw !important;
                left: 2.5vw !important;
                min-height: unset;
                height: auto !important; /* Allow height to adjust */
            }
            .mp3-player-skin {
                padding: 15px;
                gap: 10px;
            }
            .mp3-display {
                height: 60px;
                font-size: 1rem;
            }
            .mp3-control-button {
                width: 40px;
                height: 40px;
            }
            .mp3-control-button .icon-image {
                width: 1.2em;
            }
        }

        /* 窗口状态栏 - 高度拟物化的金属边框 */
        .os-window-status-bar {
            padding: 8px 18px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 0.85rem;
            background: linear-gradient(to bottom, var(--metal-color-start), var(--metal-color-mid), var(--metal-color-end));
            backdrop-filter: blur(var(--glass-blur));
            -webkit-backdrop-filter: blur(var(--glass-blur));
            border-top: 2px solid var(--metal-border-light); /* 顶部高光 */
            border-bottom: 1px solid var(--metal-border-dark); /* 底部阴影 */
            border-radius: 0 0 12px 12px;
            color: var(--metal-text-color); /* 文字颜色改为深灰色 */
            text-shadow: none; /* 移除文字阴影 */
            box-shadow: 
                inset 0 1px 2px var(--metal-highlight), 
                inset 0 -2px 5px var(--metal-inner-shadow),
                0 2px 5px var(--metal-shadow);
            overflow: hidden;
        }
        .os-window-status-bar::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: repeating-linear-gradient(90deg, transparent, transparent 1px, var(--metal-bg) 1px, var(--metal-bg) 2px); /* 细微的金属拉丝纹理 */
            pointer-events: none;
            opacity: 0.8;
        }

        .os-window-status-bar .status-text {
            color: var(--metal-text-color); /* 文字颜色改为深灰色 */
            opacity: 0.9;
            font-weight: 500;
        }

        .os-window-status-bar .system-branding-text {
            color: var(--metal-text-color); /* 文字颜色改为深灰色 */
            font-weight: bold;
            text-shadow: none; /* 移除文字阴影 */
            opacity: 0.9;
        }
    </style>
</head>
<body>
    <!-- 桌面背景层，用于动态 Frutiger Aero 风格背景 -->
    <div class="desktop-background" id="desktop-background"></div>

    <!-- 桌面容器，模拟屏幕 -->
    <div class="desktop-container" id="desktop-container">
        <!-- 桌面布局 - 包含主桌面区和任务栏 -->
        <div class="desktop-layout">
            <!-- 主桌面区 - 图标和窗口所在区域 -->
            <div class="main-desktop-area" id="main-desktop-area">
                <!-- 桌面图标（快捷方式） -->
                <div class="desktop-icons-container" id="desktop-icons-container">
                    <div class="desktop-icon" data-section="folder" data-title-zh="我的文件夹" data-title-en="My Folder">
                        <span class="icon-placeholder" data-asset-key="icon_folder"></span>
                        <span class="desktop-icon-label" data-lang-key="folderIcon">文件夹</span>
                    </div>
                    <div class="desktop-icon" data-section="log" data-title-zh="系统日志" data-title-en="System Log">
                        <span class="icon-placeholder" data-asset-key="icon_log"></span>
                        <span class="desktop-icon-label" data-lang-key="logIcon">系统日志</span>
                    </div>
                    <!-- 关于我图标更改为 mazko.exe 和 M 图标 -->
                    <div class="desktop-icon" data-section="about" data-title-zh="关于 MAZKO" data-title-en="About MAZKO">
                        <span class="icon-placeholder" data-asset-key="icon_mazko_logo"></span>
                        <span class="desktop-icon-label" data-lang-key="mazkoExeIcon">MAZKO</span>
                    </div>
                    <div class="desktop-icon" data-section="music-player" data-title-zh="音乐播放器" data-title-en="Music Player">
                        <span class="icon-placeholder" data-asset-key="icon_music_player"></span>
                        <span class="desktop-icon-label" data-lang-key="musicPlayerIcon">音乐播放器</span>
                    </div>
                    <!-- 新增的数据核心应用程序图标 -->
                    <div class="desktop-icon" data-section="data-core" data-title-zh="數據ᕼᣯ鈊 ⸸ Dᴬᵀᴬ.Cᴼᴿᴱ ☍" data-title-en="DATA.CORE">
                        <span class="icon-placeholder" data-asset-key="icon_datacore"></span>
                        <span class="desktop-icon-label" data-lang-key="datacoreIcon">數據核心</span>
                    </div>
                </div>
                <!-- 窗口将通过 JavaScript 附加在这里 -->
                <!-- 右键菜单容器 -->
                <div id="context-menu" class="context-menu hidden"></div>
            </div>

            <!-- 开始菜单 -->
            <div id="start-menu" class="start-menu">
                <div class="start-menu-header" data-section="about" data-title-zh="关于 MAZKO" data-title-en="About MAZKO"> <!-- 点击头部打开关于我 -->
                    <span class="icon-placeholder" data-asset-key="icon_mazko_logo"></span>
                    <span data-lang-key="profileName">MAZKO</span>
                </div>
                <a href="#" class="start-menu-item" data-section="folder" data-lang-key="folderMenuItem" data-title-zh="我的文件夹" data-title-en="My Folder">
                    <span class="icon-placeholder" data-asset-key="icon_folder"></span>
                    <span class="menu-item-label"></span>
                </a>
                <a href="#" class="start-menu-item" data-section="log" data-lang-key="logMenuItem" data-title-zh="系统日志" data-title-en="System Log">
                    <span class="icon-placeholder" data-asset-key="icon_log"></span>
                    <span class="menu-item-label"></span>
                </a>
                <a href="#" class="start-menu-item" data-section="music-player" data-lang-key="musicPlayerMenuItem" data-title-zh="音乐播放器" data-title-en="Music Player">
                    <span class="icon-placeholder" data-asset-key="icon_music_player"></span>
                    <span class="menu-item-label"></span>
                </a>
                <!-- 新增的数据核心应用程序菜单项 -->
                <a href="#" class="start-menu-item" data-section="data-core" data-lang-key="datacoreMenuItem" data-title-zh="數據ᕼᣯ鈊 ⸸ Dᴬᵀᴬ.Cᴼᴿᴱ ☍" data-title-en="DATA.CORE">
                    <span class="icon-placeholder" data-asset-key="icon_datacore"></span>
                    <span class="menu-item-label"></span>
                </a>
                <div class="start-menu-buttons-container">
                    <button class="start-menu-footer-button" data-section="settings" data-lang-key="settingsMenuItem" title="设置" data-title-zh="系统设置" data-title-en="Settings">
                        <span class="icon-placeholder" data-asset-key="icon_settings"></span>
                    </button>
                    <button class="start-menu-footer-button" data-section="shutdown" data-lang-key="shutdownMenuItem" title="关闭系统" data-title-zh="关闭系统" data-title-en="Shutdown">
                        <span class="icon-placeholder" data-asset-key="icon_shutdown"></span>
                    </button>
                </div>
            </div>

            <!-- 任务栏底部 -->
            <div class="taskbar" id="taskbar">
                <!-- 开始按钮更改为 M 图标 -->
                <button class="start-button" id="start-button-taskbar">
                    <span class="icon-placeholder" data-asset-key="icon_mazko_logo" id="start-button-icon-placeholder"></span>
                </button>

                <!-- 任务栏图标（打开/最小化窗口） -->
                <div id="taskbar-icons" class="taskbar-icons-container">
                    <!-- 最小化窗口图标将附加在这里 -->
                </div>

                <!-- 右侧系统托盘 -->
                <div class="system-tray">
                    <div class="system-tray-display">
                        <span class="icon-placeholder" data-asset-key="icon_wifi"></span>
                        <span class="icon-placeholder" data-asset-key="icon_battery"></span>
                        <span class="icon-placeholder" data-asset-key="icon_volume"></span>
                        <span class="text-sm opacity-80 system-tray-text" id="current-time"></span> <!-- 时间显示，使用新的system-tray-text类 -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        /**
         * @object ASSETS
         * @description 所有图片和图标路径的集中管理。
         * 所有资产现在都经过Base64编码或使用相对路径。
         */
        const ASSETS = {
            // 光标图像 (默认黑色点，活动时十字，指针时箭头)
            'cursor_default': 'data:image/svg+xml,%3Csvg width=\'16\' height=\'16\' viewBox=\'0 0 16 16\' fill=\'none\' xmlns=\'http://www.w3.org/2000/svg\'%3E%3Ccircle cx=\'8\' cy=\'8\' r=\'2\' fill=\'%2300FF41\'/%3E%3C/svg%3E',
            'cursor_active': 'data:image/svg+xml,%3Csvg width=\'16\' height=\'16\' viewBox=\'0 0 16 16\' fill=\'none\' xmlns=\'http://www.w3.org/2000/svg\'%3E%3Cpath d=\'M8 0V16M0 8H16\' stroke=\'%2300FF41\' stroke-width=\'2\'/%3E%3C/svg%3E',
            'cursor_pointer': 'data:image/svg+xml,%3Csvg width=\'16\' height=\'16\' viewBox=\'0 0 16 16\' fill=\'none\' xmlns=\'http://www.w3.org/2000/svg\'%3E%3Cpath d=\'M1 1L15 8L1 15V1L1 1Z\' fill=\'%2300FF41\' stroke=\'%2300FF41\' stroke-width=\'1\'/%3E%3C/svg%3E',

            // 桌面图标 / 开始菜单图标 (PNGs with relative paths)
            'icon_folder': './assets/icon/file_icon.png', // Updated to file_icon.png as per request
            'icon_log': './assets/icon/storage_icon.png', // Updated to storage_icon.png as per request
            'icon_mazko_logo': './assets/icon/radiation m logo 1.png', 
            'icon_music_player': './assets/icon/music_player_icon.png', // New music player icon
            // 'icon_browser': './assets/icon/browser_icon.png', // Removed browser as per request
            'icon_datacore': './assets/icon/datacore_logo.png', 

            // Used for service/socials sections (these are now integrated into "About")
            'icon_services': 'data:image/svg+xml,%3Csvg width=\'64\' height=\'64\' viewBox=\'0 0 24 24\' fill=\'none\' xmlns=\'http://www.w3.org/2000/svg\'%3E%3Cpath d=\'M18 13.5V18C18 19.1046 17.1046 20 16 20H4C2.89543 20 2 19.1046 2 18V6C2 4.89543 2.89543 4 4 4H10.5M18 13.5L22 9.5M22 9.5L18 5.5M22 9.5H16M13 10L10.5 12.5L13 15\' stroke=\'%2300FF41\' stroke-width=\'2\' stroke-linecap=\'round\' stroke-linejoin=\'round\'/%3E%3C/svg%3E',
            'icon_socials': 'data:image/svg+xml,%3Csvg width=\'64\' height=\'64\' viewBox=\'0 0 24 24\' fill=\'none\' xmlns=\'http://www.w3.org/2000/svg\'%3E%3Cpath d=\'M18 8C19.6569 8 21 6.65685 21 5C21 3.34315 19.6569 2 18 2C16.3431 2 15 3.34315 15 5C15 6.65685 16.3431 8 18 8Z\' stroke=\'%2300FF41\' stroke-width=\'2\' stroke-linecap=\'round\' stroke-linejoin=\'round\'/%3E%3Cpath d=\'M6 15C7.65685 15 9 13.6569 9 12C9 10.3431 7.65685 9 6 9C4.34315 9 3 10.3431 3 12C3 13.6569 4.34315 15 6 15Z\' stroke=\'%2300FF41\' stroke-width=\'2\' stroke-linecap=\'round\' stroke-linejoin=\'round\'/%3E%3Cpath d=\'M18 22C19.6569 22 21 20.6569 21 19C21 17.3431 19.6569 16 18 16C16.3431 16 15 17.3431 15 19C15 20.6569 16.3431 22 18 22Z\' stroke=\'%2300FF41\' stroke-width=\'2\' stroke-linecap=\'round\' stroke-linejoin=\'round\'/%3E%3Cpath d=\'M8.59 13.51L15.42 17.49\' stroke=\'%2300FF41\' stroke-width=\'2\' stroke-linecap=\'round\' stroke-linejoin=\'round\'/%3E%3Cpath d=\'M15.41 6.51L8.59 10.49\' stroke=\'%2300FF41\' stroke-width=\'2\' stroke-linecap=\'round\' stroke-linejoin=\'round\'/%3E%3C/svg%3E',

            // Taskbar system tray icons (SVG with green strokes/fills)
            'icon_wifi': 'data:image/svg+xml,%3Csvg width=\'24\' height=\'24\' viewBox=\'0 0 24 24\' fill=\'none\' xmlns=\'http://www.w3.org/2000/svg\'%3E%3Cpath d=\'M12 18V22\' stroke=\'%2300FF41\' stroke-width=\'2\' stroke-linecap=\'round\' stroke-linejoin=\'round\'/%3E%3Cpath d=\'M12 12L12.01 12\' stroke=\'%2300FF41\' stroke-width=\'2\' stroke-linecap=\'round\' stroke-linejoin=\'round\'/%3E%3Cpath d=\'M2.99998 8.00002C5.99998 5.00002 9.00002 3.00002 12 3.00002C15 3.00002 18 5.00002 21 8.00002\' stroke=\'%2300FF41\' stroke-width=\'2\' stroke-linecap=\'round\' stroke-linejoin=\'round\'/%3E%3Cpath d=\'M5.99998 11C7.99998 9 10 7.99998 12 7.99998C14 7.99998 16 9 18 11\' stroke=\'%2300FF41\' stroke-width=\'2\' stroke-linecap=\'round\' stroke-linejoin=\'round\'/%3E%3C/svg%3E',
            'icon_battery': 'data:image/svg+xml,%3Csvg width=\'24\' height=\'24\' viewBox=\'0 0 24 24\' fill=\'none\' xmlns=\'http://www.w3.org/2000/svg\'%3E%3Cpath d=\'M15 6H19C19.5523 6 20 6.44772 20 7V17C20 17.5523 19.5523 18 19 18H5C4.44772 18 4 17.5523 4 17V7C4 6.44772 4.44772 6 5 6H9M15 6V4C15 3.44772 14.5523 3 14 3H10C9.44772 3 9 3.44772 9 4V6M15 6H9M22 10V14\' stroke=\'%2300FF41\' stroke-width=\'2\' stroke-linecap=\'round\' stroke-linejoin=\'round\'/%3E%3C/svg%3E',
            'icon_volume': 'data:image/svg+xml,%3Csvg width=\'24\' height=\'24\' viewBox=\'0 0 24 24\' fill=\'none\' xmlns=\'http://www.w3.org/2000/svg\'%3E%3Cpath d=\'M11 5L6 9H2V15H6L11 19V5Z\' stroke=\'%2300FF41\' stroke-width=\'2\' stroke-linecap=\'round\' stroke-linejoin=\'round\'/%3E%3Cpath d=\'M19.07 4.93C20.6695 6.52936 21.5583 8.70776 21.5583 11C21.5583 13.2922 20.6695 15.4706 19.07 17.07\' stroke=\'%2300FF41\' stroke-width=\'2\' stroke-linecap=\'round\' stroke-linejoin=\'round\'/%3E%3Cpath d=\'M15.54 8.46C16.3262 9.24614 16.7644 10.2986 16.7644 11.39C16.7644 12.4814 16.3262 13.5339 15.54 14.32\' stroke=\'%2300FF41\' stroke-width=\'2\' stroke-linecap=\'round\' stroke-linejoin=\'round\'/%3E%3C/svg%3E',

            // Start menu bottom button icons (SVG with black strokes/fills)
            'icon_settings': 'data:image/svg+xml,%3Csvg width=\'32\' height=\'32\' viewBox=\'0 0 24 24\' fill=\'none\' xmlns=\'http://www.w3.org/2000/svg\'%3E%3Cpath d=\'M12 2C12.5523 2 13 2.44772 13 3V5.07409C14.7351 5.25367 16.3475 5.92383 17.7088 6.98066L19.2912 5.3983C19.6817 5.00782 20.3183 5.00782 20.7088 5.3983L21.5983 6.28779C21.9888 6.67828 21.9888 7.31482 21.5983 7.70531L19.9575 9.34612C21.0143 10.7074 21.6845 12.3198 21.864 14H24V14C24 14.5523 23.5523 15 23 15H20.9259C20.7463 16.7351 20.0762 18.3475 19.0193 19.7088L20.6017 21.2912C20.9922 21.6817 20.9922 22.3183 20.6017 22.7088L19.7122 23.5983C19.3217 23.9888 18.6852 23.9888 18.2947 23.5983L16.6539 21.9575C15.2926 23.0143 13.6802 23.6845 12 23.864V24C11.4477 24 11 23.5523 11 23V21.864C9.26493 21.6845 7.65251 21.0143 6.29119 19.9575L4.70883 21.54C4.31834 21.9305 3.68179 21.9305 3.29131 21.54L2.40181 20.6505C2.01132 20.26 2.01132 19.6235 2.40181 19.233L4.04262 17.5922C2.98576 16.2309 2.31557 14.6185 2.13603 12.8833H0V12C0 11.4477 0.447715 11 1 11H3.07409C3.25367 9.26493 3.92383 7.65251 4.98066 6.29119L3.3983 4.70883C3.00782 4.31834 3.00782 3.68179 3.3983 3.29131L4.28779 2.40181C4.67828 2.01132 5.31482 2.01132 5.70531 2.40181L7.34612 4.04262C8.70744 2.98576 10.3198 2.31557 12 2.13603V2Z\' stroke=\'%23080808\' stroke-width=\'2\' stroke-linecap=\'round\' stroke-linejoin=\'round\'/%3E%3Ccircle cx=\'12\' cy=\'12\' r=\'3\' stroke=\'%23080808\' stroke-width=\'2\' stroke-linecap=\'round\' stroke-linejoin=\'round\'/%3E%3C/svg%3E',
            'icon_shutdown': 'data:image/svg+xml,%3Csvg width=\'24\' height=\'24\' viewBox=\'0 0 24 24\' fill=\'none\' xmlns=\'http://www.w3.org/2000/svg\'%3E%3Cpath d=\'M12 2V12\' stroke=\'%23080808\' stroke-width=\'2\' stroke-linecap=\'round\' stroke-linejoin=\'round\'/%3E%3Cpath d=\'M18.364 5.63604C20.4184 7.69036 21.5817 10.3913 21.5817 13.2091C21.5817 16.0269 20.4184 18.7277 18.364 20.7821C16.3096 22.8364 13.6087 24 10.7909 24C7.97314 24 5.27228 22.8364 3.21796 20.7821C1.16364 18.7277 0 16.0269 0 13.2091C0 10.3913 1.16364 7.69036 3.21796 5.63604\' stroke=\'%23080808\' stroke-width=\'2\' stroke-linecap=\'round\' stroke-linejoin=\'round\'/%3E%3C/svg%3E',

            // Window control button icons (SVG with black strokes/fills)
            'icon_minus': 'data:image/svg+xml,%3Csvg width=\'24\' height=\'24\' viewBox=\'0 0 24 24\' fill=\'none\' xmlns=\'http://www.w3.org/2000/svg\'%3E%3Cpath d=\'M5 12H19\' stroke=\'%23080808\' stroke-width=\'2\' stroke-linecap=\'round\' stroke-linejoin=\'round\'/%3E%3C/svg%3E',
            'icon_square': 'data:image/svg+xml,%3Csvg width=\'24\' height=\'24\' viewBox=\'0 0 24 24\' fill=\'none\' xmlns=\'http://www.w3.org/2000/svg\'%3E%3Crect x=\'3\' y=\'3\' width=\'18\' height=\'18\' rx=\'2\' stroke=\'%23080808\' stroke-width=\'2\' stroke-linecap=\'round\' stroke-linejoin=\'round\'/%3E%3C/svg%3E',
            'icon_times': 'data:image/svg+xml,%3Csvg width=\'24\' height=\'24\' viewBox=\'0 0 24 24\' fill=\'none\' xmlns=\'http://www.w3.org/2000/svg\'%3E%3Cpath d=\'M6 18L18 6M6 6L18 18\' stroke=\'%23080808\' stroke-width=\'2\' stroke-linecap=\'round\' stroke-linejoin=\'round\'/%3E%3C/svg%3E',
            'icon_window_restore': 'data:image/svg+xml,%3Csvg width=\'24\' height=\'24\' viewBox=\'0 0 24 24\' fill=\'none\' xmlns=\'http://www.w3.org/2000/svg\'%3E%3Cpath d=\'M4 14C4 12.8954 4.89543 12 6 12H18C19.1046 12 20 12.8954 20 14V18C20 19.1046 19.1046 20 18 20H6C4.89543 20 4 19.1046 4 18V14Z\' stroke=\'%23080808\' stroke-width=\'2\' stroke-linecap=\'round\' stroke-linejoin=\'round\'/%3E%3Cpath d=\'M8 4C8 2.89543 8.89543 2 10 2H18C19.1046 2 20 2.89543 20 4V8\' stroke=\'%23080808\' stroke-width=\'2\' stroke-linecap=\'round\' stroke-linejoin=\'round\'/%3E%3C/svg%3E',

            // Gallery navigation button icons (SVG with green strokes/fills)
            'icon_chevron_left': 'data:image/svg+xml,%3Csvg width=\'24\' height=\'24\' viewBox=\'0 0 24 24\' fill=\'none\' xmlns=\'http://www.w3.org/2000/svg\'%3E%3Cpath d=\'M15 18L9 12L15 6\' stroke=\'%2300FF41\' stroke-width=\'2\' stroke-linecap=\'round\' stroke-linejoin=\'round\'/%3E%3C/svg%3E',
            'icon_chevron_right': 'data:image/svg+xml,%3Csvg width=\'24\' height=\'24\' viewBox=\'0 0 24 24\' fill=\'none\' xmlns=\'http://www.w3.org/2000/svg\'%3E%3Cpath d=\'M9 18L15 12L9 6\' stroke=\'%2300FF41\' stroke-width=\'2\' stroke-linecap=\'round\' stroke-linejoin=\'round\'/%3E%3C/svg%3E',

            // Music player icons
            'icon_play': 'data:image/svg+xml,%3Csvg width=\'24\' height=\'24\' viewBox=\'0 0 24 24\' fill=\'none\' xmlns=\'http://www.w3.org/2000/svg\'%3E%3Cpath d=\'M5 3L19 12L5 21V3Z\' fill=\'%23080808\' stroke=\'%23080808\' stroke-width=\'2\' stroke-linecap=\'round\' stroke-linejoin=\'round\'/%3E%3C/svg%3E',
            'icon_pause': 'data:image/svg+xml,%3Csvg width=\'24\' height=\'24\' viewBox=\'0 0 24 24\' fill=\'none\' xmlns=\'http://www.w3.org/2000/svg\'%3E%3Cpath d=\'M6 4H10V20H6V4Z\' fill=\'%23080808\' stroke=\'%23080808\' stroke-width=\'2\' stroke-linecap=\'round\' stroke-linejoin=\'round\'/%3E%3Cpath d=\'M14 4H18V20H14V4Z\' fill=\'%23080808\' stroke=\'%23080808\' stroke-width=\'2\' stroke-linecap=\'round\' stroke-linejoin=\'round\'/%3E%3C/svg%3E',
            'icon_next_track': 'data:image/svg+xml,%3Csvg width=\'24\' height=\'24\' viewBox=\'0 0 24 24\' fill=\'none\' xmlns=\'http://www.w3.org/2000/svg\'%3E%3Cpath d=\'M5 4L15 12L5 20V4Z\' fill=\'%23080808\' stroke=\'%23080808\' stroke-width=\'2\' stroke-linecap=\'round\' stroke-linejoin=\'round\'/%3E%3Cpath d=\'M19 4V20\' stroke=\'%23080808\' stroke-width=\'2\' stroke-linecap=\'round\' stroke-linejoin=\'round\'/%3E%3C/svg%3E',
            'icon_prev_track': 'data:image/svg+xml,%3Csvg width=\'24\' height=\'24\' viewBox=\'0 0 24 24\' fill=\'none\' xmlns=\'http://www.w3.org/2000/svg\'%3E%3Cpath d=\'M19 20L9 12L19 4V20Z\' fill=\'%23080808\' stroke=\'%23080808\' stroke-width=\'2\' stroke-linecap=\'round\' stroke-linejoin=\'round\'/%3E%3Cpath d=\'M5 20V4\' stroke=\'%23080808\' stroke-width=\'2\' stroke-linecap=\'round\' stroke-linejoin=\'round\'/%3E%3C/svg%3E',
            'icon_loop': 'data:image/svg+xml,%3Csvg width=\'24\' height=\'24\' viewBox=\'0 0 24 24\' fill=\'none\' xmlns=\'http://www.w3.org/2000/svg\'%3E%3Cpath d=\'M17 1H7C4.79086 1 3 2.79086 3 5V19C3 21.2091 4.79086 23 7 23H17C19.2091 23 21 21.2091 21 19V5C21 2.79086 19.2091 1 17 1Z\' stroke=\'%23080808\' stroke-width=\'2\' stroke-linecap=\'round\' stroke-linejoin=\'round\'/%3E%3Cpath d=\'M17 16V18C17 19.1046 16.1046 20 15 20H9C7.89543 20 7 19.1046 7 18V16\' stroke=\'%23080808\' stroke-width=\'2\' stroke-linecap=\'round\' stroke-linejoin=\'round\'/%3E%3Cpath d=\'M7 8V6C7 4.89543 7.89543 4 9 4H15C16.1046 4 17 4.89543 17 6V8\' stroke=\'%23080808\' stroke-width=\'2\' stroke-linecap=\'round\' stroke-linejoin=\'round\'/%3E%3Cpath d=\'M17 12H7\' stroke=\'%23080808\' stroke-width=\'2\' stroke-linecap=\'round\' stroke-linejoin=\'round\'/%3E%3C/svg%3E',
            'icon_shuffle': 'data:image/svg+xml,%3Csvg width=\'24\' height=\'24\' viewBox=\'0 0 24 24\' fill=\'none\' xmlns=\'http://www.w3.org/2000/svg\'%3E%3Cpath d=\'M16 3H21V8\' stroke=\'%23080808\' stroke-width=\'2\' stroke-linecap=\'round\' stroke-linejoin=\'round\'/%3E%3Cpath d=\'M4 20L21 3\' stroke=\'%23080808\' stroke-width=\'2\' stroke-linecap=\'round\' stroke-linejoin=\'round\'/%3E%3Cpath d=\'M21 16V21H16\' stroke=\'%23080808\' stroke-width=\'2\' stroke-linecap=\'round\' stroke-linejoin=\'round\'/%3E%3Cpath d=\'M14 10L21 17\' stroke=\'%23080808\' stroke-width=\'2\' stroke-linecap=\'round\' stroke-linejoin=\'round\'/%3E%3Cpath d=\'M3 11L10 18\' stroke=\'%23080808\' stroke-width=\'2\' stroke-linecap=\'round\' stroke-linejoin=\'round\'/%3E%3C/svg%3E',
            'icon_repeat_one': 'data:image/svg+xml,%3Csvg width=\'24\' height=\'24\' viewBox=\'0 0 24 24\' fill=\'none\' xmlns=\'http://www.w3.org/2000/svg\'%3E%3Cpath d=\'M17 1L21 5L17 9\' stroke=\'%23080808\' stroke-width=\'2\' stroke-linecap=\'round\' stroke-linejoin=\'round\'/%3E%3Cpath d=\'M3 11V19C3 20.1046 3.89543 21 5 21H19C20.1046 21 21 20.1046 21 19V5C21 3.89543 20.1046 3 19 3H13\' stroke=\'%23080808\' stroke-width=\'2\' stroke-linecap=\'round\' stroke-linejoin=\'round\'/%3E%3Cpath d=\'M3 5L7 1L3 9\' stroke=\'%23080808\' stroke-width=\'2\' stroke-linecap=\'round\' stroke-linejoin=\'round\'/%3E%3Cpath d=\'M7 15H17\' stroke=\'%23080808\' stroke-width=\'2\' stroke-linecap=\'round\' stroke-linejoin=\'round\'/%3E%3C/svg%3E',
            
            // File/Folder icons for folder system
            'icon_file': 'data:image/svg+xml,%3Csvg width=\'24\' height=\'24\' viewBox=\'0 0 24 24\' fill=\'none\' xmlns=\'http://www.w3.org/2000/svg\'%3E%3Cpath d=\'M14 2H6C4.89543 2 4 2.89543 4 4V20C4 21.1046 4.89543 22 6 22H18C19.1046 22 20 21.1046 20 20V8L14 2Z\' stroke=\'%2300FF41\' stroke-width=\'2\' stroke-linecap=\'round\' stroke-linejoin=\'round\'/%3E%3Cpath d=\'M14 2V8H20\' stroke=\'%2300FF41\' stroke-width=\'2\' stroke-linecap=\'round\' stroke-linejoin=\'round\'/%3E%3Cpath d=\'M10 9H8M16 13H8M16 17H8\' stroke=\'%2300FF41\' stroke-width=\'2\' stroke-linecap=\'round\' stroke-linejoin=\'round\'/%3E%3C/svg%3E',
            'icon_folder_closed': 'data:image/svg+xml,%3Csvg width=\'24\' height=\'24\' viewBox=\'0 0 24 24\' fill=\'none\' xmlns=\'http://www.w3.org/2000/svg\'%3E%3Cpath d=\'M3 6V20C3 20.5304 3.21071 21.0391 3.58579 21.4142C3.96086 21.7893 4.46957 22 5 22H19C19.5304 22 20.0391 21.7893 20.4142 21.4142C20.7893 21.0391 21 20.5304 21 20V8C21 7.46957 20.7893 6.96086 20.4142 6.58579C20.0391 6.21071 19.5304 6 19 6H12L10 3H5C4.46957 3 3.96086 3.21071 3.58579 3.58579C3.21071 3.96086 3 4.46957 3 5V6Z\' stroke=\'%2300FF41\' stroke-width=\'2\' stroke-linecap=\'round\' stroke-linejoin=\'round\'/%3E%3C/svg%3E',
            'icon_plus': 'data:image/svg+xml,%3Csvg width=\'24\' height=\'24\' viewBox=\'0 0 24 24\' fill=\'none\' xmlns=\'http://www.w3.org/2000/svg\'%3E%3Cpath d=\'M12 4V20M4 12H20\' stroke=\'%2300FF41\' stroke-width=\'2\' stroke-linecap=\'round\' stroke-linejoin=\'round\'/%3E%3C/svg%3E',
            'icon_edit': 'data:image/svg+xml,%3Csvg width=\'24\' height=\'24\' viewBox=\'0 0 24 24\' fill=\'none\' xmlns=\'http://www.w3.org/2000/svg\'%3E%3Cpath d=\'M17 3L21 7L13.78 14.22L10 14L9.78 10.22L17 3Z\' stroke=\'%2300FF41\' stroke-width=\'2\' stroke-linecap=\'round\' stroke-linejoin=\'round\'/%3E%3Cpath d=\'M16 17H20C20.5523 17 21 17.4477 21 18V20C21 20.5523 20.5523 21 20 21H4C3.44772 21 3 20.5523 3 20V4C3 3.44772 3.44772 3 4 3H8\' stroke=\'%2300FF41\' stroke-width=\'2\' stroke-linecap=\'round\' stroke-linejoin=\'round\'/%3E%3C/svg%3E',


            // Desktop background image (relative path)
            'desktop_background_image': './assets/backgrounds/bg.jpg',

            // Data Core Inspiration images (relative paths)
            'inspiration_1_thumb': './assets/data-core/inspiration_1_thumb.jpg',
            'inspiration_1_full': './assets/data-core/inspiration_1_full.jpg',
            'inspiration_2_thumb': './assets/data-core/inspiration_2_thumb.jpg',
            'inspiration_2_full': './assets/data-core/inspiration_2_full.jpg',
            'inspiration_3_thumb': './assets/data-core/inspiration_3_thumb.jpg',
            'inspiration_3_full': './assets/data-core/inspiration_3_full.jpg',
            'inspiration_4_thumb': './assets/data-core/inspiration_4_thumb.jpg',
            'inspiration_4_full': './assets/data-core/inspiration_4_full.jpg',
            'inspiration_5_thumb': './assets/data-core/inspiration_5_thumb.jpg',
            'inspiration_5_full': './assets/data-core/inspiration_5_full.jpg',
            'inspiration_6_thumb': './assets/data-core/inspiration_6_thumb.jpg',
            'inspiration_6_full': './assets/data-core/inspiration_6_full.jpg',
            'inspiration_7_thumb': './assets/data-core/inspiration_7_thumb.jpg',
            'inspiration_7_full': './assets/data-core/inspiration_7_full.jpg',
            'inspiration_8_thumb': './assets/data-core/inspiration_8_thumb.jpg',
            'inspiration_8_full': './assets/data-core/inspiration_8_full.jpg',

            // Music files (placeholders - replace with actual paths in docs/assets/music)
            'music_track_1': 'https://www.soundhelix.com/examples/mp3/SoundHelix-Song-1.mp3',
            'music_track_2': 'https://www.soundhelix.com/examples/mp3/SoundHelix-Song-2.mp3',
            'music_track_3': 'https://www.soundhelix.com/examples/mp3/SoundHelix-Song-3.mp3'
        };

        /**
         * @function getAssetUrl
         * @description Retrieves the URL for a given asset from the ASSETS object.
         * If the asset value is a Base64 string, it's returned directly.
         * If the asset value is a relative path, that path is returned.
         * @param {string} assetKey - The key name in the ASSETS object.
         * @returns {string} The URL path of the corresponding asset.
         */
        function getAssetUrl(assetKey) {
            const assetValue = ASSETS[assetKey];
            if (!assetValue) {
                console.warn(`Asset with key "${assetKey}" not found.`);
                return ''; // Or a placeholder image URL
            }
            // Check if it's a Base64 string (starts with 'data:image/')
            if (assetValue.startsWith('data:image/')) {
                return assetValue;
            } else {
                // Assume it's a relative path to a file
                return assetValue;
            }
        }


        /**
         * @object LANG_CONTENT
         * @description Centralized multi-language content for the UI.
         */
        const LANG_CONTENT = {
            zh: {
                systemName: 'MAX OS',
                systemVersion: 'v1.0.0',
                welcomeMessage: '欢迎来到 MAZKO 的虚拟终端',
                loadingMessage: '加载中...',
                errorLoadingContent: '加载内容失败：',
                unknownModule: '未知模块',
                profileName: 'MAZKO',
                startButton: '开始',
                // Desktop Icons / Menu Items
                folderIcon: '文件夹',
                folderMenuItem: '我的文件夹',
                logIcon: '系统日志',
                logMenuItem: '系统日志',
                mazkoExeIcon: 'MAZKO',
                musicPlayerIcon: '音乐播放器',
                musicPlayerMenuItem: '音乐播放器',
                // browserIcon: '浏览器', // Removed browser as per request
                // browserMenuItem: '浏览器', // Removed browser as per request
                datacoreIcon: '數據核心',
                datacoreMenuItem: '數據ᕼᣯ鈊 ⸸ Dᴬᵀᴬ.Cᴼᴿᴱ ☍',
                settingsMenuItem: '系统设置',
                shutdownMenuItem: '关机',
                shutdownMessage: '系统正在关机，再见！',

                // Status bar specific
                statusBarBranding: '⧉ мax 係統 ⸸ 𝙈𝙖𝙭 𝙊𝙎 [𝙑ᵉʳ¹․⁰․⁰]',
                statusBarStatusReady: '就绪',
                statusBarStatusDragging: '正在拖动窗口...',
                statusBarStatusResizing: '正在调整窗口大小...',

                // Folder system specific
                newFolderPrompt: '请输入新文件夹的名称：',
                renamePrompt: '请输入新的名称：',
                emptyNameError: '名称不能为空。',
                duplicateNameError: '已存在同名文件或文件夹。',
                fileCount: '文件',
                folderCount: '文件夹',
                contextMenuNewFolder: '新建文件夹',
                contextMenuNewFile: '新建文件',
                contextMenuRename: '重命名',
                contextMenuDelete: '删除',
                confirmDelete: '确定要删除 "{name}" 吗？',

                // Music Player specific
                nowPlaying: '正在播放：',
                noSongSelected: '未选择歌曲',
                playbackModeLoop: '列表循环',
                playbackModeShuffle: '随机播放',
                playbackModeRepeatOne: '单曲循环',
                playlist: '播放列表',
                songTitlePlaceholder: '无',

                // Browser specific (kept for completeness if needed in future, but not used in UI now)
                browserGoButton: '前往',
                browserPlaceholder: '输入网址，例如：https://www.example.com',
                browserLoading: '正在加载...',
                browserSecurityWarning: '由于浏览器安全限制 (同源策略)，此网站可能无法在此处加载。',

                // Works section (No longer directly accessed via icon, but content might be used)
                worksTitle: '我的作品集', // Placeholder, used if "About" references it
                worksClickPrompt: '点击作品查看详情', // Placeholder
                worksDetailsSuffix: ' 作品详情', // Placeholder

                // Log (formerly Characters) section
                logTitle: '系统日志',
                logDescription: '以下是系统更新日志和我的设计日常。',
                logEntryDate: '日期',
                logEntryType: '类型',
                logEntryContent: '内容',
                logTypeUpdate: '更新',
                logTypeDaily: '日常',

                // About section (integrates Services and Socials)
                aboutTitle: '关于 MAZKO',
                aboutContent: `
# 关于 MAZKO

MAZKO 是一位专注于 **赛博朋克、Y2K、PSX 和故障艺术风格** 的数字艺术家。

我的创作领域涵盖：

* **三维模型与渲染**：高精度与低多边形模型，专注于复古未来主义美学。
* **概念艺术与插画**：将抽象想法转化为具象视觉，带有独特的赛博朋克氛围。
* **视觉特效与动画**：为您的项目增添动态和沉浸感。
* **用户界面设计**：秉持 Frutiger Aero、Y2K 等风格，创造直观而美观的界面。

我致力于通过艺术表达对科技、未来与怀旧的思考。

---

## 我的服务

我提供以下数字艺术服务。每个服务都旨在满足您特定的创意需求。

### 角色建模与设计
**短期描述**：创建独特且风格化的 3D/2D 角色。
**服务内容**：
* 概念草图：根据您的想法，提供多角度的角色概念图。
* 3D建模：使用 Blender/ZBrush 等工具进行角色高低模制作。
* 纹理绘制：结合 Substance Painter，为角色赋予复古像素或科幻质感。
* 骨骼绑定与动画（基础）：提供基础的角色绑定和姿态设置。
**报价示例**：
* PSX风格低多边形角色：¥1500 - ¥5000 (根据细节复杂程度)
* 精细概念角色插画：¥800 - ¥3000 (根据细节和背景)
**项目周期**：通常为 1-3 周。

### 海报与视觉设计
**短期描述**：制作具有赛博朋克和故障艺术感的宣传海报。
**服务内容**：
* 活动海报：音乐节、游戏发布、艺术展览等主题海报。
* 品牌视觉：符合您品牌调性的独特图形元素和宣传图。
* 数字插画：用于网站、社交媒体或印刷品的定制插画。
* 动态图形（基础）：为海报添加简单的动画效果。
**报价示例**：
* 单页概念海报：¥1200 - ¥4000 (根据复杂度和修订次数)
* 系列视觉宣传图（3张）：¥3000 - ¥8000
**项目周期**：通常为 0.5-2 周。

---

## 社交媒体

欢迎在以下平台关注我，与我互动。

* **微博**: [https://weibo.com/yourprofile](https://weibo.com/yourprofile) (点击打开)
* **Instagram**: [https://instagram.com/yourprofile](https://instagram.com/yourprofile) (点击打开)
* **ArtStation**: [https://artstation.com/yourprofile](https://artstation.com/yourprofile) (点击打开)
* **Behance**: [https://behance.net/yourprofile](https://behance.net/yourprofile) (点击打开)
* **邮箱**: [your.email@example.com](mailto:your.email@example.com) (点击发送邮件)
`,
                // Data Core section
                datacoreTitle: '數據ᕼᣯ鈊 ⸸ Dᴬᵀᴬ.Cᴼᴿᴱ ☍',
                datacoreDescription: '探索我的灵感图库。',
                datacoreEmpty: '这里暂时没有灵感图片。',

                // Settings section
                settings: {
                    title: '系统设置',
                    description: '调整您的系统偏好设置。',
                    options: [
                        { id: 'language-toggle', type: 'language-toggle', label: '切换语言' }, 
                        { id: 'desktop-icons-toggle', type: 'toggle', checked: true, label: '显示桌面图标' },
                        { id: 'enable-animations', type: 'toggle', checked: true, disabled: true, label: '启用系统动画 (暂不可用)' },
                        { id: 'reset-settings', type: 'button', label: '重置所有设置' }
                    ]
                },
            }, // End of zh language content
            en: { // Add English content
                systemName: 'MAX OS',
                systemVersion: 'v1.0.0',
                welcomeMessage: 'Welcome to MAZKO\'s Virtual Terminal',
                loadingMessage: 'Loading...',
                errorLoadingContent: 'Failed to load content: ',
                unknownModule: 'Unknown Module',
                profileName: 'MAZKO',
                startButton: 'Start',
                // Desktop Icons / Menu Items
                folderIcon: 'Folder',
                folderMenuItem: 'My Folder',
                logIcon: 'System Log',
                logMenuItem: 'System Log',
                mazkoExeIcon: 'MAZKO',
                musicPlayerIcon: 'Music Player',
                musicPlayerMenuItem: 'Music Player',
                // browserIcon: 'Browser', // Removed browser as per request
                // browserMenuItem: 'Browser', // Removed browser as per request
                datacoreIcon: 'DATA CORE',
                datacoreMenuItem: 'DATA.CORE',
                settingsMenuItem: 'System Settings',
                shutdownMenuItem: 'Shutdown',
                shutdownMessage: 'System is shutting down, Goodbye!',

                // Status bar specific
                statusBarBranding: '⧉ мax 係統 ⸸ 𝙈𝙖𝙭 𝙊𝙎 [𝙑ᵉʳ¹․⁰․⁰]',
                statusBarStatusReady: 'Ready',
                statusBarStatusDragging: 'Dragging Window...',
                statusBarStatusResizing: 'Resizing Window...',

                // Folder system specific
                newFolderPrompt: 'Enter new folder name:',
                renamePrompt: 'Enter new name:',
                emptyNameError: 'Name cannot be empty.',
                duplicateNameError: 'A file or folder with this name already exists.',
                fileCount: 'Files',
                folderCount: 'Folders',
                contextMenuNewFolder: 'New Folder',
                contextMenuNewFile: 'New File',
                contextMenuRename: 'Rename',
                contextMenuDelete: 'Delete',
                confirmDelete: 'Are you sure you want to delete "{name}"?',

                // Music Player specific
                nowPlaying: 'Now Playing:',
                noSongSelected: 'No song selected',
                playbackModeLoop: 'Loop Playlist',
                playbackModeShuffle: 'Shuffle',
                playbackModeRepeatOne: 'Repeat One',
                playlist: 'Playlist',
                songTitlePlaceholder: 'None',

                // Browser specific (kept for completeness if needed in future, but not used in UI now)
                browserGoButton: 'Go',
                browserPlaceholder: 'Enter URL, e.g.: https://www.example.com',
                browserLoading: 'Loading...',
                browserSecurityWarning: 'Due to browser security restrictions (Same-Origin Policy), this website may not load here.',

                // Works section (No longer directly accessed via icon, but content might be used)
                worksTitle: 'My Works',
                worksClickPrompt: 'Click on a work to view details',
                worksDetailsSuffix: ' Details',

                // Log (formerly Characters) section
                logTitle: 'System Log',
                logDescription: 'Here are the system update logs and my daily design entries.',
                logEntryDate: 'Date',
                logEntryType: 'Type',
                logEntryContent: 'Content',
                logTypeUpdate: 'Update',
                logTypeDaily: 'Daily',

                // About section (integrates Services and Socials)
                aboutTitle: 'About MAZKO',
                aboutContent: `
# About MAZKO

MAZKO is a digital artist focused on **Cyberpunk, Y2K, PSX, and Glitch Art styles**.

My areas of expertise include:

* **3D Models & Renders**: High-fidelity and low-poly models, with a focus on retro-futuristic aesthetics.
* **Concept Art & Illustrations**: Transforming abstract ideas into concrete visuals with a unique cyberpunk atmosphere.
* **Visual Effects & Animation**: Adding dynamic and immersive elements to your projects.
* **User Interface Design**: Adhering to styles like Frutiger Aero, Y2K, to create intuitive and aesthetically pleasing interfaces.

I am dedicated to expressing thoughts on technology, the future, and nostalgia through art.

---

## My Services

I offer the following digital art services. Each service is designed to meet your specific creative needs.

### Character Modeling & Design
**Short Description**: Create unique and stylized 3D/2D characters.
**Services include**:
* Concept Sketches: Providing multi-angle character concepts based on your ideas.
* 3D Modeling: Creating high-poly and low-poly models using tools like Blender/ZBrush.
* Texture Painting: Using Substance Painter to give characters retro pixelated or sci-fi textures.
* Bone Rigging & Basic Animation: Providing basic character rigging and pose setup.
**Pricing Examples**:
* PSX Style Low-Poly Character: ¥1500 - ¥5000 (depending on detail complexity)
* Detailed Concept Character Illustration: ¥800 - ¥3000 (depending on detail and background)
**Project Duration**: Typically 1-3 weeks.

### Poster & Visual Design
**Short Description**: Create promotional posters with a cyberpunk and glitch art feel.
**Services include**:
* Event Posters: Themed posters for music festivals, game releases, art exhibitions, etc.
* Brand Visuals: Unique graphic elements and promotional images that align with your brand identity.
* Digital Illustrations: Custom illustrations for websites, social media, or print.
* Motion Graphics (Basic): 为海报添加简单的动画效果。
**Pricing Examples**:
* Single-Page Concept Poster: ¥1200 - ¥4000 (depending on complexity and revisions)
* Series of Visual Promotional Images (3 images): ¥3000 - ¥8000
**Project Duration**: Typically 0.5-2 weeks.

---

## Social Media

Feel free to follow me on the platforms below and interact.

* **Weibo**: [https://weibo.com/yourprofile](https://weibo.com/yourprofile) (Click to open)
* **Instagram**: [https://instagram.com/yourprofile](https://instagram.com/yourprofile) (Click to open)
* **ArtStation**: [https://artstation.com/yourprofile](https://artstation.com/yourprofile) (Click to open)
* **Behance**: [https://behance.net/yourprofile](https://behance.net/yourprofile) (Click to open)
* **Email**: [your.email@example.com](mailto:your.email@example.com) (Click to send email)
`,
                // Data Core section
                datacoreTitle: 'DATA.CORE',
                datacoreDescription: 'Explore my inspiration gallery.',
                datacoreEmpty: 'No inspiration images here yet.',

                // Settings section
                settings: {
                    title: 'System Settings',
                    description: 'Adjust your system preferences.',
                    options: [
                        { id: 'language-toggle', type: 'language-toggle', label: 'Toggle Language' },
                        { id: 'desktop-icons-toggle', type: 'toggle', checked: true, label: 'Show Desktop Icons' },
                        { id: 'enable-animations', type: 'toggle', checked: true, disabled: true, label: 'Enable System Animations (Unavailable)' },
                        { id: 'reset-settings', type: 'button', label: 'Reset All Settings' }
                    ]
                },
            }
        };

        // Mock data for new features
        const APP_DATA = {
            // Log Data (formerly characters)
            log: [
                {
                    id: 'log-001',
                    date: '2025-08-10',
                    type: 'update',
                    content: '系统核心优化：提升窗口动画流畅度，修复部分兼容性问题。'
                },
                {
                    id: 'log-002',
                    date: '2025-08-11',
                    type: 'daily',
                    content: '设计日常：今天尝试了新的故障艺术滤镜，效果非常赛博朋克！'
                },
                {
                    id: 'log-003',
                    date: '2025-08-12',
                    type: 'update',
                    content: '音乐播放器 1.0 版本上线：支持本地音乐播放，新增播放列表功能。'
                },
                {
                    id: 'log-004',
                    date: '2025-08-13',
                    type: 'daily',
                    content: '设计日常：为即将到来的项目绘制了几个 Y2K 风格的角色草图。'
                },
                {
                    id: 'log-005',
                    date: '2025-08-14',
                    type: 'update',
                    content: '文件夹系统 1.0 版本上线：支持文件/文件夹管理和右键菜单。'
                },
            ],
            // Initial Folder Structure (Client-side simulation)
            folder: {
                name: 'root',
                type: 'folder',
                children: [
                    { name: '作品集图片', type: 'folder', children: [] },
                    { name: '音乐', type: 'folder', children: [] },
                    { name: '我的文档.txt', type: 'file', content: '这是我的第一个文档。欢迎来到 MAX OS!' },
                    { name: 'TODO.txt', type: 'file', content: '修复 bug\n优化性能\n添加更多功能' }
                ]
            },
            music: [
                { id: 'song1', title: '星际迷航 - Star Trek', artist: '未知艺术家', file: 'music_track_1' },
                { id: 'song2', title: '赛博都市之夜 - Cyberpunk City Night', artist: 'MAZKO', file: 'music_track_2' },
                { id: 'song3', title: '复古未来波 - RetroFuture Wave', artist: '未来回响', file: 'music_track_3' }
            ],
            datacore: [
                { thumb_key: 'inspiration_1_thumb', full_key: 'inspiration_1_full', alt: '赛博朋克城市景观' },
                { thumb_key: 'inspiration_2_thumb', full_key: 'inspiration_2_full', alt: '故障艺术肖像' },
                { thumb_key: 'inspiration_3_thumb', full_key: 'inspiration_3_full', alt: 'Y2K美学设计' },
                { thumb_key: 'inspiration_4_thumb', full_key: 'inspiration_4_full', alt: 'PSX风格场景' },
                { thumb_key: 'inspiration_5_thumb', full_key: 'inspiration_5_full', alt: '霓虹灯管艺术' },
                { thumb_key: 'inspiration_6_thumb', full_key: 'inspiration_6_full', alt: '科技感UI界面' },
                { thumb_key: 'inspiration_7_thumb', full_key: 'inspiration_7_full', alt: '复古未来主义' },
                { thumb_key: 'inspiration_8_thumb', full_key: 'inspiration_8_full', alt: '数字故障纹理' }
            ]
        };

        // Global variables for music player
        let currentAudio = new Audio();
        let currentPlaylist = [];
        let currentSongIndex = -1;
        let playbackMode = 'loop'; // 'loop', 'shuffle', 'repeat-one'
        let scrollingTextInterval;

        let currentLanguage = 'zh'; 

        document.addEventListener('DOMContentLoaded', () => {
            console.log('脚本开始解析。');
            
            function updateTime() {
                const now = new Date();
                const hours = String(now.getHours()).padStart(2, '0');
                const minutes = String(now.getMinutes()).padStart(2, '0');
                const timeElement = document.getElementById('current-time');
                if (timeElement) {
                    timeElement.textContent = `${hours}:${minutes}`;
                } else {
                    console.warn('未找到时间元素。');
                }
            }

            setInterval(updateTime, 60000);
            updateTime();

            const startButton = document.getElementById('start-button-taskbar');
            const startMenu = document.getElementById('start-menu');
            const startMenuHeader = document.querySelector('.start-menu-header');
            const mainDesktopArea = document.getElementById('main-desktop-area');
            const taskbarIconsContainer = document.getElementById('taskbar-icons');
            const desktopIconsContainer = document.getElementById('desktop-icons-container');
            const desktopBackground = document.getElementById('desktop-background');
            const contextMenu = document.getElementById('context-menu'); // Get context menu element
            let highestZIndex = 5;

            const openWindowsMap = new Map(); // Stores references to open .os-window elements
            const openStandaloneAppsMap = new Map(); // Stores references to open standalone app elements (like music player)


            console.log('核心DOM元素和变量已初始化。');

            /**
             * @function updateCursors
             * @description Dynamically updates CSS custom properties for cursors based on paths defined in ASSETS.
             */
            function updateCursors() {
                const root = document.documentElement;
                root.style.setProperty('--cursor-default', `url('${getAssetUrl('cursor_default')}'), auto`);
                root.style.setProperty('--cursor-active', `url('${getAssetUrl('cursor_active')}'), auto`);
                root.style.setProperty('--cursor-pointer', `url('${getAssetUrl('cursor_pointer')}'), auto`);
                const grabElements = document.querySelectorAll('.os-window-title-bar');
                grabElements.forEach(el => {
                    el.style.cursor = `url('${getAssetUrl('cursor_grab')}') 12 12, grab`;
                });
                console.log('自定义光标已更新。');
            }

            /**
             * @function renderDynamicAssets
             * @description Iterates through all placeholder elements with `data-asset-key` attribute and replaces them with `<img>` tags, loading the corresponding images.
             */
            function renderDynamicAssets() {
                document.querySelectorAll('.icon-placeholder[data-asset-key]').forEach(placeholder => {
                    const assetKey = placeholder.dataset.assetKey;
                    const iconUrl = getAssetUrl(assetKey);
                    if (iconUrl) {
                        if (placeholder.querySelector('img')) {
                            placeholder.querySelector('img').src = iconUrl;
                        } else {
                            const img = document.createElement('img');
                            img.src = iconUrl;
                            img.alt = assetKey.replace('icon_', '').replace(/_/g, ' ');
                            img.classList.add('icon-image');
                            placeholder.innerHTML = '';
                            placeholder.appendChild(img);
                        }
                    } else {
                        console.warn(`未找到键名为 "${assetKey}" 的资产。`);
                        placeholder.innerHTML = '⚠️';
                    }
                });

                const desktopBgImage = getAssetUrl('desktop_background_image');
                if (desktopBgImage && desktopBackground) {
                    desktopBackground.style.setProperty('--desktop-image-url', `url('${desktopBgImage}')`);
                    desktopBackground.classList.add('desktop-background-image-active');
                } else if (desktopBackground) {
                    desktopBackground.classList.remove('desktop-background-image-active');
                    desktopBackground.classList.add('desktop-background');
                    desktopBackground.style.removeProperty('--desktop-image-url');
                    desktopBackground.style.backgroundImage = `
                        radial-gradient(circle at 10% 90%, rgba(0,191,255,0.3) 0%, transparent 45%),
                        radial-gradient(circle at 90% 10%, rgba(0,191,255,0.3) 0%, transparent 45%),
                        radial-gradient(ellipse at center, rgba(0,122,204,0.15) 0%, transparent 55%),
                        linear-gradient(to bottom right, #3A92CE, #CCEEFF)
                    `;
                    desktopBackground.style.opacity = '0.95';
                    desktopBackground.style.filter = 'brightness(0.9) contrast(1.1)';
                }
            }

            /**
             * @function updateUIForLanguage
             * @description Updates all UI text based on the current language setting.
             */
            function updateUIForLanguage() {
                const langData = LANG_CONTENT[currentLanguage];

                const profileNameElement = startMenu.querySelector('[data-lang-key="profileName"]');
                if (profileNameElement) {
                    profileNameElement.textContent = langData.profileName;
                }

                document.querySelectorAll('.desktop-icon').forEach(icon => {
                    const langKey = icon.querySelector('.desktop-icon-label').dataset.langKey;
                    if (langKey && langData[langKey]) {
                        icon.querySelector('.desktop-icon-label').textContent = langData[langKey];
                    }
                    icon.dataset.title = icon.dataset[`title-${currentLanguage}`];
                });

                document.querySelectorAll('.start-menu-item').forEach(item => {
                    const langKey = item.dataset.langKey;
                    const labelSpan = item.querySelector('.menu-item-label');
                    if (labelSpan && langData[langKey]) {
                        labelSpan.textContent = langData[langKey]; 
                    }
                });

                document.querySelectorAll('.start-menu-footer-button').forEach(button => {
                    const langKey = button.dataset.langKey;
                    if (langKey && langData[langKey]) {
                        button.title = langData[langKey];
                    }
                });
                
                reopenAllWindows();
                renderDynamicAssets();
            }

            /**
             * @function getWindowTitles
             * @description Generates window titles in both Chinese and English based on the section and optional content.
             */
            function getWindowTitles(section, currentItem = null) {
                let chineseTitle = LANG_CONTENT['zh']?.unknownModule || 'Untitled Window';
                let englishTitle = LANG_CONTENT['en']?.unknownModule || 'Untitled Window';

                if (section.startsWith('file-content-') && currentItem) {
                    chineseTitle = currentItem.title + (LANG_CONTENT['zh']?.worksDetailsSuffix || ''); // Reusing worksDetailsSuffix for simplicity
                    englishTitle = currentItem.title + (LANG_CONTENT['en']?.worksDetailsSuffix || ''); 
                } else {
                    const desktopIcon = document.querySelector(`.desktop-icon[data-section="${section}"]`);
                    
                    if (desktopIcon) {
                        chineseTitle = desktopIcon.dataset.titleZh;
                        englishTitle = desktopIcon.dataset.titleEn;
                    } else if (LANG_CONTENT['zh'][`${section}MenuItem`]) {
                        chineseTitle = LANG_CONTENT['zh'][`${section}MenuItem`]; 
                        englishTitle = LANG_CONTENT['en'][`${section}MenuItem`]; 
                    } else if (section === 'about') {
                        chineseTitle = LANG_CONTENT['zh'].aboutTitle;
                        englishTitle = LANG_CONTENT['en'].aboutTitle;
                    } else if (section === 'settings') {
                        chineseTitle = LANG_CONTENT['zh'].settings.title; 
                        englishTitle = LANG_CONTENT['en'].settings.title; 
                    } else if (section === 'shutdown') {
                        chineseTitle = LANG_CONTENT['zh'].shutdownMenuItem; 
                        englishTitle = LANG_CONTENT['en'].shutdownMenuItem; 
                    } else if (section === 'data-core') { 
                        chineseTitle = LANG_CONTENT['zh'].datacoreTitle;
                        englishTitle = LANG_CONTENT['en'].datacoreTitle;
                    } else if (section === 'music-player') {
                        chineseTitle = LANG_CONTENT['zh'].musicPlayerMenuItem;
                        englishTitle = LANG_CONTENT['en'].musicPlayerMenuItem;
                    } else if (section === 'folder') {
                        chineseTitle = LANG_CONTENT['zh'].folderMenuItem;
                        englishTitle = LANG_CONTENT['en'].folderMenuItem;
                    } else if (section === 'log') {
                        chineseTitle = LANG_CONTENT['zh'].logMenuItem;
                        englishTitle = LANG_CONTENT['en'].logMenuItem;
                    }
                }
                return { chineseTitle, englishTitle };
            }

            /**
             * @function reopenAllWindows
             * @description Re-opens all currently active windows and standalone apps to update their content based on the current language.
             */
            async function reopenAllWindows() {
                const activeWindowsData = [];
                // Collect data for regular windows
                document.querySelectorAll('.os-window').forEach(win => {
                    if (!win.classList.contains('minimized')) {
                        activeWindowsData.push({
                            type: 'window',
                            section: win.dataset.section,
                            windowId: win.dataset.windowId,
                            originalLeft: win.dataset.originalLeft,
                            originalTop: win.dataset.originalTop,
                            originalWidth: win.dataset.originalWidth,
                            originalHeight: win.dataset.originalHeight,
                            isMaximized: win.classList.contains('maximized')
                        });
                    }
                    win.remove();
                });
                // Collect data for standalone apps (music player)
                document.querySelectorAll('.music-player-standalone').forEach(app => {
                    activeWindowsData.push({
                        type: 'standalone',
                        section: app.dataset.section,
                        windowId: app.dataset.windowId,
                        originalLeft: app.style.left,
                        originalTop: app.style.top,
                        originalWidth: app.style.width,
                        originalHeight: app.style.height,
                    });
                    app.remove();
                });

                taskbarIconsContainer.innerHTML = '';
                openWindowsMap.clear();
                openStandaloneAppsMap.clear();

                for (const winData of activeWindowsData) {
                    let contentHTML = '';
                    let isMarkdown = false;
                    let data = null;

                    try {
                        data = await fetchContent(winData.section);
                    } catch (error) {
                        console.error(`${LANG_CONTENT[currentLanguage]?.errorLoadingContent} ${winData.section}:`, error);
                        contentHTML = `<p class="text-xl text-red-400">${LANG_CONTENT[currentLanguage]?.errorLoadingContent} ${error.message || LANG_CONTENT[currentLanguage]?.unknownModule}</p>`;
                        await openWindow(winData.section, 'Error', 'Error', contentHTML, winData.windowId, winData);
                        continue;
                    }

                    const { chineseTitle, englishTitle } = getWindowTitles(winData.section, null);

                    if (winData.type === 'standalone') {
                         await openStandaloneApp(winData.section, chineseTitle, englishTitle, winData.windowId, winData);
                    } else {
                        switch (winData.section) {
                            case 'folder':
                                contentHTML = renderFolderContent(APP_DATA.folder, winData.windowId); // Pass windowId here
                                break;
                            case 'log':
                                contentHTML = renderLogContent(data);
                                break;
                            case 'about':
                                contentHTML = LANG_CONTENT[currentLanguage]?.aboutContent;
                                isMarkdown = true;
                                break;
                            case 'data-core':
                                contentHTML = renderDataCoreContent(data, chineseTitle); // Re-render Data Core content
                                break;
                            case 'settings':
                                contentHTML = renderSettingsContent(data);
                                break;
                            case 'shutdown':
                                contentHTML = renderShutdownContent();
                                break;
                            default: // For dynamically opened file content windows
                                if (winData.section.startsWith('file-content-')) {
                                    const fileName = winData.section.replace('file-content-', '');
                                    const file = findFileInFolder(APP_DATA.folder, fileName);
                                    if (file) {
                                        contentHTML = marked.parse(file.content);
                                        isMarkdown = true;
                                    } else {
                                        contentHTML = `<p class="text-xl text-red-400">文件未找到：${fileName}</p>`;
                                    }
                                } else {
                                    contentHTML = `<p class="text-xl text-red-400">${LANG_CONTENT[currentLanguage]?.unknownModule || 'Unknown Module'}</p>`;
                                }
                        }
                        const newWindowElement = await openWindow(winData.section, chineseTitle, englishTitle, contentHTML, winData.windowId, winData, isMarkdown);

                        if (winData.isMaximized) {
                            newWindowElement.classList.add('maximized');
                            newWindowElement.style.borderRadius = '0';
                            newWindowElement.style.boxShadow = 'none';
                        }
                        if (winData.isMinimized) {
                            newWindowElement.classList.add('minimized');
                        }
                    }
                }
            }


            // --- Desktop Icon Positioning Logic ---
            function positionDesktopIcons() {
                const iconWidth = 100;
                const iconHeight = 100;
                const paddingX = 20;
                const paddingY = 20;
                const gapX = 20;
                const gapY = 20;

                const icons = Array.from(desktopIconsContainer.children);
                let currentX = paddingX;
                let currentY = paddingY;
                let column = 0;

                icons.forEach((icon, index) => {
                    if (currentY + iconHeight > mainDesktopArea.clientHeight - (paddingY + 10)) {
                        column++;
                        currentX = paddingX + (column * (iconWidth + gapX));
                        currentY = paddingY;
                    }

                    icon.style.left = `${currentX}px`;
                    icon.style.top = `${currentY}px`;
                    currentY += (iconHeight + gapY);
                });
            }

            positionDesktopIcons();
            window.addEventListener('resize', positionDesktopIcons);


            // --- Mock Data Fetching ---
            async function fetchContent(section) {
                console.log(`正在获取 ${currentLanguage} 语言的 ${section} 内容...`);
                await new Promise(resolve => setTimeout(resolve, 300)); 

                switch (section) {
                    case 'folder':
                        return APP_DATA.folder; // Return the current mock file system
                    case 'log':
                        return APP_DATA.log.map(entry => ({
                            ...entry,
                            type: LANG_CONTENT[currentLanguage][`logType${entry.type.charAt(0).toUpperCase() + entry.type.slice(1)}`] || entry.type
                        }));
                    case 'about':
                        return {
                            title: LANG_CONTENT[currentLanguage].aboutTitle,
                            content: LANG_CONTENT[currentLanguage].aboutContent
                        };
                    case 'music-player':
                        return APP_DATA.music;
                    // case 'browser': // Removed browser as per request
                    //     return {}; 
                    case 'data-core':
                        return APP_DATA.datacore;
                    case 'settings': 
                        return LANG_CONTENT[currentLanguage].settings;
                    case 'shutdown':
                        return null;
                    default:
                        return null;
                }
            }

            /**
             * @function setActiveTaskbarIcon
             * @description Sets the active state for a taskbar icon.
             */
            function setActiveTaskbarIcon(windowId) {
                document.querySelectorAll('.taskbar-minimized-icon').forEach(icon => {
                    if (icon.dataset.windowId === windowId) {
                        icon.classList.add('active');
                    } else {
                        icon.classList.remove('active');
                    }
                });
            }

            /**
             * @function bringToFront
             * @description Brings a specified window element (regular or standalone) to the front of the stacking order.
             */
            function bringToFront(element) {
                highestZIndex++;
                element.style.zIndex = highestZIndex;
                console.log(`元素 "${element.dataset.windowId}" 已置于最前。新z-index: ${highestZIndex}`);
                setActiveTaskbarIcon(element.dataset.windowId);

                // Deactivate all other window title bars, activate current
                document.querySelectorAll('.os-window-title-bar').forEach(bar => bar.classList.add('inactive'));
                const titleBar = element.querySelector('.os-window-title-bar');
                if (titleBar) {
                    titleBar.classList.remove('inactive');
                }
                const statusBarTextElement = element.querySelector('.os-window-status-bar .status-text');
                if (statusBarTextElement) {
                    statusBarTextElement.textContent = LANG_CONTENT[currentLanguage].statusBarStatusReady;
                }
            }

            /**
             * @function openWindow
             * @description Creates and opens a new *regular* window or brings an existing one to the front.
             * @param {string} section - The section identifier this window belongs to.
             * @param {string} chineseTitle - The Chinese title for the window.
             * @param {string} englishTitle - The English title for the window.
             * @param {string} contentHTML - The HTML content to display inside the window.
             * @param {string} [windowId=section] - A unique ID for this specific window instance.
             * @param {Object} [initialProps={}] - Initial position and size properties (left, top, width, height).
             * @param {boolean} [isMarkdown=false] - Whether the contentHTML should be parsed as Markdown.
             */
            async function openWindow(section, chineseTitle, englishTitle, contentHTML, windowId = section, initialProps = {}, isMarkdown = false) {
                console.log(`尝试打开窗口：${chineseTitle} [${englishTitle}] (部分：${section}，ID：${windowId}，Markdown：${isMarkdown}`);

                let existingWindow = openWindowsMap.get(windowId);
                if (existingWindow) {
                    bringToFront(existingWindow);
                    if (existingWindow.classList.contains('minimized')) {
                        restoreWindow(existingWindow);
                    }
                    return existingWindow;
                }

                const windowElement = document.createElement('div');
                windowElement.classList.add('os-window');
                windowElement.dataset.section = section;
                windowElement.dataset.windowId = windowId;
                
                const desktopWidth = mainDesktopArea.offsetWidth;
                const desktopHeight = mainDesktopArea.offsetHeight;

                let defaultWidth, defaultHeight, offsetX, offsetY;

                if (window.innerWidth <= 768) {
                    defaultWidth = window.innerWidth * 0.95;
                    defaultHeight = window.innerHeight * 0.8;
                    offsetX = (window.innerWidth - defaultWidth) / 2;
                    offsetY = (window.innerHeight - defaultHeight) / 2 - (parseFloat(getComputedStyle(document.documentElement).getPropertyValue('--taskbar-height')) || 48) / 2;
                } else {
                    defaultWidth = Math.min(desktopWidth * 0.7, 800);
                    defaultHeight = Math.min(desktopHeight * 0.7, 600);
                    const openWindows = document.querySelectorAll('.os-window:not(.minimized)');
                    offsetX = 50 * (openWindows.length % 5);
                    offsetY = 50 * (openWindows.length % 5);
                    offsetX += (desktopWidth / 2 - defaultWidth / 2);
                    offsetY += (desktopHeight / 2 - defaultHeight / 2);
                }

                windowElement.style.width = initialProps.width || `${defaultWidth}px`;
                windowElement.style.height = initialProps.height || `${defaultHeight}px`;
                windowElement.style.left = initialProps.left || `${offsetX}px`;
                windowElement.style.top = initialProps.top || `${offsetY}px`;

                if (parseFloat(windowElement.style.left) + parseFloat(windowElement.style.width) > desktopWidth) {
                    windowElement.style.left = `${desktopWidth - parseFloat(windowElement.style.width) - 20}px`;
                }
                if (parseFloat(windowElement.style.top) + parseFloat(windowElement.style.height) > desktopHeight) {
                    windowElement.style.top = `${desktopHeight - parseFloat(windowElement.style.height) - 20}px`;
                }

                windowElement.dataset.originalLeft = windowElement.style.left;
                windowElement.dataset.originalTop = windowElement.style.top;
                windowElement.dataset.originalWidth = windowElement.style.width;
                windowElement.dataset.originalHeight = windowElement.style.height;

                bringToFront(windowElement);
                console.log(`新窗口 "${windowId}" 创建于 left: ${windowElement.style.left}, top: ${windowElement.style.top}`);

                const finalContent = isMarkdown ? marked.parse(contentHTML) : contentHTML;
                const contentClass = isMarkdown ? 'markdown-content' : '';

                const fullTitle = `${chineseTitle} [${englishTitle}]`;
                windowElement.dataset.windowTitle = fullTitle;

                windowElement.innerHTML = `
                    <div class="os-window-title-bar">
                        <div class="os-window-title-content">
                            <span class="icon-placeholder" data-asset-key="${section === 'folder' ? 'icon_folder' : section === 'log' ? 'icon_log' : 'icon_mazko_logo'}"></span>
                            <span class="os-window-title">${fullTitle}</span>
                        </div>
                        <div class="os-window-controls">
                            <div class="control-button minimize" title="最小化">
                                <span class="icon-placeholder" data-asset-key="icon_minus"></span>
                            </div>
                            <div class="control-button maximize" title="最大化">
                                <span class="icon-placeholder" data-asset-key="icon_square"></span>
                            </div>
                            <div class="control-button close" title="关闭">
                                <span class="icon-placeholder" data-asset-key="icon_times"></span>
                            </div>
                        </div>
                    </div>
                    <div class="os-window-content ${contentClass}">
                        ${finalContent}
                    </div>
                    <div class="os-window-status-bar">
                        <span class="status-text">${LANG_CONTENT[currentLanguage].statusBarStatusReady}</span>
                        <span class="system-branding-text">${LANG_CONTENT[currentLanguage].statusBarBranding}</span>
                    </div>
                `;

                mainDesktopArea.appendChild(windowElement);
                console.log(`窗口 "${windowId}" 已附加到主桌面区域。`);
                renderDynamicAssets();

                openWindowsMap.set(windowId, windowElement);
                createTaskbarIcon(windowElement, chineseTitle, windowId);

                const titleBar = windowElement.querySelector('.os-window-title-bar');
                const statusBarTextElement = windowElement.querySelector('.os-window-status-bar .status-text');
                let isDraggingWindow = false;
                let offsetXWindow, offsetYWindow;

                if (titleBar) {
                    titleBar.addEventListener('mousedown', (e) => {
                        if (windowElement.classList.contains('maximized')) return; // Prevent dragging when maximized
                        isDraggingWindow = true;
                        offsetXWindow = e.clientX - windowElement.getBoundingClientRect().left;
                        offsetYWindow = e.clientY - windowElement.getBoundingClientRect().top;
                        titleBar.style.cursor = 'grabbing';
                        bringToFront(windowElement);
                        if (statusBarTextElement) {
                            statusBarTextElement.textContent = LANG_CONTENT[currentLanguage].statusBarStatusDragging;
                        }
                        console.log(`开始拖动窗口 "${windowId}"。`);
                    });
                } else {
                    console.error(`未找到窗口 "${windowId}" 的标题栏。拖动已禁用。`);
                }

                document.addEventListener('mousemove', (e) => {
                    if (!isDraggingWindow) return;
                    let newX = e.clientX - offsetXWindow;
                    let newY = e.clientY - offsetYWindow;

                    const parentRect = mainDesktopArea.getBoundingClientRect();
                    const windowRect = windowElement.getBoundingClientRect();

                    const minX = 0;
                    const minY = 0;
                    const maxX = parentRect.width - windowRect.width;
                    const maxY = parentRect.height - windowRect.height;

                    newX = Math.max(minX, Math.min(newX, maxX));
                    newY = Math.max(minY, Math.min(newY, maxY));

                    windowElement.style.left = `${newX}px`;
                    windowElement.style.top = `${newY}px`;
                });

                document.addEventListener('mouseup', () => {
                    if (isDraggingWindow) {
                        isDraggingWindow = false;
                        if (titleBar) titleBar.style.cursor = 'grab';
                        if (statusBarTextElement) {
                            statusBarTextElement.textContent = LANG_CONTENT[currentLanguage].statusBarStatusReady;
                        }
                        console.log(`停止拖动窗口 "${windowId}"。`);
                    }
                });

                const closeButton = windowElement.querySelector('.control-button.close');
                const minimizeButton = windowElement.querySelector('.control-button.minimize');
                const maximizeButton = windowElement.querySelector('.control-button.maximize');

                if (closeButton) {
                    closeButton.addEventListener('click', () => {
                        windowElement.remove();
                        openWindowsMap.delete(windowId);
                        const taskbarIcon = document.querySelector(`.taskbar-minimized-icon[data-window-id="${windowId}"]`);
                        if (taskbarIcon) {
                            taskbarIcon.remove();
                        }
                        console.log(`窗口 "${windowId}" 已关闭。`);
                    });
                } else {
                    console.error(`未找到窗口 "${windowId}" 的关闭按钮。`);
                }

                if (minimizeButton) {
                    minimizeButton.addEventListener('click', () => {
                        minimizeWindow(windowElement, chineseTitle, windowId);
                    });
                }
                if (maximizeButton) {
                    maximizeButton.addEventListener('click', () => {
                        toggleMaximizeWindow(windowElement);
                    });
                }

                windowElement.addEventListener('mousedown', (e) => {
                    // Only bring to front if clicking on the window itself, not children like input fields
                    if (e.target.closest('.os-window') === windowElement || e.target.closest('.os-window-title-bar') === titleBar) {
                        bringToFront(windowElement);
                    }
                });

                // Attach specific event listeners based on section
                // Using a setTimeout of 0ms to allow the DOM to fully render the innerHTML
                // before querying for elements inside it.
                setTimeout(() => {
                    if (section === 'folder') {
                        attachFolderListeners(windowElement, APP_DATA.folder, windowId); // Pass windowId here
                    }
                    else if (section === 'data-core') {
                        attachDataCoreListeners(windowElement);
                    }
                }, 0); // 0ms timeout

                return windowElement;
            }

            /**
             * @function openStandaloneApp
             * @description Creates and opens a new *standalone* app (like the music player) or brings an existing one to the front.
             * This function is designed for apps that do NOT use the standard os-window frame.
             * @param {string} section - The section identifier this app belongs to (e.g., 'music-player').
             * @param {string} chineseTitle - The Chinese title for the app (for taskbar).
             * @param {string} englishTitle - The English title for the app (for taskbar).
             * @param {string} [appId=section] - A unique ID for this specific app instance.
             * @param {Object} [initialProps={}] - Initial position and size properties (left, top, width, height).
             */
            async function openStandaloneApp(section, chineseTitle, englishTitle, appId = section, initialProps = {}) {
                console.log(`尝试打开独立应用：${chineseTitle} [${englishTitle}] (部分：${section}，ID：${appId})`);

                let existingApp = openStandaloneAppsMap.get(appId);
                if (existingApp) {
                    bringToFront(existingApp);
                    if (existingApp.classList.contains('minimized')) { // Standalone apps can also be minimized
                        restoreWindow(existingApp);
                    }
                    return existingApp;
                }

                let appElement;
                let contentHTML = '';

                const desktopWidth = mainDesktopArea.offsetWidth;
                const desktopHeight = mainDesktopArea.offsetHeight;

                let defaultWidth, defaultHeight, offsetX, offsetY;

                if (window.innerWidth <= 768) {
                    defaultWidth = window.innerWidth * 0.95;
                    defaultHeight = window.innerHeight * 0.8; // Allow more flexible height
                    offsetX = (window.innerWidth - defaultWidth) / 2;
                    offsetY = (window.innerHeight - defaultHeight) / 2 - (parseFloat(getComputedStyle(document.documentElement).getPropertyValue('--taskbar-height')) || 48) / 2;
                } else {
                    defaultWidth = 360; // Fixed width for MP3 player
                    defaultHeight = 500; // Fixed height for MP3 player
                    const openApps = document.querySelectorAll('.music-player-standalone:not(.minimized)');
                    offsetX = 50 * (openApps.length % 5);
                    offsetY = 50 * (openApps.length % 5);
                    offsetX += (desktopWidth / 2 - defaultWidth / 2);
                    offsetY += (desktopHeight / 2 - defaultHeight / 2);
                }

                // Music Player specific content
                if (section === 'music-player') {
                    appElement = document.createElement('div');
                    appElement.classList.add('music-player-standalone');
                    appElement.dataset.section = section;
                    appElement.dataset.windowId = appId; // Using windowId for consistency with taskbar
                    
                    contentHTML = `
                        <div class="drag-handle">
                             <div class="control-button close-button-custom" title="关闭">
                                &times;
                            </div>
                        </div>
                        <div class="mp3-player-skin">
                            <div class="mp3-display">
                                <span class="mp3-song-title">${LANG_CONTENT[currentLanguage].noSongSelected}</span>
                            </div>
                            <div class="mp3-progress-container">
                                <div class="mp3-progress-bar" style="width: 0%;"></div>
                            </div>
                            <div class="mp3-controls">
                                <button class="mp3-control-button" id="prev-song-button">
                                    <span class="icon-placeholder" data-asset-key="icon_prev_track"></span>
                                </button>
                                <button class="mp3-control-button" id="play-pause-button">
                                    <span class="icon-placeholder" data-asset-key="icon_play"></span>
                                </button>
                                <button class="mp3-control-button" id="next-song-button">
                                    <span class="icon-placeholder" data-asset-key="icon_next_track"></span>
                                </button>
                            </div>
                            <div class="mp3-mode-buttons">
                                <button class="mp3-mode-button active-mode" data-mode="loop">${LANG_CONTENT[currentLanguage].playbackModeLoop}</button>
                                <button class="mp3-mode-button" data-mode="shuffle">${LANG_CONTENT[currentLanguage].playbackModeShuffle}</button>
                                <button class="mp3-mode-button" data-mode="repeat-one">${LANG_CONTENT[currentLanguage].playbackModeRepeatOne}</button>
                            </div>
                            <div class="mp3-playlist">
                                <h4 class="font-bold mb-2">${LANG_CONTENT[currentLanguage].playlist}:</h4>
                                <ul>
                                    ${APP_DATA.music.map((song, index) => `
                                        <li data-index="${index}" class="${index === currentSongIndex ? 'active-song' : ''}">${song.title} - ${song.artist}</li>
                                    `).join('')}
                                </ul>
                            </div>
                        </div>
                    `;
                } else {
                    // Fallback for unexpected standalone app type
                    appElement = document.createElement('div');
                    appElement.classList.add('os-window'); // Revert to regular window for safety
                    appElement.dataset.section = section;
                    appElement.dataset.windowId = appId;
                    contentHTML = `<p class="text-xl text-red-400">${LANG_CONTENT[currentLanguage]?.unknownModule || 'Unknown Module'}</p>`;
                }

                appElement.style.width = initialProps.width || `${defaultWidth}px`;
                appElement.style.height = initialProps.height || `${defaultHeight}px`;
                appElement.style.left = initialProps.left || `${offsetX}px`;
                appElement.style.top = initialProps.top || `${offsetY}px`;

                // Adjust position if it goes off screen
                if (parseFloat(appElement.style.left) + parseFloat(appElement.style.width) > desktopWidth) {
                    appElement.style.left = `${desktopWidth - parseFloat(appElement.style.width) - 20}px`;
                }
                if (parseFloat(appElement.style.top) + parseFloat(appElement.style.height) > desktopHeight) {
                    appElement.style.top = `${desktopHeight - parseFloat(appElement.style.height) - 20}px`;
                }

                appElement.innerHTML = contentHTML;
                mainDesktopArea.appendChild(appElement);
                renderDynamicAssets(); // Render icons inside the new app

                bringToFront(appElement);
                openStandaloneAppsMap.set(appId, appElement);
                createTaskbarIcon(appElement, chineseTitle, appId); // Create taskbar icon for standalone app

                // Attach drag and close listeners for standalone app
                if (section === 'music-player') {
                    const dragHandle = appElement.querySelector('.drag-handle');
                    const closeButton = appElement.querySelector('.close-button-custom');
                    let isDraggingApp = false;
                    let offsetXApp, offsetYApp;

                    if (dragHandle) {
                        dragHandle.addEventListener('mousedown', (e) => {
                            isDraggingApp = true;
                            offsetXApp = e.clientX - appElement.getBoundingClientRect().left;
                            offsetYApp = e.clientY - appElement.getBoundingClientRect().top;
                            dragHandle.style.cursor = 'grabbing';
                            bringToFront(appElement);
                        });
                    }

                    document.addEventListener('mousemove', (e) => {
                        if (!isDraggingApp) return;
                        let newX = e.clientX - offsetXApp;
                        let newY = e.clientY - offsetYApp;

                        const parentRect = mainDesktopArea.getBoundingClientRect();
                        const appRect = appElement.getBoundingClientRect();

                        const minX = 0;
                        const minY = 0;
                        const maxX = parentRect.width - appRect.width;
                        const maxY = parentRect.height - appRect.height;

                        newX = Math.max(minX, Math.min(newX, maxX));
                        newY = Math.max(minY, Math.min(newY, maxY));

                        appElement.style.left = `${newX}px`;
                        appElement.style.top = `${newY}px`;
                    });

                    document.addEventListener('mouseup', () => {
                        if (isDraggingApp) {
                            isDraggingApp = false;
                            if (dragHandle) dragHandle.style.cursor = 'grab';
                        }
                    });

                    if (closeButton) {
                        closeButton.addEventListener('click', () => {
                            appElement.remove();
                            openStandaloneAppsMap.delete(appId);
                            const taskbarIcon = document.querySelector(`.taskbar-minimized-icon[data-window-id="${appId}"]`);
                            if (taskbarIcon) {
                                taskbarIcon.remove();
                            }
                            // Stop any active music playback if this is the music player
                            currentAudio.pause();
                            currentAudio.currentTime = 0;
                            clearInterval(scrollingTextInterval); // Stop text scrolling
                            console.log(`独立应用 "${appId}" 已关闭。`);
                        });
                    }

                    // Attach music player specific listeners
                    attachMusicPlayerListeners(appElement, APP_DATA.music);
                }

                appElement.addEventListener('mousedown', () => {
                     bringToFront(appElement);
                });

                return appElement;
            }


            /**
             * @function createTaskbarIcon
             * @description Creates and appends a taskbar icon for a given window or standalone app.
             */
            function createTaskbarIcon(element, title, windowId) {
                let taskbarIcon = document.querySelector(`.taskbar-minimized-icon[data-window-id="${windowId}"]`);
                if (!taskbarIcon) {
                    taskbarIcon = document.createElement('div');
                    taskbarIcon.classList.add('taskbar-minimized-icon');
                    taskbarIcon.dataset.windowId = windowId;

                    let displayTitle = String(title || 'Untitled');
                    const section = element.dataset.section;

                    const langData = LANG_CONTENT[currentLanguage];
                    if (langData && section) {
                        if (langData[`${section}MenuItem`]) {
                            displayTitle = langData[`${section}MenuItem`];
                        } else if (section === 'about' && langData.mazkoExeIcon) {
                            displayTitle = langData.mazkoExeIcon;
                        } else if (section === 'data-core') {
                            displayTitle = langData.datacoreIcon;
                        } else if (section === 'music-player') {
                            displayTitle = langData.musicPlayerIcon;
                        } else if (section === 'folder') {
                            displayTitle = langData.folderIcon;
                        } else if (section === 'log') {
                            displayTitle = langData.logIcon;
                        }
                    }
                    displayTitle = displayTitle.trim() || 'Untitled';

                    let iconKey = 'icon_window_restore'; // Default icon
                    if (section === 'folder') iconKey = 'icon_folder';
                    else if (section === 'log') iconKey = 'icon_log';
                    else if (section === 'music-player') iconKey = 'icon_music_player';
                    else if (section === 'about') iconKey = 'icon_mazko_logo';
                    else if (section === 'data-core') iconKey = 'icon_datacore';
                    // For file content windows, use a generic file icon
                    else if (section.startsWith('file-content-')) iconKey = 'icon_file';

                    taskbarIcon.innerHTML = `<span class="icon-placeholder" data-asset-key="${iconKey}"></span> <span>${displayTitle}</span>`;
                    taskbarIconsContainer.appendChild(taskbarIcon);
                    renderDynamicAssets();

                    taskbarIcon.addEventListener('click', () => {
                        restoreWindow(element);
                    });
                }
                setActiveTaskbarIcon(windowId);
            }

            /**
             * @function minimizeWindow
             * @description Minimizes a given window or standalone app.
             */
            function minimizeWindow(element) {
                element.classList.add('minimized');
                console.log(`元素 "${element.dataset.windowId}" 已最小化。`);
                setActiveTaskbarIcon(element.dataset.windowId); 
            }

            /**
             * @function restoreWindow
             * @description Restores a minimized or maximized window/standalone app to its original size and position.
             */
            function restoreWindow(element) {
                element.classList.remove('minimized');
                element.classList.remove('maximized'); // Only applies to regular windows
                // Regular window restoration
                if (element.classList.contains('os-window')) {
                    element.style.width = element.dataset.originalWidth;
                    element.style.height = element.dataset.originalHeight;
                    element.style.left = element.dataset.originalLeft;
                    element.style.top = element.dataset.originalTop;
                    element.style.borderRadius = '12px';
                    element.style.boxShadow = 'var(--glass-glow), var(--glass-inset-shadow)'; 
                } else if (element.classList.contains('music-player-standalone')) {
                    // Standalone app restoration (they don't have original dimensions stored as dataset props yet)
                    // For music player, it's fixed size, so just ensure it's visible.
                    const desktopWidth = mainDesktopArea.offsetWidth;
                    const desktopHeight = mainDesktopArea.offsetHeight;
                    element.style.width = '360px';
                    element.style.height = '500px';
                    // Re-center if it moved
                    element.style.left = `${(desktopWidth / 2) - 180}px`;
                    element.style.top = `${(desktopHeight / 2) - 250}px`;
                }

                bringToFront(element);
                console.log(`元素 "${element.dataset.windowId}" 已恢复。`);
                setActiveTaskbarIcon(element.dataset.windowId);
            }

            /**
             * @function toggleMaximizeWindow
             * @description Toggles the maximized state of a regular window.
             */
            function toggleMaximizeWindow(windowElement) {
                if (windowElement.classList.contains('music-player-standalone')) {
                    return; // Standalone apps cannot be maximized in this way
                }

                if (windowElement.classList.contains('maximized')) {
                    windowElement.classList.remove('maximized');
                    windowElement.style.width = windowElement.dataset.originalWidth;
                    windowElement.style.height = windowElement.dataset.originalHeight;
                    windowElement.style.left = windowElement.dataset.originalLeft;
                    windowElement.style.top = windowElement.dataset.originalTop;
                    windowElement.style.borderRadius = '12px';
                    windowElement.style.boxShadow = 'var(--glass-glow), var(--glass-inset-shadow)'; 
                    console.log(`窗口 "${windowElement.dataset.windowId}" 已从最大化恢复。`);
                } else {
                    if (!windowElement.dataset.originalLeft) {
                        windowElement.dataset.originalLeft = windowElement.style.left;
                        windowElement.dataset.originalTop = windowElement.style.top;
                        windowElement.dataset.originalWidth = windowElement.style.width;
                        windowElement.dataset.originalHeight = windowElement.style.height;
                    }
                    windowElement.classList.add('maximized');
                    console.log(`窗口 "${windowElement.dataset.windowId}" 已最大化。`);
                }
                bringToFront(windowElement);
                setActiveTaskbarIcon(windowElement.dataset.windowId);
            }

            // --- Music Player Functions ---
            function attachMusicPlayerListeners(appElement, playlist) {
                const playPauseButton = appElement.querySelector('#play-pause-button');
                const prevSongButton = appElement.querySelector('#prev-song-button');
                const nextSongButton = appElement.querySelector('#next-song-button');
                const progressBarContainer = appElement.querySelector('.mp3-progress-container');
                const progressBar = appElement.querySelector('.mp3-progress-bar');
                const songTitleDisplay = appElement.querySelector('.mp3-song-title');
                const playlistUl = appElement.querySelector('.mp3-playlist ul');
                const modeButtons = appElement.querySelectorAll('.mp3-mode-button');

                currentPlaylist = playlist; // Set the global playlist
                
                function loadSong(index) {
                    if (index >= 0 && index < currentPlaylist.length) {
                        currentSongIndex = index;
                        currentAudio.src = getAssetUrl(currentPlaylist[currentSongIndex].file);
                        songTitleDisplay.textContent = `${LANG_CONTENT[currentLanguage].nowPlaying} ${currentPlaylist[currentSongIndex].title} - ${currentPlaylist[currentSongIndex].artist}`;
                        updatePlaylistHighlight();
                        startSongTitleScrolling();
                        currentAudio.play();
                        playPauseButton.querySelector('.icon-placeholder').dataset.assetKey = 'icon_pause';
                        renderDynamicAssets(); // Update icon
                    } else {
                        songTitleDisplay.textContent = LANG_CONTENT[currentLanguage].noSongSelected;
                        currentAudio.pause();
                        currentAudio.currentTime = 0;
                        playPauseButton.querySelector('.icon-placeholder').dataset.assetKey = 'icon_play';
                        renderDynamicAssets(); // Update icon
                        stopSongTitleScrolling();
                    }
                }

                function togglePlayPause() {
                    if (currentAudio.paused) {
                        if (currentSongIndex === -1 && currentPlaylist.length > 0) {
                            loadSong(0); // Start from first song if nothing is loaded
                        } else {
                            currentAudio.play();
                        }
                        playPauseButton.querySelector('.icon-placeholder').dataset.assetKey = 'icon_pause';
                    } else {
                        currentAudio.pause();
                        playPauseButton.querySelector('.icon-placeholder').dataset.assetKey = 'icon_play';
                    }
                    renderDynamicAssets(); // Update icon
                }

                function playNextSong() {
                    if (currentPlaylist.length === 0) return;

                    if (playbackMode === 'shuffle') {
                        let newIndex;
                        do {
                            newIndex = Math.floor(Math.random() * currentPlaylist.length);
                        } while (newIndex === currentSongIndex && currentPlaylist.length > 1); // Avoid playing same song again if possible
                        loadSong(newIndex);
                    } else if (playbackMode === 'repeat-one') {
                        loadSong(currentSongIndex); // Repeat current song
                    } else { // 'loop' (default)
                        currentSongIndex = (currentSongIndex + 1) % currentPlaylist.length;
                        loadSong(currentSongIndex);
                    }
                }

                function playPrevSong() {
                    if (currentPlaylist.length === 0) return;
                    currentSongIndex = (currentSongIndex - 1 + currentPlaylist.length) % currentPlaylist.length;
                    loadSong(currentSongIndex);
                }

                function updateProgressBar() {
                    if (currentAudio.duration) {
                        const progress = (currentAudio.currentTime / currentAudio.duration) * 100;
                        progressBar.style.width = `${progress}%`;
                    } else {
                        progressBar.style.width = '0%';
                    }
                }

                function setProgress(e) {
                    const width = progressBarContainer.clientWidth;
                    const clickX = e.offsetX;
                    if (currentAudio.duration) {
                        const duration = currentAudio.duration;
                        currentAudio.currentTime = (clickX / width) * duration;
                    }
                }

                function updatePlaylistHighlight() {
                    playlistUl.querySelectorAll('li').forEach((li, idx) => {
                        if (idx === currentSongIndex) {
                            li.classList.add('active-song');
                        } else {
                            li.classList.remove('active-song');
                        }
                    });
                }

                function startSongTitleScrolling() {
                    const songTitleElement = appElement.querySelector('.mp3-song-title');
                    // Reset animation properties
                    songTitleElement.style.animation = 'none';
                    songTitleElement.offsetHeight; /* trigger reflow */
                    
                    const textWidth = songTitleElement.scrollWidth;
                    const containerWidth = songTitleElement.clientWidth;

                    if (textWidth > containerWidth) {
                        // Calculate duration based on text length to make speed consistent
                        const animationDuration = textWidth / 50; // Adjust 50 for desired speed
                        songTitleElement.style.animation = `scrollText ${animationDuration}s linear infinite`;
                        songTitleElement.style.animationPlayState = 'running';
                    } else {
                        songTitleElement.style.animation = 'none'; // No animation needed
                        songTitleElement.style.transform = 'translateX(0)';
                    }
                }

                function stopSongTitleScrolling() {
                    const songTitleElement = appElement.querySelector('.mp3-song-title');
                    songTitleElement.style.animationPlayState = 'paused';
                    songTitleElement.style.transform = 'translateX(0)'; // Reset position
                }

                // Event Listeners
                playPauseButton.addEventListener('click', togglePlayPause);
                prevSongButton.addEventListener('click', playPrevSong);
                nextSongButton.addEventListener('click', playNextSong);
                progressBarContainer.addEventListener('click', setProgress);
                currentAudio.addEventListener('timeupdate', updateProgressBar);
                currentAudio.addEventListener('ended', playNextSong); // Auto-play next song when current ends

                playlistUl.addEventListener('click', (e) => {
                    const clickedLi = e.target.closest('li');
                    if (clickedLi) {
                        const index = parseInt(clickedLi.dataset.index, 10);
                        if (!isNaN(index) && index !== currentSongIndex) {
                            loadSong(index);
                            currentAudio.play();
                        }
                    }
                });

                modeButtons.forEach(button => {
                    button.addEventListener('click', () => {
                        modeButtons.forEach(btn => btn.classList.remove('active-mode'));
                        button.classList.add('active-mode');
                        playbackMode = button.dataset.mode;
                        console.log('Playback mode:', playbackMode);
                    });
                });

                // Initial load of the first song if playlist is not empty
                if (currentPlaylist.length > 0) {
                    loadSong(0);
                    currentAudio.pause(); // Start paused
                } else {
                    songTitleDisplay.textContent = LANG_CONTENT[currentLanguage].noSongSelected;
                }
            }
            
            // Helper to find a file in the recursive folder structure
            function findFileInFolder(currentFolder, fileName) {
                for (const item of currentFolder.children) {
                    if (item.type === 'file' && item.name === fileName) {
                        return item;
                    }
                    if (item.type === 'folder') {
                        const found = findFileInFolder(item, fileName);
                        if (found) return found;
                    }
                }
                return null;
            }


            // --- Folder System Functions ---
            const folderWindowStates = new Map(); // Map to store currentPath and currentActiveFolder per window

            function renderFolderContent(folder, windowId) { // Added windowId
                const currentPath = folderWindowStates.has(windowId) ? folderWindowStates.get(windowId).currentPath : [];
                const displayedPath = currentPath.length > 0 ? currentPath.join(' / ') : '/';

                const itemsHTML = folder.children.map(item => `
                    <div class="folder-item" data-item-name="${item.name}" data-item-type="${item.type}">
                        <span class="icon-placeholder" data-asset-key="${item.type === 'folder' ? 'icon_folder_closed' : 'icon_file'}"></span>
                        <span class="folder-item-name">${item.name}</span>
                    </div>
                `).join('');

                return `
                    <h3 class="text-xl font-bold mb-4">${LANG_CONTENT[currentLanguage].folderIcon}: ${displayedPath}</h3>
                    <div class="folder-content-wrapper" id="current-folder-content-${windowId}">
                        ${itemsHTML}
                    </div>
                `;
            }

            function attachFolderListeners(windowElement, initialFolder, windowId) { // Added windowId
                const folderContentContainer = windowElement.querySelector(`#current-folder-content-${windowId}`);
                
                // Initialize or retrieve state for this specific folder window
                if (!folderWindowStates.has(windowId)) {
                    folderWindowStates.set(windowId, {
                        currentPath: [],
                        currentActiveFolder: JSON.parse(JSON.stringify(initialFolder)) // Deep copy to allow independent modification
                    });
                }
                let { currentPath, currentActiveFolder } = folderWindowStates.get(windowId);

                function updateFolderView() {
                    if (!folderContentContainer) {
                        console.error("Folder content container is null, cannot update view.");
                        return;
                    }

                    folderContentContainer.innerHTML = currentActiveFolder.children.map(item => `
                        <div class="folder-item" data-item-name="${item.name}" data-item-type="${item.type}">
                            <span class="icon-placeholder" data-asset-key="${item.type === 'folder' ? 'icon_folder_closed' : 'icon_file'}"></span>
                            <span class="folder-item-name">${item.name}</span>
                        </div>
                    `).join('');
                    
                    // Update window title based on current folder
                    const titleElement = windowElement.querySelector('.os-window-title');
                    if (titleElement) {
                        let displayedTitle = currentPath.length > 0 ? currentPath[currentPath.length - 1] : LANG_CONTENT[currentLanguage].folderMenuItem;
                        titleElement.textContent = `${LANG_CONTENT[currentLanguage].folderMenuItem} [${displayedTitle}]`;
                    }
                    renderDynamicAssets(); // Re-render icons after content update
                }

                function navigateIntoFolder(folderName) {
                    const targetFolder = currentActiveFolder.children.find(
                        item => item.name === folderName && item.type === 'folder'
                    );
                    if (targetFolder) {
                        currentPath.push(folderName);
                        currentActiveFolder = targetFolder;
                        folderWindowStates.get(windowId).currentPath = currentPath; // Update state map
                        folderWindowStates.get(windowId).currentActiveFolder = currentActiveFolder; // Update state map
                        updateFolderView();
                    }
                }

                function navigateUpFolder() {
                    if (currentPath.length > 0) {
                        currentPath.pop();
                        // Reconstruct currentActiveFolder by traversing from root of the current window's folder structure
                        let tempFolder = folderWindowStates.get(windowId).currentActiveFolder = JSON.parse(JSON.stringify(APP_DATA.folder)); // Reset to root copy
                        currentPath.forEach(name => {
                            tempFolder = tempFolder.children.find(item => item.name === name && item.type === 'folder');
                        });
                        currentActiveFolder = tempFolder;
                        folderWindowStates.get(windowId).currentPath = currentPath; // Update state map
                        folderWindowStates.get(windowId).currentActiveFolder = currentActiveFolder; // Update state map
                        updateFolderView();
                    }
                }

                function openFile(fileName) {
                    const file = currentActiveFolder.children.find(
                        item => item.name === fileName && item.type === 'file'
                    );
                    if (file && file.content) {
                        const { chineseTitle, englishTitle } = getWindowTitles('file-content', { title: file.name });
                        openWindow(`file-content-${file.name}`, chineseTitle, englishTitle, marked.parse(file.content), `file-content-${file.name}`, {}, true);
                    }
                }

                // Event listener for folder items (double click to open)
                if (folderContentContainer) { // Ensure element exists before adding listener
                    folderContentContainer.addEventListener('dblclick', (e) => {
                        const itemElement = e.target.closest('.folder-item');
                        if (itemElement) {
                            const itemName = itemElement.dataset.itemName;
                            const itemType = itemElement.dataset.itemType;
                            if (itemType === 'folder') {
                                navigateIntoFolder(itemName);
                            } else if (itemType === 'file') {
                                openFile(itemName);
                            }
                        }
                    });
                } else {
                    console.error("Folder content container is null for window:", windowId);
                }

                // Right-click context menu logic
                windowElement.addEventListener('contextmenu', (e) => {
                    e.preventDefault(); // Prevent default browser context menu
                    
                    const clickedItem = e.target.closest('.folder-item');
                    selectedFolderItem = clickedItem; // Store the clicked item

                    // Remove existing selection
                    document.querySelectorAll('.folder-item.selected').forEach(item => item.classList.remove('selected'));
                    if (clickedItem) {
                        clickedItem.classList.add('selected'); // Highlight selected item
                    }
                    
                    renderContextMenu(e.clientX, e.clientY, clickedItem);
                });

                // Hide context menu on any click outside
                document.addEventListener('click', (e) => {
                    if (!contextMenu.contains(e.target)) {
                        contextMenu.classList.add('hidden');
                        selectedFolderItem = null; // Clear selection
                        document.querySelectorAll('.folder-item.selected').forEach(item => item.classList.remove('selected'));
                    }
                });

                // Render context menu
                function renderContextMenu(x, y, targetItem) {
                    contextMenu.innerHTML = ''; // Clear previous menu items

                    if (targetItem) {
                        contextMenu.innerHTML = `
                            <div class="context-menu-item" data-action="rename">
                                <span class="icon-placeholder" data-asset-key="icon_edit"></span> ${LANG_CONTENT[currentLanguage].contextMenuRename}
                            </div>
                            <div class="context-menu-item" data-action="delete">
                                <span class="icon-placeholder" data-asset-key="icon_times"></span> ${LANG_CONTENT[currentLanguage].contextMenuDelete}
                            </div>
                            <div class="context-menu-separator"></div>
                        `;
                    }
                    
                    contextMenu.innerHTML += `
                        <div class="context-menu-item" data-action="new-folder">
                            <span class="icon-placeholder" data-asset-key="icon_plus"></span> ${LANG_CONTENT[currentLanguage].contextMenuNewFolder}
                        </div>
                        <div class="context-menu-item" data-action="new-file">
                            <span class="icon-placeholder" data-asset-key="icon_file"></span> ${LANG_CONTENT[currentLanguage].contextMenuNewFile}
                        </div>
                    `;
                    renderDynamicAssets(); // Render icons in context menu

                    contextMenu.style.left = `${x}px`;
                    contextMenu.style.top = `${y}px`;
                    contextMenu.classList.remove('hidden');

                    contextMenu.querySelectorAll('.context-menu-item').forEach(item => {
                        item.addEventListener('click', (e) => {
                            const action = e.currentTarget.dataset.action;
                            handleContextMenuItemClick(action, targetItem);
                            contextMenu.classList.add('hidden'); // Hide menu after click
                        });
                    });
                }

                // Handle context menu actions
                function handleContextMenuItemClick(action, targetItem) {
                    const currentItemName = targetItem ? targetItem.dataset.itemName : null;
                    // const currentItemType = targetItem ? targetItem.dataset.itemType : null; // Not strictly needed for logic

                    switch (action) {
                        case 'new-folder':
                            let newFolderName = prompt(LANG_CONTENT[currentLanguage].newFolderPrompt);
                            if (newFolderName) {
                                newFolderName = newFolderName.trim();
                                if (!newFolderName) {
                                    alert(LANG_CONTENT[currentLanguage].emptyNameError);
                                    return;
                                }
                                if (currentActiveFolder.children.some(item => item.name === newFolderName)) {
                                    alert(LANG_CONTENT[currentLanguage].duplicateNameError);
                                    return;
                                }
                                currentActiveFolder.children.push({ name: newFolderName, type: 'folder', children: [] });
                                updateFolderView();
                            }
                            break;
                        case 'new-file':
                            let newFileName = prompt(LANG_CONTENT[currentLanguage].renamePrompt); 
                            if (newFileName) {
                                newFileName = newFileName.trim();
                                if (!newFileName) {
                                    alert(LANG_CONTENT[currentLanguage].emptyNameError);
                                    return;
                                }
                                if (currentActiveFolder.children.some(item => item.name === newFileName)) {
                                    alert(LANG_CONTENT[currentLanguage].duplicateNameError);
                                    return;
                                }
                                currentActiveFolder.children.push({ name: newFileName, type: 'file', content: '' });
                                updateFolderView();
                            }
                            break;
                        case 'rename':
                            if (targetItem) {
                                let newName = prompt(LANG_CONTENT[currentLanguage].renamePrompt, currentItemName);
                                if (newName && newName.trim() !== currentItemName) {
                                    newName = newName.trim();
                                    if (!newName) {
                                        alert(LANG_CONTENT[currentLanguage].emptyNameError);
                                        return;
                                    }
                                    if (currentActiveFolder.children.some(item => item.name === newName && item.name !== currentItemName)) {
                                        alert(LANG_CONTENT[currentLanguage].duplicateNameError);
                                        return;
                                    }
                                    const itemToRename = currentActiveFolder.children.find(item => item.name === currentItemName);
                                    if (itemToRename) {
                                        itemToRename.name = newName;
                                        updateFolderView();
                                    }
                                }
                            }
                            break;
                        case 'delete':
                            if (targetItem && confirm(LANG_CONTENT[currentLanguage].confirmDelete.replace('{name}', currentItemName))) {
                                currentActiveFolder.children = currentActiveFolder.children.filter(item => item.name !== currentItemName);
                                updateFolderView();
                            }
                            break;
                    }
                }

                // Add an event listener to the window itself to handle keyboard navigation (e.g., Backspace for "up")
                windowElement.addEventListener('keydown', (e) => {
                    if (e.key === 'Backspace' || e.key === 'ArrowLeft') { // Backspace or Left arrow to go up
                        if (!e.target.matches('input, textarea')) { // Only if not typing in an input field
                            navigateUpFolder();
                            e.preventDefault(); // Prevent browser back navigation
                        }
                    }
                });

                updateFolderView(); // Initial render
            }

            // Render functions for integrated sections (for reopened windows)
            function renderLogContent(logData) {
                return `
                    <h2 class="text-xl font-bold mb-4">${LANG_CONTENT[currentLanguage]?.logTitle}</h2>
                    <p class="mb-4">${LANG_CONTENT[currentLanguage]?.logDescription}</p>
                    <div class="overflow-x-auto">
                        <table class="w-full text-left table-auto">
                            <thead>
                                <tr class="border-b border-matrix-green-dark">
                                    <th class="p-2">${LANG_CONTENT[currentLanguage].logEntryDate}</th>
                                    <th class="p-2">${LANG_CONTENT[currentLanguage].logEntryType}</th>
                                    <th class="p-2">${LANG_CONTENT[currentLanguage].logEntryContent}</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${logData?.map(entry => `
                                    <tr class="border-b border-matrix-dark-grey last:border-b-0">
                                        <td class="p-2">${entry.date}</td>
                                        <td class="p-2">${entry.type}</td>
                                        <td class="p-2">${entry.content}</td>
                                    </tr>
                                `).join('')}
                            </tbody>
                        </table>
                    </div>
                `;
            }

            function renderDataCoreContent(data, chineseTitle) {
                if (data && data.length > 0) {
                    return `
                        <h2 class="text-xl font-bold mb-4">${chineseTitle}</h2>
                        <p>${LANG_CONTENT[currentLanguage]?.datacoreDescription}</p>
                        <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4 mt-4">
                            ${data.map(image => `
                                <div class="flex flex-col items-center p-2 rounded-lg bg-white bg-opacity-5 hover:bg-opacity-10 transition-colors">
                                    <img src="${getAssetUrl(image.thumb_key)}" alt="${image.alt}" class="w-full h-32 object-cover rounded-md mb-2 cursor-pointer" data-full-image="${getAssetUrl(image.full_key || image.thumb_key)}">
                                    <p class="text-sm text-center opacity-90">${image.alt}</p>
                                </div>
                            `).join('')}
                        </div>
                        <div id="image-modal" class="hidden fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50 p-4">
                            <div class="relative max-w-4xl max-h-full">
                                <img id="modal-image" src="" alt="Full size image" class="max-w-full max-h-[80vh] object-contain rounded-lg shadow-xl">
                                <button id="close-modal" class="absolute top-4 right-4 text-white text-3xl font-bold p-2 rounded-full bg-red-600 hover:bg-red-700 transition-colors">&times;</button>
                            </div>
                        </div>
                    `;
                } else {
                    return `
                        <h2 class="text-xl font-bold mb-4">${chineseTitle}</h2>
                        <p>${LANG_CONTENT[currentLanguage]?.datacoreEmpty}</p>
                    `;
                }
            }

            function attachDataCoreListeners(windowElement) {
                const imageModal = windowElement.querySelector('#image-modal');
                const modalImage = windowElement.querySelector('#modal-image');
                const closeModalButton = windowElement.querySelector('#close-modal');

                windowElement.querySelectorAll('.os-window-content img[data-full-image]').forEach(img => {
                    img.addEventListener('click', (e) => {
                        modalImage.src = e.target.dataset.fullImage;
                        imageModal.classList.remove('hidden');
                    });
                });

                if (closeModalButton) {
                    closeModalButton.addEventListener('click', () => {
                        imageModal.classList.add('hidden');
                        modalImage.src = '';
                    });
                }

                if (imageModal) {
                    imageModal.addEventListener('click', (e) => {
                        if (e.target === imageModal) {
                            imageModal.classList.add('hidden');
                            modalImage.src = '';
                        }
                    });
                }
            }

            function renderSettingsContent(data) {
                return marked.parse(data?.description || '') + `
                    <div class="flex flex-col gap-4 mt-4">
                        ${data?.options.map(option => {
                            const labelText = LANG_CONTENT[currentLanguage]?.settings?.options.find(opt => opt.id === option.id)?.label || option.label;
                            if (option.type === 'toggle') {
                                return `
                                    <div class="flex items-center justify-between p-3 rounded-lg bg-white bg-opacity-5 border border-white border-opacity-20">
                                        <label for="${option.id}" class="text-lg">${labelText}</label>
                                        <label class="toggle-switch">
                                            <input type="checkbox" id="${option.id}" ${option.checked ? 'checked' : ''} ${option.disabled ? 'disabled' : ''}>
                                            <span class="toggle-slider round"></span>
                                        </label>
                                    </div>
                                `;
                            } else if (option.type === 'language-toggle') {
                                return `
                                    <div class="flex items-center justify-between p-3 rounded-lg bg-white bg-opacity-5 border border-white border-opacity-20">
                                        <span class="text-lg">${labelText}</span>
                                        <label class="toggle-switch">
                                            <input type="checkbox" id="${option.id}" ${currentLanguage === 'en' ? 'checked' : ''}>
                                            <span class="toggle-slider round"></span>
                                        </label>
                                    </div>
                                `;
                            } else if (option.type === 'button') {
                                return `
                                    <button id="${option.id}" class="py-2 px-4 rounded-lg bg-primary-blue hover:bg-dark-blue transition-colors text-white font-bold ${option.disabled ? 'opacity-50 cursor-not-allowed' : ''}" ${option.disabled ? 'disabled' : ''}>
                                        ${labelText}
                                    </button>
                                `;
                            }
                            return '';
                        }).join('')}
                    </div>
                `;
            }

            function renderShutdownContent() {
                return `
                    <h2 class="text-xl font-bold mb-4 text-red-400">${LANG_CONTENT[currentLanguage]?.shutdownMenuItem}...</h2>
                    <p>${LANG_CONTENT[currentLanguage]?.shutdownMessage}</p>
                    <p class="mt-4 opacity-70">${(LANG_CONTENT[currentLanguage]?.loadingMessage || '加载中...').replace('加载中...', '请稍候...')}</p>
                `;
            }


            // Toggle Start Menu visibility
            if (startButton && startMenu) {
                startButton.addEventListener('click', (event) => {
                    event.stopPropagation();
                    startMenu.classList.toggle('is-open'); 
                });

                document.addEventListener('click', (event) => {
                    if (!startMenu.contains(event.target) && !startButton.contains(event.target)) {
                        if (startMenu.classList.contains('is-open')) { 
                            startMenu.classList.remove('is-open');
                        }
                    }
                });
            } else {
                console.error('错误：在DOM中未找到“开始”按钮或“开始菜单”元素。请检查ID和HTML结构。');
            }

            // Handle Start Menu item clicks
            document.querySelectorAll('.start-menu-item, .start-menu-footer-button').forEach(item => {
                item.addEventListener('click', async (event) => {
                    event.preventDefault();

                    const section = item.dataset.section;
                    const { chineseTitle, englishTitle } = getWindowTitles(section);
                    
                    startMenu.classList.remove('is-open');

                    let content = '';
                    let data = null;
                    let isMarkdown = false;

                    // Special handling for standalone apps (like Music Player)
                    if (section === 'music-player') {
                        await openStandaloneApp(section, chineseTitle, englishTitle, section);
                        return; // Exit as it's not a regular window
                    }

                    // For regular windows, show loading spinner first
                    content = `
                        <div class="flex flex-col items-center justify-center h-full">
                            <div class="loading-spinner"></div>
                            <p class="mt-4 text-lg">${LANG_CONTENT[currentLanguage]?.loadingMessage}</p>
                        </div>
                    `;
                    const openedWindow = await openWindow(section, chineseTitle, englishTitle, content, section); 

                    try {
                        data = await fetchContent(section);
                    } catch (error) {
                        console.error(`${LANG_CONTENT[currentLanguage]?.errorLoadingContent} ${section}:`, error);
                        content = `<p class="text-xl text-red-400">${LANG_CONTENT[currentLanguage]?.errorLoadingContent} ${error.message || LANG_CONTENT[currentLanguage]?.unknownModule}</p>`;
                        if (openedWindow) {
                            openedWindow.querySelector('.os-window-content').innerHTML = content;
                            renderDynamicAssets();
                        }
                        return;
                    }

                    switch (section) {
                        case 'folder':
                            content = renderFolderContent(data, openedWindow.dataset.windowId); // Pass windowId here
                            isMarkdown = false;
                            if (openedWindow) {
                                openedWindow.querySelector('.os-window-content').innerHTML = content;
                                // Re-attach listeners after content update
                                setTimeout(() => {
                                    attachFolderListeners(openedWindow, data, openedWindow.dataset.windowId);
                                }, 0);
                                renderDynamicAssets();
                            }
                            break;
                        case 'log':
                            content = renderLogContent(data);
                            isMarkdown = false;
                            if (openedWindow) {
                                openedWindow.querySelector('.os-window-content').innerHTML = content;
                                renderDynamicAssets();
                            }
                            break;
                        case 'about':
                            content = data?.content;
                            isMarkdown = true;
                            if (openedWindow) {
                                openedWindow.querySelector('.os-window-content').innerHTML = marked.parse(content || '');
                                renderDynamicAssets();
                            }
                            break;
                        case 'data-core':
                            content = renderDataCoreContent(data, chineseTitle);
                            if (openedWindow) {
                                openedWindow.querySelector('.os-window-content').innerHTML = content;
                                // Re-attach listeners after content update
                                setTimeout(() => {
                                    attachDataCoreListeners(openedWindow);
                                }, 0);
                                renderDynamicAssets();
                            }
                            break;
                        case 'settings':
                            content = renderSettingsContent(data);
                            if (openedWindow) {
                                openedWindow.querySelector('.os-window-content').innerHTML = content;
                                setTimeout(() => {
                                    const languageToggle = openedWindow.querySelector('#language-toggle');
                                    if (languageToggle) {
                                        languageToggle.addEventListener('change', (e) => {
                                            const newLang = e.target.checked ? 'en' : 'zh';
                                            if (newLang !== currentLanguage) {
                                                currentLanguage = newLang;
                                                console.log(`通过设置切换语言到: ${currentLanguage}`);
                                                updateUIForLanguage();
                                            }
                                        });
                                    }

                                    const desktopIconsToggle = openedWindow.querySelector('#desktop-icons-toggle');
                                    if (desktopIconsToggle) {
                                        desktopIconsToggle.addEventListener('change', (e) => {
                                            if (e.target.checked) {
                                                desktopIconsContainer.style.display = 'block';
                                            } else {
                                                desktopIconsContainer.style.display = 'none';
                                            }
                                        });
                                    }
                                }, 100);
                                renderDynamicAssets();
                            }
                            break;
                        case 'shutdown':
                            content = renderShutdownContent();
                            if (openedWindow) {
                                openedWindow.querySelector('.os-window-content').innerHTML = content;
                                renderDynamicAssets();
                            }
                            setTimeout(() => {
                                console.log(LANG_CONTENT[currentLanguage]?.shutdownMessage);
                                mainDesktopArea.innerHTML = `<div id="welcome-message" class="absolute inset-0 flex items-center justify-center pointer-events-none">
                                    <p class="text-3xl text-white opacity-70" id="welcome-message-text">${LANG_CONTENT[currentLanguage]?.shutdownMessage}</p>
                                </div>`;
                                openWindowsMap.clear();
                                openStandaloneAppsMap.clear(); // Clear standalone apps too
                                taskbarIconsContainer.innerHTML = '';
                                renderDynamicAssets();
                            }, 2000);
                            break;
                    }
                });
            });


            // Handle Start Menu header click to open About Me
            if (startMenuHeader) {
                startMenuHeader.addEventListener('click', async (event) => {
                    event.preventDefault();
                    event.stopPropagation();
                    startMenu.classList.remove('is-open');

                    const section = 'about';
                    const aboutTitleForWindow = LANG_CONTENT[currentLanguage]?.aboutTitle;
                    const aboutContentForWindow = LANG_CONTENT[currentLanguage]?.aboutContent;

                    if (aboutContentForWindow) {
                        openWindow('about', aboutTitleForWindow, LANG_CONTENT['en']?.aboutTitle, aboutContentForWindow, 'about', {}, true);
                    } else {
                        console.error(`错误：未找到关于 MAZKO 的内容，语言 ${currentLanguage} 或未定义。`);
                        openWindow('about', '错误', '错误', `<p class="text-xl text-red-400">无法加载关于 MAZKO 的内容。</p>`, 'about', {}, false);
                    }
                });
            }


            // --- Desktop Icon Dragging Logic ---
            let isDraggingIcon = false;
            let currentDraggedIcon = null;
            let initialMouseX, initialMouseY;
            let initialIconX, initialIconY;

            if (desktopIconsContainer) {
                desktopIconsContainer.querySelectorAll('.desktop-icon').forEach(icon => {
                    icon.style.position = 'absolute';

                    icon.addEventListener('mousedown', (e) => {
                        if (e.button !== 0) return;
                        isDraggingIcon = true;
                        currentDraggedIcon = icon;
                        initialMouseX = e.clientX;
                        initialMouseY = e.clientY;
                        initialIconX = icon.offsetLeft;
                        initialIconY = icon.offsetTop;

                        currentDraggedIcon.style.zIndex = highestZIndex + 1; 

                        e.preventDefault();
                        console.log(`开始拖动图标: ${icon.dataset.title}`);
                    });

                    icon.addEventListener('click', (event) => {
                        if (currentDraggedIcon === icon && (Math.abs(event.clientX - initialMouseX) > 5 || Math.abs(event.clientY - initialMouseY) > 5)) {
                            console.log("图标被拖动，阻止点击操作。");
                            return; 
                        }

                        const section = icon.dataset.section;
                        
                        // Check if it's a regular window or standalone app
                        let existingElement = openWindowsMap.get(section) || openStandaloneAppsMap.get(section);

                        if (existingElement) {
                            if (existingElement.classList.contains('minimized')) {
                                restoreWindow(existingElement);
                            } else {
                                bringToFront(existingElement);
                            }
                            return;
                        }
                        
                        // Simulate click on the corresponding start menu item or button to trigger window opening logic
                        const startMenuItem = document.querySelector(`.start-menu-item[data-section="${section}"]`);
                        const startMenuFooterButton = document.querySelector(`.start-menu-footer-button[data-section="${section}"]`);

                        if (startMenuItem) {
                            startMenuItem.click();
                        } else if (startMenuFooterButton) {
                            startMenuFooterButton.click();
                        } else {
                            console.warn(`未找到模块: ${section} 的开始菜单项或底部按钮`);
                        }
                    });
                });
            }

            document.addEventListener('mousemove', (e) => {
                if (!isDraggingIcon || !currentDraggedIcon) return;

                const dx = e.clientX - initialMouseX;
                const dy = e.clientY - initialMouseY;

                let newX = initialIconX + dx;
                let newY = initialIconY + dy;

                const desktopRect = mainDesktopArea.getBoundingClientRect();
                const iconRect = currentDraggedIcon.getBoundingClientRect();

                const minX = 0;
                const minY = 0;
                const maxX = desktopRect.width - iconRect.width;
                const maxY = desktopRect.height - iconRect.height;

                newX = Math.max(minX, Math.min(newX, maxX));
                newY = Math.max(minY, Math.min(newY, maxY));

                currentDraggedIcon.style.left = `${newX}px`;
                currentDraggedIcon.style.top = `${newY}px`;
            });

            document.addEventListener('mouseup', () => {
                if (isDraggingIcon) {
                    isDraggingIcon = false;
                    if (currentDraggedIcon) {
                        currentDraggedIcon.style.zIndex = 2; 
                        console.log(`停止拖动图标: ${currentDraggedIcon.dataset.title}`);
                    }
                    currentDraggedIcon = null;
                }
            });

            // Handle window/app focus/blur to update title bar active state and z-index
            document.addEventListener('mousedown', (e) => {
                const clickedElement = e.target.closest('.os-window') || e.target.closest('.music-player-standalone');
                
                document.querySelectorAll('.os-window').forEach(win => {
                    const titleBar = win.querySelector('.os-window-title-bar');
                    if (titleBar) {
                        if (win === clickedElement) {
                            titleBar.classList.remove('inactive');
                        } else {
                            titleBar.classList.add('inactive');
                        }
                    }
                });

                // Bring clicked element to front if it's a window or standalone app
                if (clickedElement) {
                    bringToFront(clickedElement);
                }
            });

            // Initial UI update based on default language
            updateCursors();
            updateUIForLanguage();
            renderDynamicAssets();
            console.log('所有事件监听器已附加，脚本初始化完成。');
        });
    </script>
</body>
</html>
